{
  "hash": "21d8d59eac2dfa9fdef4abfc311996ed",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 1:Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar\"\nauthor: \"Xu Haiyang\"\ndate: \"3 September, 2024\" \ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n## **1. Context**\n\nMillions of lives are devastated every year by armed conflicts, as wars continue to leave communities shattered. While the 1990s and early 2000s saw a decline in global conflict, the situation has deteriorated significantly since 2012. This new wave of conflict was sparked by the Arab uprisings in 2011, leading to wars in Libya, Syria, and Yemen. The instability in Libya further contributed to a prolonged crisis in the Sahel region. Subsequent major confrontations include the 2020 Azerbaijani-Armenian war over Nagorno-Karabakh and the brutal fighting in Ethiopia's Tigray region. Myanmar’s military coup in 2021 and Russia’s 2022 invasion of Ukraine further escalated global violence. More recently, Sudan and Gaza have been devastated by conflict in 2023. As a result, more people today are being displaced, killed, and driven into humanitarian crises than at any time in recent decades.\n\n### **1.1 Introduction**\n\nGeospatial analytics provides powerful tools to understand and address the complex societal problems driven by armed conflict. Through spatial point pattern analysis, researchers can gain deeper insights into the distribution of conflict events and their impact over time and space. This study focuses on Myanmar, a nation that has experienced escalating violence since the 2021 military coup. By applying spatial and spatio-temporal point pattern analysis techniques, this study aims to uncover patterns in the geographical distribution of armed conflict in Myanmar between 2021 and mid-2024.\n\n### **1.2 Objectives**\n\nThe primary objective of this analysis is to utilize geospatial methodologies to examine the spatial and temporal trends of armed conflict in Myanmar. Specifically, this study will:\n\n-   Investigate the spatial distribution of four key types of events: **Battles**, **Explosion/Remote violence**, **Strategic developments**, and **Violence against civilians**.\n\n-   Analyze the quarterly frequency and intensity of conflict events from January 2021 to June 2024.\n\n-   Apply spatial and spatio-temporal point pattern techniques to identify and map hotspots and clusters of conflict activity.\n\n### **1.3 Data**\n\n-   **Armed Conflict Data:** The data used in this analysis is derived from the **Armed Conflict Location & Event Data Project (ACLED)**, an internationally recognized source of data on violent conflict and protests worldwide. The dataset spans from January 2021 to June 2024, focusing on specific types of events in Myanmar.\n\n-   **GIS Data:** The geographical boundaries for analysis are based on geospatial data from the **Myanmar Information Management Unit (MIMU)**. The dataset includes administrative boundaries at three levels: states and regions (admin1), districts (admin2), which will be integrated with the ACLED conflict data for spatial analysis.\n\n## **2. Data**\n\nIn this section, I focus on loading and understanding both geospatial and aspatial data required for the analysis.\n\n### **2.1 Geospatial Data**\n\nI begin by loading the Myanmar administrative boundary data using the `sf` package. This data includes two administrative levels: state/region (admin1) and district (admin2). These boundaries are crucial for analyzing the geographical distribution of armed conflict events across Myanmar at different levels of granularity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, lubridate, spatstat, tmap, animation, magick, ggplot2, sparr)\n```\n:::\n\n\n-   **`sf`**: I used `sf` to handle geospatial data, specifically reading and manipulating shapefiles for Myanmar’s administrative boundaries. This package simplifies working with spatial data by integrating it with data frames and providing a set of tools for spatial analysis and visualization.\n\n-   **`tidyverse`**: I included `tidyverse` to facilitate data manipulation and visualization. Its tools, like `dplyr` for data wrangling and `ggplot2` for plotting, are essential for efficiently processing both spatial and non-spatial data.\n\n-   **`lubridate`**: This package is loaded to handle date and time information in future steps. It simplifies parsing and manipulating timestamps, which will be important when analyzing the temporal aspects of the armed conflict data.\n\n-   **`spatstat`**: I used `spatstat` for spatial point pattern analysis. It provides advanced tools for detecting clustering or dispersion of events within the spatial data, which is crucial for understanding the distribution of conflict points.\n\n-   **`tmap`**: I loaded `tmap` for creating high-quality thematic maps. This package allows both static and interactive visualizations of spatial data, offering more customization than the basic `plot()` function.\n\n-   **`animation` & `magick`**: These packages are included to create animations and handle image processing. They will be useful later for generating dynamic visualizations or exporting images of the spatial data for reports and presentations.\n\n-   **`ggplot2`**: As part of `tidyverse`, `ggplot2` is used to create static visualizations. It provides powerful customization options for plotting spatial and non-spatial data, ensuring clear and detailed graphics for analysis.\n\n-   **`sparr`**: I included `sparr` for density estimation and relative risk analysis. It is essential for identifying geographical hotspots and understanding spatial risk, which is critical when analyzing conflict patterns.\n\nNext, I load the administrative boundary data for the state/region (admin1) and district (admin2) levels:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadmin1 = st_read(dsn = \"data/geospatial/admin1\", layer = \"mmr_polbnda2_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source \n  `C:\\EasonXu-HY99\\IS415\\Take-Home_Ex\\Take-Home_Ex01\\data\\geospatial\\admin1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nadmin2 = st_read(dsn = \"data/geospatial/admin2\", layer = \"mmr_polbnda_adm2_250k_mimu\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm2_250k_mimu' from data source \n  `C:\\EasonXu-HY99\\IS415\\Take-Home_Ex\\Take-Home_Ex01\\data\\geospatial\\admin2' \n  using driver `ESRI Shapefile'\nSimple feature collection with 80 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\nTo explore the geometrical data for both layers:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_geometry(admin1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeometry set for 18 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((95.20798 15.6904, 95.21097 15.6...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((96.17964 19.49327, 96.18219 19....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((95.70458 19.19143, 95.71076 19....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((93.36931 24.09112, 93.38098 24....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((97.59674 28.52616, 97.5925 28.5...\n```\n\n\n:::\n\n```{.r .cell-code}\nst_geometry(admin2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeometry set for 80 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((95.12637 18.50512, 95.12969 18....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((95.04462 15.74789, 95.04638 15....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((95.38231 17.41092, 95.38468 17....\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((94.6942 16.41819, 94.6936 16.41...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMULTIPOLYGON (((94.27572 15.85924, 94.2752 15.8...\n```\n\n\n:::\n:::\n\n\nI then examine the structure of the datasets using `glimpse()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(admin1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 18\nColumns: 7\n$ OBJECTID <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18\n$ ST       <chr> \"Ayeyarwady\", \"Bago (East)\", \"Bago (West)\", \"Chin\", \"Kachin\",…\n$ ST_PCODE <chr> \"MMR017\", \"MMR007\", \"MMR008\", \"MMR004\", \"MMR001\", \"MMR002\", \"…\n$ ST_RG    <chr> \"Region\", \"Region\", \"Region\", \"State\", \"State\", \"State\", \"Sta…\n$ ST_MMR   <chr> \"ဧရာဝတီတိုင်းဒေသကြီး\", \"ပဲခူးတိုင်းဒေသကြီး (အရှေ့)\", \"ပဲခူးတိုင်းဒေသကြီး (အနောက်)…\n$ PCode_V  <dbl> 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9…\n$ geometry <MULTIPOLYGON [°]> MULTIPOLYGON (((95.20798 15..., MULTIPOLYGON (((96.17964 19..…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(admin2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 80\nColumns: 8\n$ OBJECTID <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ ST       <chr> \"Ayeyarwady\", \"Ayeyarwady\", \"Ayeyarwady\", \"Ayeyarwady\", \"Ayey…\n$ ST_PCODE <chr> \"MMR017\", \"MMR017\", \"MMR017\", \"MMR017\", \"MMR017\", \"MMR017\", \"…\n$ DT       <chr> \"Hinthada\", \"Labutta\", \"Maubin\", \"Myaungmya\", \"Pathein\", \"Pya…\n$ DT_PCODE <chr> \"MMR017D002\", \"MMR017D004\", \"MMR017D005\", \"MMR017D003\", \"MMR0…\n$ DT_MMR   <chr> \"ဟင်္သာတခရိုင်\", \"လပွတ္တာခရိုင်\", \"မအူပင်ခရိုင်\", \"မြောင်းမြခရိုင်\", \"ပုသိမ်ခရိုင်\", \"…\n$ PCode_V  <dbl> 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9…\n$ geometry <MULTIPOLYGON [°]> MULTIPOLYGON (((95.12637 18..., MULTIPOLYGON (((…\n```\n\n\n:::\n:::\n\n\nFinally, I generate quick visualizations of the state/region and district boundaries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\n\nplot(admin1[\"ST\"], main = \"State/Region\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(admin2[\"ST\"], main = \"District\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n### **2.2 Aspatial Data**\n\nNext, I load the aspatial armed conflict data from ACLED, which contains detailed event information about conflicts in Myanmar. This dataset will be used alongside the geospatial data to analyze the distribution of these events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED <- read_csv(\"data/aspatial/ACLED_Myanmar.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 51553 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nThe dataset is read into R using the `read_csv()` function, which imports it as a data frame for further processing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist(ACLED)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n# A tibble: 51,553 × 31\n   event_id_cnty event_date    year time_precision disorder_type      event_type\n   <chr>         <chr>        <dbl>          <dbl> <chr>              <chr>     \n 1 MMR64313      30 June 2024  2024              1 Political violence Battles   \n 2 MMR64320      30 June 2024  2024              1 Political violence Battles   \n 3 MMR64321      30 June 2024  2024              1 Political violence Battles   \n 4 MMR64322      30 June 2024  2024              1 Strategic develop… Strategic…\n 5 MMR64323      30 June 2024  2024              1 Political violence Battles   \n 6 MMR64324      30 June 2024  2024              1 Strategic develop… Strategic…\n 7 MMR64325      30 June 2024  2024              1 Political violence Battles   \n 8 MMR64326      30 June 2024  2024              1 Political violence Battles   \n 9 MMR64328      30 June 2024  2024              1 Political violence Battles   \n10 MMR64330      30 June 2024  2024              1 Political violence Battles   \n# ℹ 51,543 more rows\n# ℹ 25 more variables: sub_event_type <chr>, actor1 <chr>, assoc_actor_1 <chr>,\n#   inter1 <dbl>, actor2 <chr>, assoc_actor_2 <chr>, inter2 <dbl>,\n#   interaction <dbl>, civilian_targeting <chr>, iso <dbl>, region <chr>,\n#   country <chr>, admin1 <chr>, admin2 <chr>, admin3 <chr>, location <chr>,\n#   latitude <dbl>, longitude <dbl>, geo_precision <dbl>, source <chr>,\n#   source_scale <chr>, notes <chr>, fatalities <dbl>, tags <chr>, …\n```\n\n\n:::\n:::\n\n\nI inspect the structure of the dataset using `list()`, ensuring that it contains the expected columns, such as event dates, event types, and geographical information (longitude and latitude).\n\n### **2.3 Data Preprocessing**\n\nTo begin, I check the coordinate reference system (CRS) of the `admin1` and `admin2` layers to confirm the data uses an appropriate spatial projection. This ensures the data aligns correctly during analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(admin1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(admin2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n:::\n\n\nThe function `st_crs()` retrieves the CRS for both datasets. Ensuring consistency in the CRS is critical for accurate spatial analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadmin1_utm <- st_transform(admin1, 32647)\nadmin2_utm <- st_transform(admin2, 32647)\n```\n:::\n\n\nBoth layers are transformed to UTM Zone 47N (EPSG: 32647), a projection suitable for regional analysis. The `st_transform()` function reprojects the spatial data to ensure all layers are compatible during further analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(admin1_utm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(admin2_utm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n:::\n\n\nAfter the transformation, I check the CRS of the transformed data to confirm the projection has been applied successfully.\n\nNext, I convert the aspatial ACLED data into a spatial object by assigning longitude and latitude coordinates and transforming it to match the same UTM Zone 47N projection as the administrative boundary layers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- st_as_sf(ACLED,\n                     coords = c(\"longitude\", \"latitude\"),\n                     crs = 4326) %>%\n  st_transform(crs = 32647)\n```\n:::\n\n\nUsing `st_as_sf()`, I convert the aspatial ACLED data into a simple feature (sf) object, specifying the longitude and latitude columns as coordinates. The initial CRS is set to EPSG: 4326 (WGS84), which is commonly used for geographic coordinates, and is then transformed to UTM 47N to match the boundary layers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ACLED_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 51,553\nColumns: 30\n$ event_id_cnty      <chr> \"MMR64313\", \"MMR64320\", \"MMR64321\", \"MMR64322\", \"MM…\n$ event_date         <chr> \"30 June 2024\", \"30 June 2024\", \"30 June 2024\", \"30…\n$ year               <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 202…\n$ time_precision     <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ disorder_type      <chr> \"Political violence\", \"Political violence\", \"Politi…\n$ event_type         <chr> \"Battles\", \"Battles\", \"Battles\", \"Strategic develop…\n$ sub_event_type     <chr> \"Armed clash\", \"Armed clash\", \"Armed clash\", \"Chang…\n$ actor1             <chr> \"People's Defense Force - Mandalay\", \"People's Defe…\n$ assoc_actor_1      <chr> \"MDA - AGF: Madaya - The Authentic Genes Force; SST…\n$ inter1             <dbl> 3, 3, 3, 1, 3, 1, 1, 2, 1, 1, 1, 1, 3, 3, 3, 7, 1, …\n$ actor2             <chr> \"Military Forces of Myanmar (2021-)\", \"Military For…\n$ assoc_actor_2      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"Uniden…\n$ inter2             <dbl> 1, 1, 1, 0, 1, 0, 2, 1, 2, 2, 2, 3, 1, 1, 7, 0, 0, …\n$ interaction        <dbl> 13, 13, 13, 10, 13, 10, 12, 12, 12, 12, 12, 13, 13,…\n$ civilian_targeting <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ iso                <dbl> 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 1…\n$ region             <chr> \"Southeast Asia\", \"Southeast Asia\", \"Southeast Asia…\n$ country            <chr> \"Myanmar\", \"Myanmar\", \"Myanmar\", \"Myanmar\", \"Myanma…\n$ admin1             <chr> \"Mandalay\", \"Mandalay\", \"Mandalay\", \"Sagaing\", \"Sag…\n$ admin2             <chr> \"Mandalay\", \"Pyinoolwin\", \"Pyinoolwin\", \"Shwebo\", \"…\n$ admin3             <chr> \"Patheingyi\", \"Singu\", \"Thabeikkyin\", \"Khin-U\", \"My…\n$ location           <chr> \"Aung Tha Pyay\", \"Pin Lel Gyi\", \"Thabeikkyin\", \"Khi…\n$ geo_precision      <dbl> 2, 1, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, …\n$ source             <chr> \"Democratic Voice of Burma; Irrawaddy\", \"Irrawaddy\"…\n$ source_scale       <chr> \"National\", \"National\", \"National\", \"Subnational-Na…\n$ notes              <chr> \"On 30 June 2024, near Aung Tha Pyay village (Pathe…\n$ fatalities         <dbl> 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ tags               <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ timestamp          <dbl> 1720552468, 1720552468, 1720552468, 1720552468, 172…\n$ geometry           <POINT [m]> POINT (214961 2452068), POINT (198303.2 24994…\n```\n\n\n:::\n:::\n\n\nTo streamline the dataset, I select only the necessary columns for analysis, such as event dates, event types, actor information, location, and fatalities.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- ACLED_sf %>%\n  select(event_date, year, event_type, actor1, actor2, interaction, admin1, admin2, source_scale, fatalities, timestamp)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- ACLED_sf %>%\n  mutate(event_date = as.Date(event_date, format = \"%d %B %Y\")) \n```\n:::\n\n\nNext, I format the `event_date` column into a proper `Date` object using `mutate()` and `as.Date()`. This ensures that the date column is correctly interpreted and can be used for temporal filtering and analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- ACLED_sf %>%\n  filter(event_type %in% c(\"Battles\", \n                           \"Explosions/Remote violence\", \n                           \"Strategic developments\", \n                           \"Violence against civilians\"))\n```\n:::\n\n\nI filter the dataset to focus on specific types of conflict events that are most relevant to the analysis: Battles, Explosions/Remote violence, Strategic developments, and Violence against civilians. This step reduces noise in the data and ensures the analysis is targeted at the most critical event types.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ACLED_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6 features and 11 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 76997.72 ymin: 2428487 xmax: 214961 ymax: 2533434\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 6 × 12\n  event_date  year event_type            actor1 actor2 interaction admin1 admin2\n  <date>     <dbl> <chr>                 <chr>  <chr>        <dbl> <chr>  <chr> \n1 2024-06-30  2024 Battles               Peopl… Milit…          13 Manda… Manda…\n2 2024-06-30  2024 Battles               Peopl… Milit…          13 Manda… Pyino…\n3 2024-06-30  2024 Battles               Peopl… Milit…          13 Manda… Pyino…\n4 2024-06-30  2024 Strategic developmen… Milit… <NA>            10 Sagai… Shwebo\n5 2024-06-30  2024 Battles               PKDF … Milit…          13 Sagai… Sagai…\n6 2024-06-30  2024 Strategic developmen… Milit… <NA>            10 Sagai… Yinma…\n# ℹ 4 more variables: source_scale <chr>, fatalities <dbl>, timestamp <dbl>,\n#   geometry <POINT [m]>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to plotting\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(admin1_utm) +\n  tm_polygons(col = \"grey\", border.col = \"black\") +\ntm_shape(ACLED_sf) +\n  tm_dots(col = \"black\", size = 0.01)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nI create a static map showing the state boundaries from the `admin1_utm` dataset and the conflict event locations from `ACLED_sf`. Using `tm_shape()` and `tm_polygons()`, I plot the state boundaries in grey, and with `tm_dots()`, I overlay the conflict event points in black. This map provides a clear visual representation of the geographical distribution of conflict events across Myanmar.\n\nTo narrow down the focus of the analysis, I decided to identify the state with the highest number of conflict events. This allows for a more detailed examination of conflict patterns in a specific region.\n\nI first calculated the total number of events per administrative area (admin1) and visualized the distribution using a histogram. This provides an overview of the event counts across different regions, helping to identify the area with the most activity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_counts_by_admin1 <- ACLED_sf %>%\n  group_by(admin1) %>%\n  summarize(event_count = n()) %>%\n  arrange(desc(event_count))  \n```\n:::\n\n\nUsing `group_by()` and `summarize()`, I calculated the number of events in each admin1 area, then arranged the areas in descending order to highlight the regions with the highest number of events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(event_counts_by_admin1, aes(x = reorder(admin1, -event_count), y = event_count)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  coord_flip() +  \n  labs(title = \"Number of Events by Admin1 Area\",\n       x = \"Admin1 Area\",\n       y = \"Number of Events\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nI used `ggplot2` to create a bar plot that visually represents the number of conflict events by admin1 area. The `coord_flip()` function was used to rotate the plot for better readability, and the bars are ordered by event count. The color scheme and minimal theme improve clarity, with labels clearly indicating the focus of the plot.\n\nAfter reviewing the histogram, I chose to focus on the **Sagaing** area, as it had the highest number of events. To filter the dataset, I selected only the events that occurred in Sagaing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- ACLED_sf %>%\n  filter(admin1 == \"Sagaing\")\n```\n:::\n\n\nI applied the `filter()` function to retain only the conflict events within Sagaing, reducing the dataset to focus on this specific region. This will allow for a more granular analysis of conflict events in Sagaing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ACLED_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6 features and 11 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 76997.72 ymin: 2428487 xmax: 202272.4 ymax: 2689238\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 6 × 12\n  event_date  year event_type            actor1 actor2 interaction admin1 admin2\n  <date>     <dbl> <chr>                 <chr>  <chr>        <dbl> <chr>  <chr> \n1 2024-06-30  2024 Strategic developmen… Milit… <NA>            10 Sagai… Shwebo\n2 2024-06-30  2024 Battles               PKDF … Milit…          13 Sagai… Sagai…\n3 2024-06-30  2024 Strategic developmen… Milit… <NA>            10 Sagai… Yinma…\n4 2024-06-29  2024 Battles               PKDF … Milit…          13 Sagai… Sagai…\n5 2024-06-28  2024 Battles               KIO/K… Milit…          12 Sagai… Katha \n6 2024-06-27  2024 Battles               Peopl… Milit…          13 Sagai… Monywa\n# ℹ 4 more variables: source_scale <chr>, fatalities <dbl>, timestamp <dbl>,\n#   geometry <POINT [m]>\n```\n\n\n:::\n:::\n\n\nNext, I filtered the `admin2_utm` layer to isolate the district boundaries for Sagaing. This will allow me to visualize the conflict events within the context of Sagaing’s district divisions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsagaing <- admin2_utm %>% filter(ST == \"Sagaing\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to plotting\n```\n\n\n:::\n:::\n\n\nI set the `tmap` mode to static plotting to create a visual representation of the conflict events in Sagaing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(sagaing) +\n  tm_polygons(col = \"grey\", border.col = \"black\") +\ntm_shape(ACLED_sf) +\n  tm_dots(col = \"black\", size = 0.01) +\ntm_layout(title = \"Events in Sagaing Area\", legend.outside = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nI used `tmap` to create a map showing the district boundaries of Sagaing and overlaid the conflict events as black dots. The grey polygons represent the districts, while the event points are plotted in black. The map is titled \"Events in Sagaing Area,\" and the layout includes an external legend to enhance clarity.\n\n## **3. Quarterly Kernel Density Estimation (KDE)**\n\nTo understand the spatial distribution of conflict events over time, I perform a Kernel Density Estimation (KDE) on a quarterly basis. This allows for the identification of patterns and hotspots in different quarters of the year.\n\nFirst, I create a new variable that represents the quarter of each event, combining the event year and quarter number.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf <- ACLED_sf %>%\n  mutate(quarter = paste0(year(event_date), \"-Q\", quarter(event_date)))\n```\n:::\n\n\nThe `mutate()` function is used here to generate a `quarter` column, combining the year and quarter extracted from the `event_date` field using the `year()` and `quarter()` functions from the `lubridate` package. This step ensures that each event is categorized by the quarter in which it occurred.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ACLED_sf$quarter)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2024-Q2\" \"2024-Q2\" \"2024-Q2\" \"2024-Q2\" \"2024-Q2\" \"2024-Q2\"\n```\n\n\n:::\n:::\n\n\nI then inspect the first few values of the `quarter` column to verify that the new variable has been created correctly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(ACLED_sf$quarter)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"2024-Q2\" \"2024-Q1\" \"2023-Q4\" \"2023-Q3\" \"2023-Q2\" \"2023-Q1\" \"2022-Q4\"\n [8] \"2022-Q3\" \"2022-Q2\" \"2022-Q1\" \"2021-Q4\" \"2021-Q3\" \"2021-Q2\" \"2021-Q1\"\n```\n\n\n:::\n:::\n\n\nNext, I check the unique quarter values to ensure all expected quarters are present, confirming that the data spans multiple time periods and is ready for quarterly analysis.\n\nTo perform the KDE for each quarter, I split the dataset into separate data frames based on the `quarter` variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarterly_data <- split(ACLED_sf, ACLED_sf$quarter)\n```\n:::\n\n\nThe `split()` function divides the dataset into a list of data frames, where each element corresponds to the events from a specific quarter. This allows for the independent analysis of each quarter's event data.\n\nNext, I convert the spatial boundaries of Sagaing into an `owin` object, which is required for KDE using the `spatstat` package. The `owin` object represents the observation window for the spatial point pattern.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsagaing_owin <- as.owin(sagaing)\n```\n:::\n\n\nThe `as.owin()` function transforms the Sagaing boundary (in `sf` format) into a `spatstat`-compatible `owin` object. This step is crucial as it defines the study area within which the Kernel Density Estimation will be conducted.\n\n### 3.1 ACLED (all events)\n\nIn this section, I generate a Kernel Density Estimation (KDE) for all conflict events in Sagaing, categorized by quarter. This allows me to visualize the density of events over time, identifying areas of higher conflict concentration for each quarter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveGIF({\n  for (q in names(quarterly_data)) {\n    \n    quarter_data <- quarterly_data[[q]]\n    \n    ACLED_ppp <- as.ppp(st_coordinates(quarter_data), W = sagaing_owin)\n    \n    ACLED_ppp <- rjitter(ACLED_ppp, \n                         retry = TRUE,\n                         nsim = 1,\n                         drop = TRUE)\n    \n    ACLEDmm_ppp.km <- rescale(ACLED_ppp, 1000, \"km\")\n    \n    kde_ACLEDmm_bw <- density(ACLEDmm_ppp.km,\n                              sigma = bw.ppl,\n                              edge = TRUE,\n                              kernel = \"gaussian\")\n    \n    plot(kde_ACLEDmm_bw, main = paste(\"KDE for\", q))\n    \n  }\n}, movie.name = \"kde_ACLED.gif\", interval = 0.5, ani.width = 800, ani.height = 600)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOutput at: kde_ACLED.gif\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\nI begin by looping through the quarterly data, converting each quarter’s conflict events into a spatial point pattern object (`ppp`) using the `as.ppp()` function. I apply jittering using `rjitter()` to handle points that overlap or are too close, reducing visual artifacts. The points are then rescaled to kilometers using `rescale()` to ensure spatial units are consistent.\n\nFor each quarter, I compute the Kernel Density Estimation using the `density()` function, which applies a Gaussian kernel with bandwidth selected by the `bw.ppl` method. The results are plotted to visually inspect how conflict event densities evolve over each quarter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_gif <- image_read(\"kde_ACLED.gif\")\n\nprint(ACLED_gif)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    600 sRGB       FALSE        0 72x72  \n 2 GIF      800    600 sRGB       FALSE        0 72x72  \n 3 GIF      800    600 sRGB       FALSE        0 72x72  \n 4 GIF      800    600 sRGB       FALSE        0 72x72  \n 5 GIF      800    600 sRGB       FALSE        0 72x72  \n 6 GIF      800    600 sRGB       FALSE        0 72x72  \n 7 GIF      800    600 sRGB       FALSE        0 72x72  \n 8 GIF      800    600 sRGB       FALSE        0 72x72  \n 9 GIF      800    600 sRGB       FALSE        0 72x72  \n10 GIF      800    600 sRGB       FALSE        0 72x72  \n11 GIF      800    600 sRGB       FALSE        0 72x72  \n12 GIF      800    600 sRGB       FALSE        0 72x72  \n13 GIF      800    600 sRGB       FALSE        0 72x72  \n14 GIF      800    600 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-32-1.gif)\n:::\n:::\n\n\nAfter generating the KDE plots for each quarter, I save them as a GIF using `saveGIF()` and load the resulting animation using `image_read()`. This provides a dynamic view of conflict density changes over time.\n\n***Observation***\n\n| The Kernel Density Estimation (KDE) animation for ACLED events across all quarters reveals significant temporal and spatial variations in conflict activity within the Sagaing region. Throughout the animation, several recurring hotspots are observed in the southern part of Sagaing, with varying intensities across quarters. These areas consistently exhibit higher densities of conflict events, as indicated by the warm colors in the heatmap. Smaller, less intense hotspots are intermittently visible in the central and western parts of the region, but their presence and intensity fluctuate over time. The dynamic nature of the KDE highlights how conflict activity is concentrated in certain areas and time periods, while large portions of Sagaing remain relatively inactive. Overall, the animation provides a comprehensive view of the shifting landscape of conflict hotspots within the region.\n\n### **3.2 \"Battles\" event**\n\nNext, I repeat the KDE analysis, but this time focusing exclusively on events categorized as \"Battles.\" This allows for a more specific analysis of how battle-related conflict events are distributed over time and space in the Sagaing region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveGIF({\n  for (q in names(quarterly_data)) {\n    \n    quarter_data <- quarterly_data[[q]]\n    battles_data <- quarter_data[quarter_data$event_type == \"Battles\", ]\n    \n    ACLED_ppp <- as.ppp(st_coordinates(battles_data), W = sagaing_owin)\n    \n    ACLED_ppp <- rjitter(ACLED_ppp, \n                         retry = TRUE,\n                         nsim = 1,\n                         drop = TRUE)\n    \n    ACLEDmm_ppp.km <- rescale(ACLED_ppp, 1000, \"km\")\n    \n    kde_ACLEDmm_bw <- density(ACLEDmm_ppp.km,\n                              sigma = bw.ppl,\n                              edge = TRUE,\n                              kernel = \"gaussian\")\n    \n    plot(kde_ACLEDmm_bw, main = paste(\"KDE (Battles) for\", q))\n    \n  }\n}, movie.name = \"kde_battles.gif\", interval = 0.5, ani.width = 800, ani.height = 600)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOutput at: kde_battles.gif\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\nSimilar to the previous KDE analysis, I split the quarterly data and filter it to focus solely on the \"Battles\" events. The same process of creating a spatial point pattern (`ppp`), jittering, rescaling, and computing the Kernel Density Estimation is applied for each quarter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBattles_gif <- image_read(\"kde_battles.gif\")\n\nprint(Battles_gif)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    600 sRGB       FALSE        0 72x72  \n 2 GIF      800    600 sRGB       FALSE        0 72x72  \n 3 GIF      800    600 sRGB       FALSE        0 72x72  \n 4 GIF      800    600 sRGB       FALSE        0 72x72  \n 5 GIF      800    600 sRGB       FALSE        0 72x72  \n 6 GIF      800    600 sRGB       FALSE        0 72x72  \n 7 GIF      800    600 sRGB       FALSE        0 72x72  \n 8 GIF      800    600 sRGB       FALSE        0 72x72  \n 9 GIF      800    600 sRGB       FALSE        0 72x72  \n10 GIF      800    600 sRGB       FALSE        0 72x72  \n11 GIF      800    600 sRGB       FALSE        0 72x72  \n12 GIF      800    600 sRGB       FALSE        0 72x72  \n13 GIF      800    600 sRGB       FALSE        0 72x72  \n14 GIF      800    600 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-34-1.gif)\n:::\n:::\n\n\n***Observation***\n\n| The Kernel Density Estimation (KDE) for **\"Battle\" events** from **2021-Q1 to 2024-Q2** reveals dynamic shifts in conflict intensity across the Sagaing region over time. Throughout the quarters, the southwestern area consistently emerges as a hotspot for battle activity, with varying intensities as shown by the recurrent warm yellow and red areas. Over the course of the analysis, smaller clusters appear and disappear in the central and southeastern parts of Sagaing, indicating occasional battle flare-ups. The northern region remains largely inactive in terms of battle events, maintaining low density throughout the observed period. The overall pattern suggests that while battle activity is geographically concentrated in certain regions, there are fluctuations in intensity and spread over the course of the years. This provides a temporal perspective on the evolving conflict landscape in Sagaing, with the southern regions being most consistently affected by battle events.\n\n### **3.3 \"Explosions/Remote violence\" event**\n\nIn this section, I generate a Kernel Density Estimation (KDE) specifically for events categorized as \"Explosions/Remote violence\" in Sagaing, allowing for a focused analysis of how these events are distributed spatially across different quarters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveGIF({\n  for (q in names(quarterly_data)) {\n    \n    quarter_data <- quarterly_data[[q]]\n    er_data <- quarter_data[quarter_data$event_type == \"Explosions/Remote violence\", ]\n    \n    ACLED_ppp <- as.ppp(st_coordinates(er_data), W = sagaing_owin)\n    \n    ACLED_ppp <- rjitter(ACLED_ppp, \n                         retry = TRUE,\n                         nsim = 1,\n                         drop = TRUE)\n    \n    ACLEDmm_ppp.km <- rescale(ACLED_ppp, 1000, \"km\")\n    \n    kde_ACLEDmm_bw <- density(ACLEDmm_ppp.km,\n                              sigma = bw.ppl,\n                              edge = TRUE,\n                              kernel = \"gaussian\")\n    \n    plot(kde_ACLEDmm_bw, main = paste(\"KDE (Explosion/Remote violence) for\", q))\n    \n  }\n}, movie.name = \"kde_er.gif\", interval = 0.5, ani.width = 800, ani.height = 600)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Likelihood Cross-Validation criterion was maximised at left-hand end\nof interval [13.6, 330]; use argument 'srange' to specify a wider interval for\nbandwidth 'sigma'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOutput at: kde_er.gif\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nER_gif <- image_read(\"kde_er.gif\")\n\nprint(ER_gif)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    600 sRGB       FALSE        0 72x72  \n 2 GIF      800    600 sRGB       FALSE        0 72x72  \n 3 GIF      800    600 sRGB       FALSE        0 72x72  \n 4 GIF      800    600 sRGB       FALSE        0 72x72  \n 5 GIF      800    600 sRGB       FALSE        0 72x72  \n 6 GIF      800    600 sRGB       FALSE        0 72x72  \n 7 GIF      800    600 sRGB       FALSE        0 72x72  \n 8 GIF      800    600 sRGB       FALSE        0 72x72  \n 9 GIF      800    600 sRGB       FALSE        0 72x72  \n10 GIF      800    600 sRGB       FALSE        0 72x72  \n11 GIF      800    600 sRGB       FALSE        0 72x72  \n12 GIF      800    600 sRGB       FALSE        0 72x72  \n13 GIF      800    600 sRGB       FALSE        0 72x72  \n14 GIF      800    600 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-36-1.gif)\n:::\n:::\n\n\n***Observation***\n\n| The Kernel Density Estimation (KDE) animation for **Explosion/Remote violence** events from **2021-Q1 to 2024-Q2** reveals a concentrated and persistent hotspot in the central region of Sagaing. In **2021-Q1**, the intensity of explosion-related events is highly localized, as indicated by the bright red-yellow area, with minimal activity elsewhere in the region. As the animation progresses, the central hotspot remains the primary area of conflict activity, showing fluctuations in intensity over time but consistently being the focal point for these types of events. The surrounding areas remain largely inactive, reflecting the spatially concentrated nature of these violent incidents. This temporal stability of the hotspot suggests a long-standing area of tension where explosion/remote violence events are concentrated.\n\n### **3.4 \"Strategic developments\" event**\n\nThis section focuses on KDE analysis for events categorized as \"Strategic developments,\" providing insight into how these events are spatially distributed in Sagaing over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveGIF({\n  for (q in names(quarterly_data)) {\n    \n    quarter_data <- quarterly_data[[q]]\n    sd_data <- quarter_data[quarter_data$event_type == \"Strategic developments\", ]\n    \n    ACLED_ppp <- as.ppp(st_coordinates(sd_data), W = sagaing_owin)\n    \n    ACLED_ppp <- rjitter(ACLED_ppp, \n                         retry = TRUE,\n                         nsim = 1,\n                         drop = TRUE)\n    \n    ACLEDmm_ppp.km <- rescale(ACLED_ppp, 1000, \"km\")\n    \n    kde_ACLEDmm_bw <- density(ACLEDmm_ppp.km,\n                              sigma = bw.ppl,\n                              edge = TRUE,\n                              kernel = \"gaussian\")\n    \n    plot(kde_ACLEDmm_bw, main = paste(\"KDE (Strategic developments) for\", q))\n    \n  }\n}, movie.name = \"kde_sd.gif\", interval = 0.5, ani.width = 800, ani.height = 600)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOutput at: kde_sd.gif\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSD_gif <- image_read(\"kde_sd.gif\")\n\nprint(SD_gif)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    600 sRGB       FALSE        0 72x72  \n 2 GIF      800    600 sRGB       FALSE        0 72x72  \n 3 GIF      800    600 sRGB       FALSE        0 72x72  \n 4 GIF      800    600 sRGB       FALSE        0 72x72  \n 5 GIF      800    600 sRGB       FALSE        0 72x72  \n 6 GIF      800    600 sRGB       FALSE        0 72x72  \n 7 GIF      800    600 sRGB       FALSE        0 72x72  \n 8 GIF      800    600 sRGB       FALSE        0 72x72  \n 9 GIF      800    600 sRGB       FALSE        0 72x72  \n10 GIF      800    600 sRGB       FALSE        0 72x72  \n11 GIF      800    600 sRGB       FALSE        0 72x72  \n12 GIF      800    600 sRGB       FALSE        0 72x72  \n13 GIF      800    600 sRGB       FALSE        0 72x72  \n14 GIF      800    600 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-38-1.gif)\n:::\n:::\n\n\n***Observation***\n\n| The Kernel Density Estimation (KDE) for **Strategic developments** from **2021-Q1 to 2024-Q2** reveals a strong concentration of activity in the southern part of the Sagaing region. The hotspot, which is evident from the bright yellow and red areas, persists throughout the quarters, indicating that strategic developments are primarily localized in the southern region. Over time, the intensity of these events fluctuates but remains concentrated in the same geographical area, suggesting that this part of Sagaing consistently experiences significant strategic activities. The central and northern parts of the region show little to no activity, reflecting the highly localized nature of strategic developments. This pattern suggests a focused area of strategic importance within the southern zone of Sagaing, which could be linked to political or military operations in this region.\n\n### **3.5 \"Violence against civilians\" event**\n\nIn this section, I perform a Kernel Density Estimation (KDE) for events categorized as \"Violence against civilians.\" This analysis aims to identify where and when these types of events occurred with the highest intensity within the Sagaing region, visualized across different quarters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveGIF({\n  for (q in names(quarterly_data)) {\n    \n    quarter_data <- quarterly_data[[q]]\n    vac_data <- quarter_data[quarter_data$event_type == \"Violence against civilians\" , ]\n    \n    ACLED_ppp <- as.ppp(st_coordinates(vac_data), W = sagaing_owin)\n    \n    ACLED_ppp <- rjitter(ACLED_ppp, \n                         retry = TRUE,\n                         nsim = 1,\n                         drop = TRUE)\n    \n    ACLEDmm_ppp.km <- rescale(ACLED_ppp, 1000, \"km\")\n    \n    kde_ACLEDmm_bw <- density(ACLEDmm_ppp.km,\n                              sigma = bw.ppl,\n                              edge = TRUE,\n                              kernel = \"gaussian\")\n    \n    plot(kde_ACLEDmm_bw, main = paste(\"KDE (Violence against civilians) for\", q))\n    \n  }\n}, movie.name = \"kde_vac.gif\", interval = 0.5, ani.width = 800, ani.height = 600)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOutput at: kde_vac.gif\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVAC_gif <- image_read(\"kde_vac.gif\")\n\nprint(VAC_gif)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    600 sRGB       FALSE        0 72x72  \n 2 GIF      800    600 sRGB       FALSE        0 72x72  \n 3 GIF      800    600 sRGB       FALSE        0 72x72  \n 4 GIF      800    600 sRGB       FALSE        0 72x72  \n 5 GIF      800    600 sRGB       FALSE        0 72x72  \n 6 GIF      800    600 sRGB       FALSE        0 72x72  \n 7 GIF      800    600 sRGB       FALSE        0 72x72  \n 8 GIF      800    600 sRGB       FALSE        0 72x72  \n 9 GIF      800    600 sRGB       FALSE        0 72x72  \n10 GIF      800    600 sRGB       FALSE        0 72x72  \n11 GIF      800    600 sRGB       FALSE        0 72x72  \n12 GIF      800    600 sRGB       FALSE        0 72x72  \n13 GIF      800    600 sRGB       FALSE        0 72x72  \n14 GIF      800    600 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-40-1.gif)\n:::\n:::\n\n\n***Observation***\n\n| The Kernel Density Estimation (KDE) for **Violence against civilians** from **2021-Q1 to 2024-Q2** shows a prominent concentration of violence in the southern part of the Sagaing region. The heatmap reveals a consistent and persistent hotspot in this area, as indicated by the bright yellow and red colors. The central and northern parts of Sagaing experience significantly lower levels of violence, with the KDE remaining mostly blue, signifying low or no event density. Over time, the intensity in the southern region fluctuates but remains the primary area of violence against civilians. The steady presence of violence in this specific area suggests that it is a focal point for civilian-targeted conflicts, highlighting a potentially significant humanitarian issue concentrated in the southern part of Sagaing over the observed period.\n\n## **4. 2nd-Order Spatial Point Patterns Analysis**\n\nIn this section, I begin by analyzing the number of events by district within the Sagaing region to identify the areas with the highest concentration of conflict events. This helps in narrowing down the focus to specific districts for further spatial analysis.\n\nFirst, I calculate and visualize the event counts by district (admin2) within Sagaing:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_counts_by_admin2 <- ACLED_sf %>%\n  filter(admin1 == \"Sagaing\") %>% \n  group_by(admin2) %>% \n  summarize(event_count = n()) %>% \n  arrange(desc(event_count))\n```\n:::\n\n\nHere, I filter the dataset to only include events in Sagaing, then group by districts (admin2), and count the number of events in each district. This provides the basis for identifying which districts have the highest event numbers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(event_counts_by_admin2, aes(x = reorder(admin2, -event_count), y = event_count)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  coord_flip() +  \n  labs(title = \"Number of Events by District (Admin2) in Sagaing\",\n       x = \"District (Admin2)\",\n       y = \"Number of Events\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nUsing `ggplot2`, I create a bar chart to visualize the number of events in each district. The `reorder()` function orders the districts by event count, and `coord_flip()` rotates the axes for improved readability. The plot clearly highlights the districts with the highest conflict event numbers.\n\nBased on the histogram, I observe that \"Shwebo\" and \"Yinmarbin\" have the top 2 highest event numbers, both exceeding 1,250 events. I will now focus my analysis on these two districts.\n\nI begin by extracting the boundaries for Shwebo and Yinmarbin:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsh <- sagaing %>%\n  filter(DT == \"Shwebo\")\nyi <- sagaing %>%\n  filter(DT == \"Yinmarbin\")\n```\n:::\n\n\nThis step isolates the spatial polygons for Shwebo and Yinmarbin districts within the Sagaing region, allowing for a more focused spatial analysis in these two districts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsh_owin = as.owin(sh)\nyi_owin = as.owin(yi)\n```\n:::\n\n\nNext, I convert the district boundaries into `owin` objects using the `as.owin()` function, which allows these spatial areas to be used in subsequent point pattern analyses.\n\nI then prepare the conflict event data for point pattern analysis by converting the `ACLED_sf` data into a point pattern (`ppp`) object and applying jittering to handle any overlapping points.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_ppp <- as.ppp(ACLED_sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(ACLED_sf): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nACLED_ppp <- rjitter(ACLED_ppp, \n                       retry = TRUE,\n                       nsim = 1,\n                       drop = TRUE)\n```\n:::\n\n\nI subset the point pattern object to focus only on the events within the Shwebo and Yinmarbin districts:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sh_ppp = ACLED_ppp[sh_owin]\nACLED_yi_ppp = ACLED_ppp[yi_owin]\n```\n:::\n\n\nUsing the `owin` objects for Shwebo and Yinmarbin, I extract the conflict events that occurred specifically within the boundaries of these two districts. This prepares the data for detailed spatial point pattern analysis in Shwebo and Yinmarbin, allowing for further examination of spatial interactions, clustering, or dispersion within these key districts.\n\n### **4.1 G-Function Analysis**\n\nThe G-function, or nearest-neighbor function, is a second-order spatial point pattern statistic that helps analyze the distribution of distances between points. It is useful for identifying clustering or dispersion tendencies within the spatial point pattern. In this section, I apply the G-function to both the Shwebo and Yinmarbin districts.\n\n#### 4.1.1 Shwebo area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_SH = Gest(ACLED_sh_ppp, correction = \"border\")\nplot(G_SH, xlim = c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n\nI begin by computing the G-function for the Shwebo area using the `Gest()` function. The `correction = \"border\"` option is applied to adjust for edge effects that can bias the results when points near the boundary have fewer neighbors. The plot shows the empirical G-function, providing insight into the spatial distribution of points up to 500 meters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_SH.csr <- envelope(ACLED_sh_ppp, Gest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n:::\n\n\nNext, I compute an envelope of the G-function under Complete Spatial Randomness (CSR) using 999 simulations. This helps compare the observed spatial pattern with what would be expected if the events were randomly distributed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(G_SH.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **G-function (G_SH.csr)** plot for the Shwebo area reveals the spatial distribution of conflict events relative to a Complete Spatial Randomness (CSR) model. The black line represents the observed G-function, while the grey lines represent the CSR envelope generated through simulations. The observed G-function rises above the CSR envelope for distances between approximately 50 to 150 meters, indicating significant clustering of events at these spatial scales. Beyond 150 meters, the observed G-function gradually approaches the CSR envelope, suggesting a decrease in clustering. This indicates that conflict events in Shwebo are not randomly distributed but instead exhibit spatial clustering, particularly at shorter distances, reflecting localized groupings of events within this area.\n\n#### 4.1.2 Yinmarbin area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_YI = Gest(ACLED_yi_ppp, correction = \"best\")\nplot(G_YI)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n\nSimilarly, I compute the G-function for the Yinmarbin area, this time using the \"best\" correction to optimize the adjustment for edge effects. The plot shows the empirical G-function for the district.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_YI.csr <- envelope(ACLED_yi_ppp, Gest, correction = \"all\", nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n:::\n\n\nThe CSR envelope for Yinmarbin is generated with 999 simulations and includes all possible corrections to improve the accuracy of the comparison.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(G_YI.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-52-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **G-function (G_YI.csr)** plot for the Yinmarbin area shows the spatial distribution of conflict events in relation to the Complete Spatial Randomness (CSR) model. The observed G-function (black line) rises sharply and exceeds the CSR envelope (grey dashed lines) for distances up to around 150 meters, indicating significant clustering of conflict events at this scale. After 150 meters, the G-function flattens and remains above the CSR envelope, which suggests that clustering is persistent across larger distances, though less pronounced compared to shorter ranges. The spatial pattern of conflict events in Yinmarbin is clearly non-random, with a high degree of clustering evident particularly at short distances, suggesting localized concentrations of conflict within this region.\n\n### **4.2 F-Function Analysis**\n\nThe F-function, or empty-space function, measures the distribution of distances from arbitrary locations in space to the nearest event. It provides an alternative way to assess the spatial distribution of events, complementing the G-function by focusing on the \"gaps\" between points.\n\n#### 4.2.1 Shwebo area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF_SH = Fest(ACLED_sh_ppp)\nplot(F_SH)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n\nThe F-function for Shwebo is computed using the `Fest()` function. This plot shows the distance distribution between random points in the area and the nearest conflict events, helping to identify whether the event points are clustered or dispersed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF_SH.csr <- envelope(ACLED_sh_ppp, Fest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n:::\n\n\nSimilar to the G-function, I generate a CSR envelope for the F-function using 999 simulations to compare the observed spatial pattern with random expectations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(F_SH.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **F-function (F_SH.csr)** plot for the Shwebo area compares the spatial distribution of distances from random points to the nearest conflict event, relative to the Complete Spatial Randomness (CSR) model. The observed F-function (black line) remains below the CSR envelope (grey dashed lines) across most distances, particularly for distances under 1500 meters. This indicates that events are more dispersed than expected under CSR, with larger empty spaces between conflict events and random points in Shwebo. The observed pattern suggests a spatial regularity or inhibition effect, meaning that events are not densely clustered but instead spaced out across the region, with relatively few close neighbors.\n\n#### 4.2.2 Yinmarbin area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF_YI = Fest(ACLED_yi_ppp, correction = \"best\")\nplot(F_YI)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-56-1.png){width=672}\n:::\n:::\n\n\nFor Yinmarbin, I compute the F-function using the \"best\" correction to account for edge effects. This plot reveals the distribution of distances from random locations to the nearest conflict events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF_YI.csr <- envelope(ACLED_yi_ppp, Fest, correction = \"all\", nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n:::\n\n\nAn envelope of the F-function under CSR is generated with 999 simulations and all available corrections, ensuring robust comparison.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(F_YI.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **F-function (F_YI.csr)** plot for the Yinmarbin area indicates the distribution of distances from random points to the nearest conflict event compared to a Complete Spatial Randomness (CSR) model. The observed F-function (black line) lies below the CSR envelope (grey dashed lines) across most distances, particularly up to around 1500 meters. This suggests that events are more regularly spaced than would be expected under random distribution, indicating a lower likelihood of clustering in the immediate surroundings of conflict events. The results point to spatial dispersion or inhibition, with relatively large gaps between conflict events and random points across the Yinmarbin area. This indicates that conflict events are more evenly spaced rather than concentrated in close proximity to one another.\n\n### **4.3 K-Function Analysis**\n\nThe K-function is a second-order spatial point pattern statistic that analyzes the spatial dependence between points at different distances. It helps detect clustering or regularity over varying scales, which is especially useful for understanding how events are distributed over space. Below is the analysis for both the Shwebo and Yinmarbin areas using the K-function.\n\n#### 4.3.1 Shwebo area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_SH = Kest(ACLED_sh_ppp, correction = \"Ripley\")\nplot(K_SH, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n\nThe K-function for the Shwebo area is computed using `Kest()` with Ripley's edge correction to account for boundary effects. The plot of `K(d)-r` shows the deviation from Complete Spatial Randomness (CSR) at different distances `d`. This helps identify whether the events are clustered (above the line) or regularly spaced (below the line) over varying spatial scales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_SH.csr <-envelope(ACLED_sh_ppp, Kest, nsim = 9, rank = 10, glocal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 9 simulations of CSR  ...\n1, 2, \n[27:59 remaining, estimate finish 2024-09-22 18:31:23]\n3, \n[23:30 remaining, estimate finish 2024-09-22 18:30:45]\n4, \n[19:13 remaining, estimate finish 2024-09-22 18:30:10]\n5, \n[15:11 remaining, estimate finish 2024-09-22 18:29:47]\n6, \n[11:25 remaining, estimate finish 2024-09-22 18:29:52]\n7,  [7:35 remaining] 8,  [3:50 remaining] \n9.\n\nDone.\n```\n\n\n:::\n:::\n\n\nTo evaluate the results against CSR, I generate an envelope using 9 simulations (`nsim = 9`) with global and local envelope comparisons (`glocal = TRUE`). This allows me to assess whether the observed spatial distribution significantly deviates from randomness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(K_SH.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **K-function (K_SH.csr)** plot for the Shwebo area reveals significant clustering of conflict events over various spatial scales when compared to the Complete Spatial Randomness (CSR) model. The observed K-function (black line) consistently rises above the CSR envelope (grey dashed lines) across the distance range. This deviation indicates that conflict events are more clustered than expected under randomness, particularly over larger distances. As the distance `d` increases, the clustering effect becomes more pronounced, signifying that conflict events in Shwebo tend to occur in closer proximity to each other over a broad spatial range. This pattern suggests that conflict events in Shwebo are spatially aggregated, with noticeable clustering extending over considerable distances.\n\n#### 4.3.2 Yinmarbin area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_YI = Kest(ACLED_yi_ppp, correction = \"Ripley\")\nplot(K_YI, . -r ~ r, \n     ylab= \"K(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-62-1.png){width=672}\n:::\n:::\n\n\nThe K-function for Yinmarbin is similarly computed using `Kest()` with Ripley's correction. The plot of `K(d)-r` shows the spatial dependency between conflict events over increasing distances, with `d` representing the distance in meters. I also restrict the plot to a maximum distance of 1000 meters for more focused analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_YI.csr <- envelope(ACLED_yi_ppp, Kest, nsim = 9, rank = 10, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 9 simulations of CSR  ...\n1, 2,  [6:19 remaining] 3,\n [5:32 remaining] 4,  [4:34 remaining] 5,  [3:38 remaining] 6,\n [2:43 remaining] 7,  [1:48 remaining] 8,  [54 sec remaining] \n9.\n\nDone.\n```\n\n\n:::\n:::\n\n\nAn envelope for the K-function is generated for Yinmarbin, allowing for a comparison of the observed spatial pattern against the null hypothesis of CSR, using 9 simulations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(K_YI.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"K(d)-r\", xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-64-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nError in UseMethod(\"distmap\") : \n  no applicable method for 'distmap' applied to an object of class \"im\"\n```\n\n\n:::\n:::\n\n\n***Observation***\n\n| The **K-function (K_YI.csr)** plot for the Yinmarbin area indicates clustering of conflict events at various spatial scales. The observed K-function (black line) lies above the CSR envelope (grey dashed lines) for distances up to approximately 250 meters, suggesting significant clustering of events at these smaller spatial scales. Beyond 250 meters, the observed K-function approaches the CSR envelope, indicating that the clustering effect diminishes at larger distances. However, within the first 250 meters, the clustering of events is evident, meaning that conflict events in Yinmarbin are more likely to occur close to each other than would be expected under a random distribution.\n\n### **4.4 L-Function Analysis**\n\nThe L-function is a variance-stabilized version of the K-function, which linearizes the results to make deviations from CSR easier to interpret. This section presents the L-function analysis for both the Shwebo and Yinmarbin areas.\n\n#### 4.4.1 Shwebo area\n\n\n::: {.cell}\n\n```{.r .cell-code}\nL_SH = Lest(ACLED_sh_ppp, correction = \"Ripley\")\nplot(L_SH, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-65-1.png){width=672}\n:::\n:::\n\n\nI compute the L-function for Shwebo using `Lest()`, with Ripley's correction applied. The plot of `L(d)-r` shows how the spatial point pattern compares to CSR over varying distances `d`. Values above zero indicate clustering, while values below zero suggest regularity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nL_SH.csr <- envelope(ACLED_sh_ppp, Lest, nsim = 9, rank = 10, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 9 simulations of CSR  ...\n1, 2, \n[28:53 remaining, estimate finish 2024-09-22 19:30:30]\n3, \n[23:47 remaining, estimate finish 2024-09-22 19:29:12]\n4, \n[19:47 remaining, estimate finish 2024-09-22 19:29:08]\n5, \n[15:54 remaining, estimate finish 2024-09-22 19:29:17]\n6, \n[11:47 remaining, estimate finish 2024-09-22 19:28:55]\n7,  [7:59 remaining] 8,  [3:58 remaining] \n9.\n\nDone.\n```\n\n\n:::\n:::\n\n\nThe CSR envelope is calculated with 9 simulations, enabling a comparison between the observed spatial pattern and the expected pattern under randomness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(L_SH.csr, . - r ~ r, xlab=\"d\", ylab=\"L(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-67-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **L-function (L_SH.csr)** plot for the Shwebo area shows significant deviations from the Complete Spatial Randomness (CSR) model, as indicated by the observed L-function (black line) consistently remaining above the CSR envelope (grey dashed lines). The fact that the observed L-function is well above the CSR line across the distance range suggests that conflict events in the Shwebo area exhibit strong spatial clustering, particularly at larger distances. The clustering effect becomes more pronounced beyond 15,000 meters, where the L-function increases sharply. This indicates that conflict events are not randomly distributed but are instead aggregated over large spatial scales, pointing to concentrated zones of conflict activity in the Shwebo region.\n\n#### 4.4.2 Yinmarbin area\n\nThe L-function analysis for Yinmarbin follows a similar approach to Shwebo, allowing for direct comparison of the two areas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nL_YI = Lest(ACLED_yi_ppp, correction = \"Ripley\")\nplot(L_YI, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-68-1.png){width=672}\n:::\n:::\n\n\nThe L-function for Yinmarbin is computed and plotted, with the `L(d)-r` graph showing how the events are distributed spatially up to 1000 meters. This provides insight into clustering or dispersion patterns at different scales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nL_YI.csr <- envelope(ACLED_yi_ppp, Lest, nsim = 9, rank = 10, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 9 simulations of CSR  ...\n1, 2,  [6:19 remaining] 3,\n [5:31 remaining] 4,  [4:40 remaining] 5,  [3:46 remaining] 6,\n [2:51 remaining] 7,  [1:54 remaining] 8,  [57 sec remaining] \n9.\n\nDone.\n```\n\n\n:::\n:::\n\n\nI generate the CSR envelope for the L-function with 9 simulations, allowing for robust comparisons between the observed event distribution and the CSR model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(L_YI.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"L(d)-r\", xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-70-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The **L-function (L_YI.csr)** plot for the Yinmarbin area shows the observed L-function (black line) lying above the Complete Spatial Randomness (CSR) envelope (grey dashed lines), particularly at smaller spatial distances up to around 500 meters. This indicates significant clustering of conflict events at short spatial scales. As the distance increases, the L-function continues to rise, further confirming the clustering behavior of events within Yinmarbin. The consistent deviation from the CSR model implies that conflict events are spatially aggregated rather than randomly distributed, with strong clustering occurring over shorter distances and continuing as distances increase.\n\n## **5. Quarterly Spatio-Temporal Kernel Density Estimation (KDE)**\n\nIn this section, I perform a Spatio-Temporal Kernel Density Estimation (KDE) to analyze how conflict events evolve across both space and time. This approach provides insights into the spatial patterns of conflict over different quarters, offering a comprehensive view of how the intensity and distribution of events change throughout the period from January 2021 to June 2024.\n\nFirst, I create a `quarter` variable in the dataset, representing the combination of the event year and quarter. This is important for structuring the spatio-temporal analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf$quarter <- paste0(year(ymd(ACLED_sf$event_date)), \"-Q\", quarter(ymd(ACLED_sf$event_date)))\n```\n:::\n\n\nNext, I generate a sequence of unique quarter labels, ensuring all quarters within the specified date range are accounted for. These labels are based on the date range from January 2021 to June 2024.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_quarters <- seq(from = as.Date(\"2021-01-01\"), to = as.Date(\"2024-06-30\"), by = \"quarter\")\nquarter_labels <- paste0(year(unique_quarters), \"-Q\", quarter(unique_quarters))\n```\n:::\n\n\nI then convert the `quarter` variable into a numeric factor to facilitate its integration into the spatio-temporal KDE. Each quarter is assigned a unique numeric identifier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_sf$quarter <- as.numeric(factor(ACLED_sf$quarter, levels = quarter_labels))\n```\n:::\n\n\nI select the `quarter` variable from the dataset, preparing it for use in the spatio-temporal point pattern analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_quarter <- ACLED_sf %>%\n  select(quarter)\n```\n:::\n\n\nNext, I convert the `ACLED_quarter` data into a spatial point pattern object (`ppp`), which is essential for performing KDE in a spatio-temporal context.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_quarter_ppp <- as.ppp(ACLED_quarter)\nACLED_quarter_ppp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern: 11128 points\nmarks are numeric, of storage type  'double'\nwindow: rectangle = [-16397.05, 256586.9] x [2393568.1, 2987342.4] units\n```\n\n\n:::\n:::\n\n\nUsing the `as.ppp()` function, I create the point pattern object based on the conflict event quarters. This object contains the spatial coordinates and the temporal information (quarters) of the events.\n\nI subset the spatial point pattern to focus only on events within the Sagaing region, using the spatial window (`owin`) of Sagaing. This ensures that the KDE is calculated only for the specific region of interest.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nACLED_quarter_owin <- ACLED_quarter_ppp[sagaing_owin]\nsummary(ACLED_quarter_owin)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  11128 points\nAverage intensity 1.185406e-07 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   5.000   7.000   7.693  10.000  14.000 \n\nWindow: polygonal boundary\n37 separate polygons (36 holes)\n                  vertices         area relative.area\npolygon 1 (hole)        12 -9.22970e-02     -9.83e-13\npolygon 2 (hole)         3 -2.78346e-03     -2.97e-14\npolygon 3 (hole)         3 -4.99414e-03     -5.32e-14\npolygon 4 (hole)         3 -6.70916e-04     -7.15e-15\npolygon 5 (hole)         3 -4.99759e-03     -5.32e-14\npolygon 6 (hole)         6 -3.24429e-03     -3.46e-14\npolygon 7 (hole)        11 -5.35508e-02     -5.70e-13\npolygon 8 (hole)         3 -3.06875e-03     -3.27e-14\npolygon 9 (hole)         3 -7.63674e-03     -8.14e-14\npolygon 10 (hole)        3 -8.61831e-05     -9.18e-16\npolygon 11 (hole)        3 -2.44103e-02     -2.60e-13\npolygon 12 (hole)        3 -4.88140e-05     -5.20e-16\npolygon 13 (hole)        4 -1.74466e-04     -1.86e-15\npolygon 14 (hole)        4 -2.30891e-05     -2.46e-16\npolygon 15 (hole)        4 -6.25342e-08     -6.66e-19\npolygon 16 (hole)        4 -3.68040e-02     -3.92e-13\npolygon 17 (hole)        3 -1.27234e-06     -1.36e-17\npolygon 18 (hole)        4 -1.25504e-03     -1.34e-14\npolygon 19 (hole)        3 -1.56980e-02     -1.67e-13\npolygon 20 (hole)        4 -1.13609e-06     -1.21e-17\npolygon 21 (hole)        4 -8.02867e-02     -8.55e-13\npolygon 22 (hole)        4 -3.98058e-05     -4.24e-16\npolygon 23 (hole)        3 -3.55050e-03     -3.78e-14\npolygon 24 (hole)        3 -2.84064e-02     -3.03e-13\npolygon 25 (hole)        3 -8.07642e-04     -8.60e-15\npolygon 26 (hole)        4 -5.20949e-03     -5.55e-14\npolygon 27 (hole)        4 -3.21397e-04     -3.42e-15\npolygon 28 (hole)        4 -2.54957e-05     -2.72e-16\npolygon 29 (hole)        3 -4.29634e-04     -4.58e-15\npolygon 30 (hole)        6 -6.02382e-04     -6.42e-15\npolygon 31 (hole)        4 -4.91852e-04     -5.24e-15\npolygon 32            5887  9.38750e+10      1.00e+00\npolygon 33 (hole)        8 -5.14960e-02     -5.49e-13\npolygon 34 (hole)        3 -1.87101e-06     -1.99e-17\npolygon 35 (hole)       31 -2.12239e-01     -2.26e-12\npolygon 36 (hole)        6 -4.99398e-02     -5.32e-13\npolygon 37 (hole)        4 -6.87492e-03     -7.32e-14\nenclosing rectangle: [-17699.96, 308341.37] x [2390344.6, 3029739.1] units\n                     (326000 x 639400 units)\nWindow area = 9.3875e+10 square units\nFraction of frame area: 0.45\n```\n\n\n:::\n:::\n\n\nI plot the spatio-temporal point pattern, which provides a visual representation of how conflict events are distributed across both space and time in the Sagaing region. This plot helps to visualize the spatial evolution of conflict across different quarters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ACLED_quarter_owin)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-77-1.png){width=672}\n:::\n:::\n\n\nNext, I calculate the KDE for conflict events within the Sagaing region across multiple quarters. This allows me to observe the density and distribution of conflict events both spatially and temporally.\n\nI begin by computing the spatio-temporal KDE using the `spattemp.density()` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_kde_ACLED <- spattemp.density(ACLED_quarter_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n:::\n\n\nHere, I apply the `spattemp.density()` function to the spatio-temporal point pattern object `ACLED_quarter_owin`, which represents the conflict events restricted to Sagaing. This function calculates the KDE over both space and time, producing a density estimate that shows how conflict intensity varies spatially across different quarters.\n\nNext, I create a mapping between the numeric quarter values and the actual quarter labels (e.g., \"2021-Q1\"). This allows for clear labeling in the plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarter_numbers <- 1:length(quarter_labels)\n\nquarter_map <- setNames(quarter_labels, quarter_numbers)\n\ntims <- seq(1, 14, by = 1)\n```\n:::\n\n\nHere, `quarter_numbers` generates a sequence for each quarter, while `quarter_map` associates each number with its corresponding quarter label. The sequence `tims` defines the range of quarters to be plotted, from Q1 2021 to Q2 2024.\n\nI set up a plotting environment to display two KDE plots at a time, side by side. This allows for easy comparison between different quarters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfcol = c(1, 2), mar = c(4, 4, 4, 4))\n```\n:::\n\n\nFinally, I loop through the defined quarters, generating KDE plots for each one. These plots represent the spatial distribution of conflict events at each quarter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (i in tims) {\n  plot(st_kde_ACLED, i, \n       override.par = FALSE, \n       fix.range = TRUE, \n       main = paste(\"STKDE at Quarter\", quarter_map[i]))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-11.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-81-14.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The KDE plots from **2021-Q1 to 2024-Q2** reveal temporal shifts and spatial patterns of conflict intensity in the Sagaing region. Over the observed quarters, there are consistent hotspots of activity, primarily in the southern part of the region. The intensity of these hotspots, shown in red and yellow, fluctuates over time but remains focused on similar areas. Central and northern parts of Sagaing see occasional but less intense activity, indicated by the blue and pink regions. Notably, from **2021-Q4** onward, the density of events in the southern region grows more concentrated, highlighting persistent conflict in this area. The pattern suggests that while conflict is somewhat spread across the region, specific areas experience a higher and more consistent intensity of events over time.\n\n## **6. 2nd-Order Spatio-temporal Point Patterns Analysis**\n\nIn this section, I perform 2nd-order spatio-temporal point pattern analysis for conflict events in the Sagaing region. Specifically, I apply the G-function and K-function to each quarter, comparing the spatial distribution of events to a Complete Spatial Randomness (CSR) model. This analysis helps identify spatial clustering or regularity of conflict events over time.\n\nI begin by extracting the unique quarters from the dataset, which will be used to loop through each quarter for analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarters <- unique(ACLED_sf$quarter)\n```\n:::\n\n\nThis ensures that each quarter is analyzed individually, focusing on how conflict events are distributed spatially within each time period.\n\n### **6.1 G-Function**\n\nFor each quarter, I compute the G-function to evaluate the spatial distribution of events and compare it to the CSR model using an envelope.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarter_labels <- c(\"2021-Q1\", \"2021-Q2\", \"2021-Q3\", \"2021-Q4\", \n                    \"2022-Q1\", \"2022-Q2\", \"2022-Q3\", \"2022-Q4\", \n                    \"2023-Q1\", \"2023-Q2\", \"2023-Q3\", \"2023-Q4\",\n                    \"2024-Q1\", \"2024-Q2\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (q in quarters) {\n  \n  quarter_data <- ACLED_sf[ACLED_sf$quarter == q, ]\n  \n  spatial_points <- st_coordinates(quarter_data)\n  time_points <- quarter_data$timestamp \n  \n  time_points <- as.numeric(na.omit(time_points))\n  \n  if (length(time_points) <= 1) {\n    warning(paste(\"Not enough valid time points for quarter\", q))\n    next\n  }\n  \n  spatial_ppp <- ppp(x = spatial_points[,1], \n                     y = spatial_points[,2], \n                     window = as.owin(sagaing_owin))  \n  \n  spatial_ppp <- rjitter(spatial_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  G_spatial <- tryCatch(Gest(spatial_ppp, correction = \"border\"),\n                        error = function(e) {\n                          warning(paste(\"Error in Gest for quarter\", q, \":\", e$message))\n                          return(NULL)\n                        })\n  \n  if (!is.null(G_spatial)) {\n    plot(G_spatial, main = paste(\"Spatial G-function for Quarter\", q), xlim = c(0, 500))\n  \n    G_env <- tryCatch(envelope(spatial_ppp, Gest, nsim = 999, correction = \"border\"),\n                      error = function(e) {\n                        warning(paste(\"Error in envelope for quarter\", q, \":\", e$message))\n                        return(NULL)\n                      })\n    \n    if (!is.null(G_env)) {\n      plot(G_env, main = paste(\"G-function with CSR Envelope for\", quarter_labels[q]))\n    }\n  }\n\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-15.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-16.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-17.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-18.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-19.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-20.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-21.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-22.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-23.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-24.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-25.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-26.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in value[[3L]](cond): Error in envelope for quarter 1 : missing value\nwhere TRUE/FALSE needed\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-84-27.png){width=672}\n:::\n:::\n\n\nIn this loop:\n\n1.  **Extract Quarter Data**: The dataset is filtered to include only the events corresponding to the current quarter (`q`). The spatial coordinates (`st_coordinates()`) and time points (`timestamp`) for the events are extracted.\n\n2.  **Check Time Points**: If the quarter has fewer than two valid time points, the loop moves to the next quarter as it’s not possible to compute meaningful statistics.\n\n3.  **Create Point Pattern Object**: The spatial coordinates are converted into a point pattern object (`ppp`) using the `ppp()` function, and jittering (`rjitter()`) is applied to avoid overlapping points.\n\n4.  **G-Function Calculation**: The G-function is computed using the `Gest()` function with a \"border\" correction to adjust for edge effects. If an error occurs during this calculation, the error is caught and a warning is issued.\n\n5.  **Plot G-Function**: If the G-function is successfully computed, it is plotted to show the spatial distribution of events for the current quarter. Quarter 14 refers to \"2024-Q2\", quarter 13 refers to \"2024-Q1\", and so on.\n\n6.  **Envelope with CSR**: A CSR envelope is generated using `envelope()` with 999 simulations. This envelope helps compare the observed event distribution with a random spatial distribution. If the envelope is successfully computed, it is plotted alongside the G-function.\n\n## **7. Explore**\n\nIn this section, I explore key aspects of the conflict events data, including the distribution of event types, source scales for \"Strategic developments,\" and fatalities by event type. The analysis also focuses on the top actors involved in \"Strategic developments\" at the national level.\n\n### **7.1 Event Type Distribution**\n\nFirst, I summarize the number and percentage of each event type in the dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_summary <- ACLED_sf %>%\n  group_by(event_type) %>%\n  summarise(count = n()) %>%\n  mutate(percentage = count / sum(count) * 100) \n```\n:::\n\n\nThis step calculates the total number of events for each event type and computes the percentage share of each type relative to the total number of events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(event_summary, aes(x = \"\", y = percentage, fill = event_type)) +\n  geom_bar(width = 1, stat = \"identity\") + \n  coord_polar(\"y\", start = 0) + \n  theme_void() + \n  labs(fill = \"Event Type\", title = \"Percentage of Each Event Type\") +\n  theme(legend.position = \"right\") + \n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), \n            position = position_stack(vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-86-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The pie chart illustrates the distribution of conflict events by type in the Sagaing region. **Strategic developments** account for the largest portion of events, representing **31.7%** of the total. Both **Explosions/Remote violence** and **Violence against civilians** each constitute **26.8%** of the events, indicating their significant presence in the region. Meanwhile, **Battles** make up the smallest portion, at **14.8%** of all recorded events. This distribution highlights the prominence of strategic and violence-related events, with battles being comparatively less frequent.\n\n### **7.2 Source Scale for \"Strategic Developments\"**\n\nNext, I filter the dataset to focus on \"Strategic developments\" and analyze the source scale for these events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstrategic_data <- ACLED_sf %>%\n  filter(event_type == \"Strategic developments\")\n```\n:::\n\n\nI then calculate the distribution of source scales for these events:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource_summary_strategic <- strategic_data %>%\n  group_by(source_scale) %>%\n  summarise(count = n()) %>%\n  mutate(percentage = count / sum(count) * 100)\n```\n:::\n\n\nThe following plot displays the percentage breakdown of the source scale for \"Strategic developments.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(source_summary_strategic, aes(x = \"\", y = percentage, fill = source_scale)) +\n  geom_bar(width = 1, stat = \"identity\") + \n  coord_polar(\"y\", start = 0) + \n  theme_void() +\n  labs(fill = \"Source Scale\", title = \"Source Scale for Strategic Developments\") +\n  theme(legend.position = \"right\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), \n            position = position_stack(vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-89-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n| The pie chart shows that the majority of **Strategic developments** events are sourced at the **National** level, accounting for **62.7%** of the total. Smaller portions are reported at the **International** scale (**7.1%**) and the **Regional** scale (**4.7%**), with other categories such as **National-International**, **Subnational**, and **New media** each contributing less than 5%. This distribution indicates that most strategic events are driven by national-level sources, with limited involvement from international or subnational media outlets.\n\n### **7.3 Distribution of Fatalities by Event Type**\n\nI explore the distribution of fatalities across different event types using a histogram.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ACLED_sf, aes(x = fatalities)) +\n  geom_histogram(binwidth = 1, fill = \"skyblue\", color = \"black\") + \n  facet_wrap(~ event_type, scales = \"free\") + \n  labs(title = \"Distribution of Fatalities by Event Type\", \n       x = \"Number of Fatalities\", \n       y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-90-1.png){width=672}\n:::\n:::\n\n\nThis faceted histogram shows how fatalities are distributed across each event type, allowing for a clear comparison of the severity of each type of event.\n\n***Observation***\n\n| The histogram plots show the distribution of fatalities across different conflict event types. The majority of **Battles** and **Explosions/Remote violence** events result in fewer than 10 fatalities, with only a few extreme cases involving a higher number of deaths. **Strategic developments**, on the other hand, typically result in no fatalities, as evidenced by the large count at zero fatalities. **Violence against civilians** displays a wider range of fatalities, though most incidents also lead to fewer than 10 fatalities. These distributions suggest that while violence against civilians and explosions can sometimes cause more significant loss of life, fatalities remain relatively low across most events.\n\n### **7.4 Actors in \"Strategic Developments\" (National)**\n\nSince \"Strategic developments\" are the most frequent event type, with a large percentage attributed to \"National\" sources, I explore the top actors involved in these events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstrategic_data_national <- ACLED_sf %>%\n  filter(event_type == \"Strategic developments\", source_scale == \"National\")\n```\n:::\n\n\nI summarize the top 5 actors involved in these events for both Actor1 and Actor2:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactor1_top5 <- strategic_data_national %>%\n  group_by(actor1) %>%\n  summarise(count = n()) %>%\n  arrange(desc(count)) %>%\n  top_n(5, count) %>%\n  mutate(percentage = count / sum(count) * 100)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nactor2_top5 <- strategic_data_national %>%\n  group_by(actor2) %>%\n  summarise(count = n()) %>%\n  arrange(desc(count)) %>%\n  top_n(5, count) %>%\n  mutate(percentage = count / sum(count) * 100)\n```\n:::\n\n\nFinally, I visualize the top 5 actors for both Actor1 and Actor2:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(actor1_top5, aes(x = \"\", y = percentage, fill = actor1)) +\n  geom_bar(width = 1, stat = \"identity\") + \n  coord_polar(\"y\", start = 0) +  \n  theme_void() +  \n  labs(fill = \"Actor1\", title = \"Top 5 Actor1 in Strategic Developments (National)\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), \n            position = position_stack(vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-94-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(actor2_top5, aes(x = \"\", y = percentage, fill = actor2)) +\n  geom_bar(width = 1, stat = \"identity\") + \n  coord_polar(\"y\", start = 0) + \n  theme_void() + \n  labs(fill = \"Actor2\", title = \"Top 5 Actor2 in Strategic Developments (National)\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), \n            position = position_stack(vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-95-1.png){width=672}\n:::\n:::\n\n\n***Observation***\n\n1.  **Top 5 Actor1 in Strategic Developments**:\n\n    -   The **Military Forces of Myanmar (2021-)** dominate **Actor1**, representing **87.3%** of all strategic development events. Other actors, such as the **Police Forces of Myanmar** and **Civilians (Myanmar)**, play minor roles, each accounting for less than 8% of the events.\n\n2.  **Top 5 Actor2 in Strategic Developments**:\n\n    -   **Civilians (Myanmar)** account for **79.4%** of all Actor2 interactions, indicating that they are often on the receiving end of strategic development actions. **Unidentified Armed Groups** and **Military Forces of Myanmar (2021-)** are also present, but to a much lesser extent.\n\n3.  Given that the **Military Forces of Myanmar (2021-)** appear as the dominant **Actor1** and **Civilians (Myanmar)** make up a substantial portion of **Actor2**, it is likely that strategic developments primarily involve military actions directed toward civilians. This suggests a potential power imbalance where the military is engaging in activities that impact civilians, possibly in the context of enforcement, control, or conflict management. The high representation of civilians in the Actor2 category could indicate that they are frequently affected by military operations, either as targets of enforcement or in situations involving military governance or conflict suppression.\n\n### 7.5 Research\n\nI have found out that the **displacement crisis in central Myanmar**, especially in **Sagaing**, has escalated due to military actions following the coup. The burning of homes and civilian infrastructure by military forces has led to widespread displacement, with estimates of **one million to over two million internally displaced persons (IDPs)** in Sagaing, an area that had no prior reports of displacement. The **National Unity Government (NUG)** and grassroots networks, such as the **Sagaing Forum**, are coordinating aid deliveries to address this humanitarian crisis.\n\nIn my findings, **Strategic developments** events, where the **Military Forces of Myanmar (2021-)** are the dominant Actor1, align with the reported destruction in Sagaing. The military's role in strategic activities, accounting for **87.3% of Actor1**, is closely linked to civilian suffering, as **Civilians (Myanmar)** constitute **79.4% of Actor2**. This supports the research that highlights the military's actions as a key driver of displacement.\n\nAdditionally, the **KDE plots** show concentrated conflict activity in southern Sagaing, corroborating reports that Sagaing has become a hotspot for conflict, displacement, and resistance efforts. Resistance groups such as the **Kalay Civil Army (KCA)**, formed in response to brutal military crackdowns, have armed themselves with traditional weapons like **tumi guns** and, in some cases, modern firearms to fight back. Sagaing has seen intense confrontations, particularly in towns like **Kalay**, **Monywa**, and **Tamu**, where resistance movements have organized against the military.\n\nThe **March 27 massacre** and the subsequent resistance in Kalay, where protesters even conducted prisoner swaps and held the protest camp for over 10 days, demonstrate the strong opposition to military rule. These efforts have been replicated in other townships, contributing to the **armed resistance** in Sagaing. The region’s history of pro-democracy protests, dating back to the **1988 uprising** and the **Saffron Revolution in 2007**, further explains why Sagaing has become a focal point of both resistance and military crackdown.\n\nIn conclusion, I have found out that the **conflict intensity**, **displacement**, and **armed resistance** in Sagaing are closely tied to the military’s strategic operations. My findings indicate a direct impact of military actions on civilians, through both displacement and violent confrontations, as seen in the **KDE plots** and the dominance of military forces in strategic developments. The resistance efforts, including the use of traditional and modern weaponry by groups like the KCA, underscore the region’s determination to oppose the military, even as displacement and violence escalate.\n\n## 8. Reference & Declaration\n\nI hereby declare that part of the phrasing and explanation in this report has been generated and/or assisted by the use of OpenAI's ChatGPT, which provided assistance in structuring and summarizing the content, as well as offering insights based on the information I provided. The analysis and conclusions drawn in this report, however, are based on my research, data analysis, and interpretation of findings.\n\n<https://myanmar.iiss.org/analysis/humanitarian>\n\n<https://www.frontiermyanmar.net/en/the-tumi-revolution-protesters-fight-back-in-sagaing-region/>\n\n<https://www.frontiermyanmar.net/en/conscription-or-conflict-dry-zone-draft-dodgers-come-home/>\n",
    "supporting": [
      "Take-Home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}