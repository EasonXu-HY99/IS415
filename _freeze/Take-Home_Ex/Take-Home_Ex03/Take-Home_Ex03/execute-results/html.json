{
  "hash": "2008fd36e1a6152c5fbc95263a22a599",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Exercise 3\"\nauthor: \"Xu Haiyang\"\ndate: \"14 October, 2024\" \ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\n# **Prototyping Modules for Geospatial Analytics Shiny Application**\n\n## **Overview**\n\nPrototyping serves as a pivotal step in application development, bridging theoretical design with practical user interaction. A well-constructed prototype validates design decisions by providing a tangible platform to test user experience (UX) elements with stakeholders. This approach helps refine the application's UX before further resources are invested, enhancing both efficiency and effectiveness.\n\n## **Prototyping for Shiny Application**\n\nIn the context of developing a **Shiny application** using **R**, prototyping plays a crucial role in defining technical requirements, testing functionality, and refining the user interface.\n\n1.  **Evaluating R Packages**: The initial step in Shiny prototyping involves identifying and validating R packages from CRAN that support the app’s functionality. This ensures the application’s foundation is reliable and compatible with the required analyses and visualizations.\n\n2.  **Testing R Code**: Prototyping also involves running and validating specific R code snippets to confirm they produce expected outputs. This testing process helps ensure a smooth experience for end-users by troubleshooting issues early.\n\n3.  **Setting Parameters and Outputs**: Deciding on the parameters and outputs to expose in the application is a key step. These will guide user interaction and determine the dynamic nature of the app.\n\n4.  **Designing the UI with Shiny Components**: The final prototyping phase involves selecting Shiny UI components that allow users to interact with the chosen parameters intuitively.\n\nThis structured approach facilitates a seamless transition from conceptual design to a fully functional application, prioritizing both technical robustness and user experience.\n\n# **Understanding Basics of Shiny**\n\n**Shiny** is an open-source R package designed to simplify the creation of interactive web applications without requiring knowledge of web design languages like HTML, CSS, or JavaScript.\n\n### **Core Components of Shiny**\n\nA Shiny application typically consists of an **`app.R`** file that includes two main sections:\n\n1.  **User Interface (UI)** - Defines the front-end layout and elements that users interact with.\n\n2.  **Server** - Contains the back-end logic, handling input-processing and output-rendering functions.\n\nThis modular structure keeps the UI and server functions distinct, ensuring a clean, organized codebase.\n\n### **UI Layout in Shiny**\n\nThe Shiny UI includes components like:\n\n1.  **Header Panel** (`headerPanel`): Displays the app’s title or brief descriptions.\n\n2.  **Sidebar Panel** (`sidebarPanel`): A vertical panel for input controls, offering users a way to interact with the app.\n\n3.  **Main Panel** (`mainPanel`): The primary area for output displays (e.g., maps, plots, tables).\n\n### **Flexible Layout with FluidRow and Column**\n\nShiny employs a grid layout system through `fluidRow()` and `column()`, based on a 12-column structure, allowing flexible UI design. Each `fluidRow` can hold multiple `column` elements, enabling a variety of layouts by adjusting column widths.\n\n### **Navbar Pages for Organized Layouts**\n\nTo structure complex applications, **`navbarPage()`** is available, enabling multiple sub-components within the app, each with distinct sidebar, tabset, or layout configurations.\n\n### **User Inputs and Controls in Sidebar Panel**\n\nShiny provides various functions for defining user inputs, such as:\n\n-   **`sliderInput()`**: Creates a slider for range-based input.\n\n-   **`selectInput()`**: Generates a dropdown list.\n\n-   **`textInput()`**: Adds a text box for user input.\n\n-   **`numericInput()`**: Allows users to enter numeric values.\n\n-   **`checkboxInput()` & `checkboxGroupInput()`**: Useful for binary or multiple-choice selections.\n\nAfter configuring inputs, **`submitButton()`** compiles and sends inputs to the server, updating outputs accordingly.\n\n### **Outputs in Main Panel**\n\nOutputs are defined in the main panel with placeholders like:\n\n-   **`textOutput()`**, **`tableOutput()`**, and **`plotOutput()`**.\n\n-   Rendered on the UI via corresponding functions (`renderText`, `renderTable`, `renderPlot`), these components can be customized using `fluidRow()` and `column()`.\n\n### **Organizing Outputs with Tabsets**\n\nTo segment content in the main panel, **`tabsetPanel()`** creates a series of tabs, helping organize multiple outputs within the application.\n\n![](images/clipboard-873200038.png)\n\n### **Server Component**\n\nThe server function processes inputs from the UI and defines outputs based on input values. It typically includes parameters for:\n\n-   **Input**: Accesses user-specified UI inputs.\n\n-   **Output**: Dictates output displays on the UI.\n\n-   **Session** (optional): Manages session-specific settings.\n\nThe **UI and server interaction** is a two-way communication loop, where inputs from the UI are processed by the server, and the resulting outputs are displayed back on the UI.\n\n# **Analysing R-Packages**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(spdep, tmap, sf, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, tidyverse, GGally)\n```\n:::\n\n\n\nThis line uses `pacman::p_load` to load all necessary packages in one command, ensuring that all packages required for data manipulation, visualization, clustering, and spatial analysis are ready for use.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_geo <- st_read(dsn = \"data/geospatial/DiaphanTinh\", layer = \"Dia_phan_Tinh\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `Dia_phan_Tinh' from data source \n  `C:\\EasonXu-HY99\\IS415\\Take-Home_Ex\\Take-Home_Ex03\\data\\geospatial\\DiaphanTinh' \n  using driver `ESRI Shapefile'\nSimple feature collection with 63 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 102.1421 ymin: 6.953306 xmax: 116.9473 ymax: 23.3939\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(vietnam_geo, \"data/rds/vietnam_geo.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(vietnam_geo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 63\nColumns: 3\n$ Code     <chr> \"AD01\", \"AD01\", \"AD01\", \"AD01\", \"AD01\", \"AD01\", \"AD01\", \"AD01…\n$ Name     <chr> \"An Giang\", \"Ba Ria - Vung Tau\", \"Bac Giang\", \"Bac Kan\", \"Bac…\n$ geometry <MULTIPOLYGON [°]> MULTIPOLYGON (((105.1152 10..., MULTIPOLYGON (((…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms <- read_csv(\"data/aspatial/farms.csv\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 69 Columns: 61\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (50): Cities, provincies, 2012 Total, 2012 Cultivation farm, 2012 Livest...\ndbl (11): 2014 Total, 2015 Total, 2015 Livestock farm, 2016 Total, 2016 Live...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(farms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Cities, provincies  2012 Total        2012 Cultivation farm\n Length:69          Length:69          Length:69            \n Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character     \n                                                            \n                                                            \n                                                            \n 2012 Livestock farm 2012 Fishing farm  2012 Others(*)      2013 Total       \n Length:69           Length:69          Length:69          Length:69         \n Class :character    Class :character   Class :character   Class :character  \n Mode  :character    Mode  :character   Mode  :character   Mode  :character  \n                                                                             \n                                                                             \n                                                                             \n 2013 Cultivation farm 2013 Livestock farm 2013 Fishing farm \n Length:69             Length:69           Length:69         \n Class :character      Class :character    Class :character  \n Mode  :character      Mode  :character    Mode  :character  \n                                                             \n                                                             \n                                                             \n 2013 Others(*)       2014 Total     2014 Cultivation farm 2014 Livestock farm\n Length:69          Min.   :   1.0   Length:69             Length:69          \n Class :character   1st Qu.:  61.0   Class :character      Class :character   \n Mode  :character   Median : 361.0   Mode  :character      Mode  :character   \n                    Mean   : 785.9                                            \n                    3rd Qu.: 697.0                                            \n                    Max.   :7599.0                                            \n 2014 Fishing farm  2014 Others(*)       2015 Total     2015 Cultivation farm\n Length:69          Length:69          Min.   :   1.0   Length:69            \n Class :character   Class :character   1st Qu.:  71.0   Class :character     \n Mode  :character   Mode  :character   Median : 370.0   Mode  :character     \n                                       Mean   : 851.9                        \n                                       3rd Qu.: 710.0                        \n                                       Max.   :7347.0                        \n 2015 Livestock farm 2015 Fishing farm  2015 Others(*)       2016 Total    \n Min.   :   1.0      Length:69          Length:69          Min.   :   1.0  \n 1st Qu.:  32.0      Class :character   Class :character   1st Qu.: 107.0  \n Median : 105.0      Mode  :character   Mode  :character   Median : 453.0  \n Mean   : 436.8                                            Mean   : 970.7  \n 3rd Qu.: 501.0                                            3rd Qu.: 927.0  \n Max.   :5998.0                                            Max.   :9946.0  \n 2016 Cultivation farm 2016 Livestock farm 2016 Fishing farm \n Length:69             Min.   :   1.0      Length:69         \n Class :character      1st Qu.:  43.0      Class :character  \n Mode  :character      Median : 124.0      Mode  :character  \n                       Mean   : 604.9                        \n                       3rd Qu.: 593.0                        \n                       Max.   :8726.0                        \n 2016 Others(*)       2017 Total      2017 Cultivation farm 2017 Livestock farm\n Length:69          Min.   :    1.0   Length:69             Min.   :   1.0     \n Class :character   1st Qu.:  114.0   Class :character      1st Qu.:  46.0     \n Mode  :character   Median :  466.0   Mode  :character      Median : 130.0     \n                    Mean   :  986.9                         Mean   : 613.3     \n                    3rd Qu.:  960.0                         3rd Qu.: 618.0     \n                    Max.   :10120.0                         Max.   :8841.0     \n 2017 Fishing farm  2017 Others(*)       2018 Total     2018 Cultivation farm\n Length:69          Length:69          Min.   :   1.0   Length:69            \n Class :character   Class :character   1st Qu.: 113.0   Class :character     \n Mode  :character   Mode  :character   Median : 447.0   Mode  :character     \n                                       Mean   : 917.9                        \n                                       3rd Qu.: 846.0                        \n                                       Max.   :9192.0                        \n 2018 Livestock farm 2018 Fishing farm  2018 Others(*)       2019 Total    \n Min.   :   1.0      Length:69          Length:69          Min.   :   2.0  \n 1st Qu.:  43.0      Class :character   Class :character   1st Qu.: 114.0  \n Median : 150.0      Mode  :character   Mode  :character   Median : 447.0  \n Mean   : 569.2                                            Mean   : 936.6  \n 3rd Qu.: 580.0                                            3rd Qu.: 861.0  \n Max.   :7882.0                                            Max.   :9593.0  \n 2019 Cultivation farm 2019 Livestock farm 2019 Fishing farm \n Length:69             Min.   :   1.0      Length:69         \n Class :character      1st Qu.:  45.0      Class :character  \n Mode  :character      Median : 156.0      Mode  :character  \n                       Mean   : 588.7                        \n                       3rd Qu.: 580.0                        \n                       Max.   :8180.0                        \n 2019 Others(*)      2020 Total        2020 Cultivation farm\n Length:69          Length:69          Length:69            \n Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character     \n                                                            \n                                                            \n                                                            \n 2020 Livestock farm 2020 Fishing farm  2020 Others(*)      2021 Total       \n Length:69           Length:69          Length:69          Length:69         \n Class :character    Class :character   Class :character   Class :character  \n Mode  :character    Mode  :character   Mode  :character   Mode  :character  \n                                                                             \n                                                                             \n                                                                             \n 2021 Cultivation farm 2021 Livestock farm 2021 Fishing farm \n Length:69             Length:69           Length:69         \n Class :character      Class :character    Class :character  \n Mode  :character      Mode  :character    Mode  :character  \n                                                             \n                                                             \n                                                             \n 2021 Others(*)      2022 Total        2022 Cultivation farm\n Length:69          Length:69          Length:69            \n Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character     \n                                                            \n                                                            \n                                                            \n 2022 Livestock farm 2022 Fishing farm  2022 Others(*)      2023 Total       \n Length:69           Length:69          Length:69          Length:69         \n Class :character    Class :character   Class :character   Class :character  \n Mode  :character    Mode  :character   Mode  :character   Mode  :character  \n                                                                             \n                                                                             \n                                                                             \n 2023 Cultivation farm 2023 Livestock farm 2023 Fishing farm \n Length:69             Length:69           Length:69         \n Class :character      Class :character    Class :character  \n Mode  :character      Mode  :character    Mode  :character  \n                                                             \n                                                             \n                                                             \n 2023 Others(*)    \n Length:69         \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nenterprise <- read_csv(\"data/aspatial/enterprise.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 69 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Cities, provincies\ndbl (8): 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms <- farms %>%\n  mutate(`Cities, provincies` = str_trim(`Cities, provincies`)) %>%\n  filter(!`Cities, provincies` %in% c(\n    \"Red River Delta\", \"Northern midlands and mountain areas\", \n    \"Northern Central area and Central coastal area\", \"Central Highlands\", \n    \"South East\", \"Mekong River Delta\"\n  )) %>%\n  mutate(`Cities, provincies` = case_when(\n    `Cities, provincies` == \"Ho Chi Minh city\" ~ \"TP. Ho Chi Minh\",\n    `Cities, provincies` == \"Thai  Nguyen\" ~ \"Thai Nguyen\",\n    `Cities, provincies` == \"Thua Thien-Hue\" ~ \"Thua Thien - Hue\",\n    `Cities, provincies` == \"Quang  Nam\" ~ \"Quang Nam\",\n    `Cities, provincies` == \"Quang  Ngai\" ~ \"Quang Ngai\",\n    `Cities, provincies` == \"Khanh  Hoa\" ~ \"Khanh Hoa\",\n    `Cities, provincies` == \"Ninh  Thuan\" ~ \"Ninh Thuan\",\n    `Cities, provincies` == \"Binh  Duong\" ~ \"Binh Duong\",\n    `Cities, provincies` == \"Kien  Giang\" ~ \"Kien Giang\",\n    TRUE ~ `Cities, provincies`\n  )) %>%\n  mutate(across(-`Cities, provincies`, ~str_replace_all(., \"\\\\.\\\\.\", \"0\"))) %>%\n  mutate(across(-`Cities, provincies`, ~suppressWarnings(as.numeric(.))))\n\nprint(farms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 63 × 61\n   `Cities, provincies` `2012 Total` `2012 Cultivation farm`\n   <chr>                       <dbl>                   <dbl>\n 1 Ha Noi                       1233                      11\n 2 Vinh Phuc                     508                       0\n 3 Bac Ninh                       74                       0\n 4 Quang Ninh                    141                       4\n 5 Hai Duong                     506                       3\n 6 Hai Phong                     421                       1\n 7 Hung Yen                      353                       4\n 8 Thai Binh                     600                       4\n 9 Ha Nam                        240                       6\n10 Nam Dinh                      366                       2\n# ℹ 53 more rows\n# ℹ 58 more variables: `2012 Livestock farm` <dbl>, `2012 Fishing farm` <dbl>,\n#   `2012 Others(*)` <dbl>, `2013 Total` <dbl>, `2013 Cultivation farm` <dbl>,\n#   `2013 Livestock farm` <dbl>, `2013 Fishing farm` <dbl>,\n#   `2013 Others(*)` <dbl>, `2014 Total` <dbl>, `2014 Cultivation farm` <dbl>,\n#   `2014 Livestock farm` <dbl>, `2014 Fishing farm` <dbl>,\n#   `2014 Others(*)` <dbl>, `2015 Total` <dbl>, …\n```\n\n\n:::\n:::\n\n\n\nThis segment cleans and standardizes province names in `farms`, trimming whitespace and correcting inconsistent naming conventions (e.g., replacing \"Ho Chi Minh city\" with \"TP. Ho Chi Minh\"). It also removes rows representing regions rather than specific provinces. Missing values, represented as `..`, are replaced with `0` to facilitate calculations, and remaining non-province columns are converted to numeric format to avoid errors in numeric operations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(farms, \"data/rds/farms.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats <- farms %>%\n  select(starts_with(\"2012\"), starts_with(\"2013\"), starts_with(\"2014\"), starts_with(\"2015\"),\n         starts_with(\"2016\"), starts_with(\"2017\"), starts_with(\"2018\"), starts_with(\"2019\"),\n         starts_with(\"2020\"), starts_with(\"2021\"), starts_with(\"2022\"), starts_with(\"2023\")) %>%\n  summary()\n\nprint(\"Summary Statistics:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Summary Statistics:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(summary_stats)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   2012 Total     2012 Cultivation farm 2012 Livestock farm 2012 Fishing farm\n Min.   :   0.0   Min.   :   0.0        Min.   :   0.0      Min.   :   0.00  \n 1st Qu.:  33.0   1st Qu.:   1.0        1st Qu.:   9.0      1st Qu.:   0.00  \n Median : 141.0   Median :   6.0        Median :  38.0      Median :  11.00  \n Mean   : 359.6   Mean   : 140.7        Mean   : 129.1      Mean   :  74.92  \n 3rd Qu.: 507.0   3rd Qu.: 116.5        3rd Qu.: 168.5      3rd Qu.:  31.50  \n Max.   :3589.0   Max.   :1280.0        Max.   :1172.0      Max.   :2959.00  \n 2012 Others(*)     2013 Total     2013 Cultivation farm 2013 Livestock farm\n Min.   :  0.00   Min.   :   0.0   Min.   :   0.0        Min.   :   0.0     \n 1st Qu.:  0.00   1st Qu.:  38.0   1st Qu.:   0.5        1st Qu.:  14.0     \n Median :  2.00   Median : 212.0   Median :   5.0        Median :  45.0     \n Mean   : 14.94   Mean   : 377.4   Mean   : 138.8        Mean   : 146.1     \n 3rd Qu.:  8.00   3rd Qu.: 546.0   3rd Qu.: 113.5        3rd Qu.: 194.0     \n Max.   :199.00   Max.   :3536.0   Max.   :1197.0        Max.   :1329.0     \n 2013 Fishing farm 2013 Others(*)     2014 Total     2014 Cultivation farm\n Min.   :   0.00   Min.   :  0.00   Min.   :   1.0   Min.   :  0.0        \n 1st Qu.:   0.00   1st Qu.:  0.00   1st Qu.:  55.5   1st Qu.:  0.5        \n Median :   9.00   Median :  3.00   Median : 286.0   Median :  8.0        \n Mean   :  74.44   Mean   : 17.98   Mean   : 430.4   Mean   :141.8        \n 3rd Qu.:  33.00   3rd Qu.: 15.00   3rd Qu.: 607.0   3rd Qu.:143.5        \n Max.   :2917.00   Max.   :195.00   Max.   :3479.0   Max.   :965.0        \n 2014 Livestock farm 2014 Fishing farm 2014 Others(*)     2015 Total    \n Min.   :   0.0      Min.   :   0.00   Min.   :  0.00   Min.   :   1.0  \n 1st Qu.:  18.0      1st Qu.:   0.00   1st Qu.:  1.00   1st Qu.:  66.5  \n Median :  72.0      Median :   7.00   Median :  3.00   Median : 298.0  \n Mean   : 200.7      Mean   :  73.71   Mean   : 14.17   Mean   : 466.5  \n 3rd Qu.: 270.0      3rd Qu.:  36.50   3rd Qu.: 14.50   3rd Qu.: 666.0  \n Max.   :2099.0      Max.   :2927.00   Max.   :193.00   Max.   :3055.0  \n 2015 Cultivation farm 2015 Livestock farm 2015 Fishing farm 2015 Others(*)  \n Min.   :  0.0         Min.   :   1.0      Min.   :   0.00   Min.   :  0.00  \n 1st Qu.:  0.5         1st Qu.:  25.0      1st Qu.:   0.00   1st Qu.:  1.00  \n Median :  9.0         Median :  80.0      Median :   7.00   Median :  3.00  \n Mean   :145.7         Mean   : 239.2      Mean   :  66.27   Mean   : 15.37  \n 3rd Qu.:137.0         3rd Qu.: 328.0      3rd Qu.:  29.50   3rd Qu.: 14.00  \n Max.   :990.0         Max.   :2578.0      Max.   :2414.00   Max.   :205.00  \n   2016 Total     2016 Cultivation farm 2016 Livestock farm 2016 Fishing farm\n Min.   :   1.0   Min.   :   0.0        Min.   :   1.0      Min.   :  0.0    \n 1st Qu.: 100.0   1st Qu.:   1.0        1st Qu.:  41.0      1st Qu.:  1.0    \n Median : 319.0   Median :  13.0        Median : 115.0      Median :  9.0    \n Mean   : 531.6   Mean   : 146.3        Mean   : 331.3      Mean   : 37.3    \n 3rd Qu.: 866.5   3rd Qu.: 124.0        3rd Qu.: 402.5      3rd Qu.: 32.0    \n Max.   :3811.0   Max.   :1140.0        Max.   :3383.0      Max.   :336.0    \n 2016 Others(*)     2017 Total     2017 Cultivation farm 2017 Livestock farm\n Min.   :  0.00   Min.   :   1.0   Min.   :   0.0        Min.   :   1.0     \n 1st Qu.:  1.00   1st Qu.: 108.0   1st Qu.:   1.0        1st Qu.:  44.5     \n Median :  4.00   Median : 341.0   Median :  11.0        Median : 114.0     \n Mean   : 16.71   Mean   : 540.4   Mean   : 144.4        Mean   : 335.8     \n 3rd Qu.: 10.50   3rd Qu.: 856.0   3rd Qu.: 127.5        3rd Qu.: 457.0     \n Max.   :428.00   Max.   :3830.0   Max.   :1130.0        Max.   :3373.0     \n 2017 Fishing farm 2017 Others(*)     2018 Total     2018 Cultivation farm\n Min.   :  0.0     Min.   :  0.00   Min.   :   1.0   Min.   :   0.0       \n 1st Qu.:  1.0     1st Qu.:  0.00   1st Qu.: 103.0   1st Qu.:   1.0       \n Median : 11.0     Median :  3.00   Median : 354.0   Median :  10.0       \n Mean   : 41.7     Mean   : 18.48   Mean   : 502.7   Mean   : 134.9       \n 3rd Qu.: 32.0     3rd Qu.: 13.00   3rd Qu.: 759.5   3rd Qu.: 126.0       \n Max.   :336.0     Max.   :452.00   Max.   :3261.0   Max.   :1094.0       \n 2018 Livestock farm 2018 Fishing farm 2018 Others(*)     2019 Total    \n Min.   :   1.0      Min.   :  0.00    Min.   :  0.00   Min.   :   2.0  \n 1st Qu.:  42.0      1st Qu.:  1.00    1st Qu.:  0.00   1st Qu.:  98.0  \n Median : 125.0      Median :  8.00    Median :  4.00   Median : 397.0  \n Mean   : 311.7      Mean   : 37.02    Mean   : 19.02   Mean   : 512.9  \n 3rd Qu.: 426.5      3rd Qu.: 32.50    3rd Qu.: 10.50   3rd Qu.: 761.0  \n Max.   :2826.0      Max.   :347.00    Max.   :434.00   Max.   :3390.0  \n 2019 Cultivation farm 2019 Livestock farm 2019 Fishing farm 2019 Others(*)  \n Min.   :   0.0        Min.   :   1.0      Min.   :  0.00    Min.   :  0.00  \n 1st Qu.:   1.0        1st Qu.:  43.5      1st Qu.:  1.00    1st Qu.:  0.00  \n Median :  11.0        Median : 137.0      Median :  8.00    Median :  4.00  \n Mean   : 133.7        Mean   : 322.4      Mean   : 36.95    Mean   : 19.92  \n 3rd Qu.: 128.0        3rd Qu.: 440.5      3rd Qu.: 33.50    3rd Qu.: 10.00  \n Max.   :1098.0        Max.   :2955.0      Max.   :347.00    Max.   :434.00  \n   2020 Total     2020 Cultivation farm 2020 Livestock farm 2020 Fishing farm\n Min.   :   0.0   Min.   :  0.0         Min.   :   0.0      Min.   :  0.00   \n 1st Qu.:  86.5   1st Qu.:  3.0         1st Qu.:  23.5      1st Qu.:  0.00   \n Median : 261.0   Median : 19.0         Median :  91.0      Median :  9.00   \n Mean   : 375.6   Mean   :104.8         Mean   : 218.3      Mean   : 43.02   \n 3rd Qu.: 536.0   3rd Qu.:112.5         3rd Qu.: 228.5      3rd Qu.: 37.50   \n Max.   :2377.0   Max.   :903.0         Max.   :1741.0      Max.   :536.00   \n 2020 Others(*)     2021 Total     2021 Cultivation farm 2021 Livestock farm\n Min.   : 0.000   Min.   :   0.0   Min.   :  0.0         Min.   :   0.0     \n 1st Qu.: 0.000   1st Qu.:  90.0   1st Qu.:  3.0         1st Qu.:  31.0     \n Median : 2.000   Median : 254.0   Median : 20.0         Median : 101.0     \n Mean   : 9.444   Mean   : 377.3   Mean   :103.4         Mean   : 218.2     \n 3rd Qu.:10.000   3rd Qu.: 535.0   3rd Qu.:115.0         3rd Qu.: 237.0     \n Max.   :89.000   Max.   :2160.0   Max.   :897.0         Max.   :1740.0     \n 2021 Fishing farm 2021 Others(*)     2022 Total     2022 Cultivation farm\n Min.   :  0.00    Min.   :  0.00   Min.   :   0.0   Min.   :  0.0        \n 1st Qu.:  0.50    1st Qu.:  0.00   1st Qu.:  93.0   1st Qu.:  3.0        \n Median : 10.00    Median :  2.00   Median : 274.0   Median : 22.0        \n Mean   : 44.65    Mean   : 11.05   Mean   : 382.1   Mean   :100.1        \n 3rd Qu.: 39.50    3rd Qu.:  9.00   3rd Qu.: 542.5   3rd Qu.:115.0        \n Max.   :608.00    Max.   :103.00   Max.   :2032.0   Max.   :892.0        \n 2022 Livestock farm 2022 Fishing farm 2022 Others(*)     2023 Total    \n Min.   :   0.0      Min.   :  0.00    Min.   :  0.00   Min.   :   0.0  \n 1st Qu.:  29.0      1st Qu.:  0.50    1st Qu.:  0.00   1st Qu.:  94.0  \n Median : 104.0      Median :  9.00    Median :  2.00   Median : 284.0  \n Mean   : 223.6      Mean   : 46.67    Mean   : 11.81   Mean   : 395.8  \n 3rd Qu.: 244.5      3rd Qu.: 51.00    3rd Qu.: 10.50   3rd Qu.: 610.0  \n Max.   :1752.0      Max.   :624.00    Max.   :104.00   Max.   :1966.0  \n 2023 Cultivation farm 2023 Livestock farm 2023 Fishing farm 2023 Others(*)  \n Min.   :  0.0         Min.   :   0.0      Min.   :  0.00    Min.   :  0.00  \n 1st Qu.:  2.5         1st Qu.:  28.0      1st Qu.:  0.00    1st Qu.:  0.00  \n Median : 20.0         Median :  97.0      Median :  9.00    Median :  4.00  \n Mean   :113.1         Mean   : 222.8      Mean   : 47.06    Mean   : 12.86  \n 3rd Qu.:110.0         3rd Qu.: 262.5      3rd Qu.: 56.00    3rd Qu.: 10.50  \n Max.   :922.0         Max.   :1751.0      Max.   :677.00    Max.   :114.00  \n```\n\n\n:::\n:::\n\n\n\nThis code calculates and prints summary statistics for columns associated with the years 2012 through 2023. This gives a quick, aggregated view of each year’s data, providing insight into distributions and highlighting potential outliers or trends over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms <- farms %>%\n  mutate(`2012 Cultivation PR` = `2012 Cultivation farm` / `2012 Total` * 1000,\n         `2012 Livestock PR` = `2012 Livestock farm` / `2012 Total` * 1000,\n         `2012 Fishing PR` = `2012 Fishing farm` / `2012 Total` * 1000,\n         `2012 Others PR` = `2012 Others(*)` / `2012 Total` * 1000) %>%\n  mutate(`2013 Cultivation PR` = `2013 Cultivation farm` / `2013 Total` * 1000,\n         `2013 Livestock PR` = `2013 Livestock farm` / `2013 Total` * 1000,\n         `2013 Fishing PR` = `2013 Fishing farm` / `2013 Total` * 1000,\n         `2013 Others PR` = `2013 Others(*)` / `2013 Total` * 1000) %>%\n  mutate(`2014 Cultivation PR` = `2014 Cultivation farm` / `2014 Total` * 1000,\n         `2014 Livestock PR` = `2014 Livestock farm` / `2014 Total` * 1000,\n         `2014 Fishing PR` = `2014 Fishing farm` / `2014 Total` * 1000,\n         `2014 Others PR` = `2014 Others(*)` / `2014 Total` * 1000) %>%\n  mutate(`2015 Cultivation PR` = `2015 Cultivation farm` / `2015 Total` * 1000,\n         `2015 Livestock PR` = `2015 Livestock farm` / `2015 Total` * 1000,\n         `2015 Fishing PR` = `2015 Fishing farm` / `2015 Total` * 1000,\n         `2015 Others PR` = `2015 Others(*)` / `2015 Total` * 1000) %>%\n  mutate(`2016 Cultivation PR` = `2016 Cultivation farm` / `2016 Total` * 1000,\n         `2016 Livestock PR` = `2016 Livestock farm` / `2016 Total` * 1000,\n         `2016 Fishing PR` = `2016 Fishing farm` / `2016 Total` * 1000,\n         `2016 Others PR` = `2016 Others(*)` / `2016 Total` * 1000) %>%\n  mutate(`2017 Cultivation PR` = `2017 Cultivation farm` / `2017 Total` * 1000,\n         `2017 Livestock PR` = `2017 Livestock farm` / `2017 Total` * 1000,\n         `2017 Fishing PR` = `2017 Fishing farm` / `2017 Total` * 1000,\n         `2017 Others PR` = `2017 Others(*)` / `2017 Total` * 1000) %>%\n  mutate(`2018 Cultivation PR` = `2018 Cultivation farm` / `2018 Total` * 1000,\n         `2018 Livestock PR` = `2018 Livestock farm` / `2018 Total` * 1000,\n         `2018 Fishing PR` = `2018 Fishing farm` / `2018 Total` * 1000,\n         `2018 Others PR` = `2018 Others(*)` / `2018 Total` * 1000) %>%\n  mutate(`2019 Cultivation PR` = `2019 Cultivation farm` / `2019 Total` * 1000,\n         `2019 Livestock PR` = `2019 Livestock farm` / `2019 Total` * 1000,\n         `2019 Fishing PR` = `2019 Fishing farm` / `2019 Total` * 1000,\n         `2019 Others PR` = `2019 Others(*)` / `2019 Total` * 1000) %>%\n  mutate(`2020 Cultivation PR` = `2020 Cultivation farm` / `2020 Total` * 1000,\n         `2020 Livestock PR` = `2020 Livestock farm` / `2020 Total` * 1000,\n         `2020 Fishing PR` = `2020 Fishing farm` / `2020 Total` * 1000,\n         `2020 Others PR` = `2020 Others(*)` / `2020 Total` * 1000) %>%\n  mutate(`2021 Cultivation PR` = `2021 Cultivation farm` / `2021 Total` * 1000,\n         `2021 Livestock PR` = `2021 Livestock farm` / `2021 Total` * 1000,\n         `2021 Fishing PR` = `2021 Fishing farm` / `2021 Total` * 1000,\n         `2021 Others PR` = `2021 Others(*)` / `2021 Total` * 1000) %>%\n  mutate(`2022 Cultivation PR` = `2022 Cultivation farm` / `2022 Total` * 1000,\n         `2022 Livestock PR` = `2022 Livestock farm` / `2022 Total` * 1000,\n         `2022 Fishing PR` = `2022 Fishing farm` / `2022 Total` * 1000,\n         `2022 Others PR` = `2022 Others(*)` / `2022 Total` * 1000) %>%\n  mutate(`2023 Cultivation PR` = `2023 Cultivation farm` / `2023 Total` * 1000,\n         `2023 Livestock PR` = `2023 Livestock farm` / `2023 Total` * 1000,\n         `2023 Fishing PR` = `2023 Fishing farm` / `2023 Total` * 1000,\n         `2023 Others PR` = `2023 Others(*)` / `2023 Total` * 1000)\n```\n:::\n\n\n\nIn this part, proportion ratios for various farm types (Cultivation, Livestock, Fishing, and Others) are calculated for each year, relative to the total farms. Scaling each type per 1,000 total farms allows us to compare regions with different total farm sizes on an equal footing, making it possible to see the proportionate focus of each province’s farming sector over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenterprise <- enterprise %>%\n  mutate(`Cities, provincies` = str_trim(`Cities, provincies`)) %>%\n  filter(!`Cities, provincies` %in% c(\n    \"Red River Delta\", \"Northern midlands and mountain areas\", \n    \"Northern Central area and Central coastal area\", \"Central Highlands\", \n    \"South East\", \"Mekong River Delta\"\n  )) %>%\n  mutate(`Cities, provincies` = case_when(\n    `Cities, provincies` == \"Ho Chi Minh city\" ~ \"TP. Ho Chi Minh\",\n    `Cities, provincies` == \"Thai  Nguyen\" ~ \"Thai Nguyen\",\n    `Cities, provincies` == \"Thua Thien-Hue\" ~ \"Thua Thien - Hue\",\n    `Cities, provincies` == \"Quang  Nam\" ~ \"Quang Nam\",\n    `Cities, provincies` == \"Quang  Ngai\" ~ \"Quang Ngai\",\n    `Cities, provincies` == \"Khanh  Hoa\" ~ \"Khanh Hoa\",\n    `Cities, provincies` == \"Ninh  Thuan\" ~ \"Ninh Thuan\",\n    `Cities, provincies` == \"Binh  Duong\" ~ \"Binh Duong\",\n    `Cities, provincies` == \"Kien  Giang\" ~ \"Kien Giang\",\n    TRUE ~ `Cities, provincies`\n  )) %>%\n  mutate(across(-`Cities, provincies`, ~str_replace_all(., \"\\\\.\\\\.\", \"0\"))) %>%\n  mutate(across(-`Cities, provincies`, ~suppressWarnings(as.numeric(.))))\n\nprint(enterprise)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 63 × 9\n   `Cities, provincies` `2016` `2017` `2018` `2019` `2020` `2021` `2022` `2023`\n   <chr>                 <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n 1 Ha Noi                22663  24545  25231  27711  26135  24026  29720  31512\n 2 Vinh Phuc               857   1250   1145   1194   1249   1214   1377   1523\n 3 Bac Ninh               1660   2046   2041   2405   2390   2368   2700   3473\n 4 Quang Ninh             1254   1593   1654   1605   1456   1455   1643   1689\n 5 Hai Duong              1213   1509   1549   1695   1600   1425   1579   1884\n 6 Hai Phong              2568   2979   3145   2943   2867   3034   3294   3523\n 7 Hung Yen                903   1311   1185   1194   1153   1331   1364   1594\n 8 Thai Binh               631    776    825    890    714    847   1130   1245\n 9 Ha Nam                  481    628    596    684    682    666    796    771\n10 Nam Dinh                675    799    818    796    794    906   1088   1283\n# ℹ 53 more rows\n```\n\n\n:::\n:::\n\n\n\nThis segment cleans and standardizes province names in `enterprise`, trimming whitespace and correcting inconsistent naming conventions (e.g., replacing \"Ho Chi Minh city\" with \"TP. Ho Chi Minh\"). It also removes rows that represent regions rather than specific provinces, ensuring a focus on individual provincial data. Missing values, represented as \"..\", are replaced with 0 to enable smooth calculations, and all non-province columns are converted to numeric format to prevent errors in numeric operations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(enterprise, \"data/rds/enterprise.rds\")\n```\n:::\n\n\n\n## **Exploratory Data Analysis (EDA)**\n\nWhen designing the Shiny UI, I plan to include the variable \"type of farm,\" allowing users to explore the agricultural data across different years and farm types interactively.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplots_list <- list()\n\nfor (year in 2012:2023) {\n  p <- ggplot(farms, aes_string(x = paste0(\"`\", year, \" Cultivation farm`\"))) +\n    geom_histogram(fill = \"skyblue\", color = \"black\") +\n    ggtitle(paste(year)) +\n    theme_minimal()\n  \n  plots_list[[as.character(year)]] <- p\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n```\n\n\n:::\n\n```{.r .cell-code}\narranged_plot <- ggarrange(\n  plots_list[[\"2012\"]], plots_list[[\"2013\"]], plots_list[[\"2014\"]],\n  plots_list[[\"2015\"]], plots_list[[\"2016\"]], plots_list[[\"2017\"]],\n  plots_list[[\"2018\"]], plots_list[[\"2019\"]], plots_list[[\"2020\"]],\n  plots_list[[\"2021\"]], plots_list[[\"2022\"]], plots_list[[\"2023\"]],\n  ncol = 4, nrow = 3\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(arranged_plot)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\nThis code generates yearly histograms of \"Cultivation farms\" from 2012 to 2023, arranged in a grid layout. In the Shiny design, I will present these histograms, allowing users to explore the distribution of cultivation farms each year. Users will be able to select different years and compare the frequency distribution of cultivation farm counts over time.\n\n![](images/clipboard-926565402.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplots_list <- list()\n\nfor (year in 2016:2023) {\n  p <- ggplot(enterprise, aes_string(x = paste0(\"`\", year, \"`\"))) +\n    geom_histogram(fill = \"skyblue\", color = \"black\") +\n    ggtitle(paste(year)) +\n    theme_minimal()\n  \n  plots_list[[as.character(year)]] <- p\n}\n\narranged_plot <- ggarrange(\n  plots_list[[\"2016\"]], plots_list[[\"2017\"]],\n  plots_list[[\"2018\"]], plots_list[[\"2019\"]], plots_list[[\"2020\"]],\n  plots_list[[\"2021\"]], plots_list[[\"2022\"]], plots_list[[\"2023\"]],\n  ncol = 4, nrow = 2\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n```{.r .cell-code}\nfinal_plot <- annotate_figure(\n  arranged_plot,\n  top = text_grob(\"Number of Newly Established Enterprises (2016-2023)\", \n                  face = \"bold\", size = 14)\n)\n\nprint(final_plot)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\nThis code generates histograms for each year from 2016 to 2023, showing the distribution of newly established enterprises. It first iterates through each year, creating a histogram with `ggplot` and saving it in `plots_list`. Each plot represents a single year’s distribution, with a consistent color scheme and minimalist styling.\n\nThis enterprise data is displayed alongside the farm histogram to allow comparison between farm and enterprise development over the years, suggesting other avenues of growth. In Shiny, I’ll add enterprise as a selection option, enabling users to toggle between enterprise and farm data and explore shifts in development focus across time. This approach helps users visually assess potential transitions from agriculture to enterprise-based growth in each province.\n\n![](images/clipboard-390042237.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms %>%\n  select(`2012 Cultivation farm`, `2013 Cultivation farm`, `2014 Cultivation farm`, \n         `2015 Cultivation farm`, `2016 Cultivation farm`, `2017 Cultivation farm`, \n         `2018 Cultivation farm`, `2019 Cultivation farm`, `2020 Cultivation farm`, \n         `2021 Cultivation farm`, `2022 Cultivation farm`, `2023 Cultivation farm`) %>%\n  pivot_longer(cols = everything(), names_to = \"Year\", values_to = \"Cultivation_Farms\") %>%\n  mutate(Year = gsub(\" Cultivation farm\", \"\", Year)) %>%  \n  ggplot(aes(x = Year, y = Cultivation_Farms)) +\n  geom_boxplot(fill = \"orange\") +\n  ggtitle(\"Boxplot of Cultivation Farms (2012-2023)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  \n  xlab(\"Year\") + \n  ylab(\"Cultivation Farms\") %>% \n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$y\n[1] \"Cultivation Farms\"\n\nattr(,\"class\")\n[1] \"labels\"\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\nI’ll display this boxplot on the Shiny UI, with the variable \"Year\" on the x-axis and \"Cultivation Farms\" on the y-axis. This visualization allows users to explore the distribution of cultivation farms over time, observing any changes in median values, variability, and outliers. Users can get insights into how cultivation has varied from year to year.\n\n![](images/clipboard-926565402.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenterprise %>%\n  pivot_longer(cols = `2016`:`2023`, names_to = \"Year\", values_to = \"Value\") %>%\n  ggplot(aes(x = Year, y = Value)) +\n  geom_boxplot(fill = \"orange\") +\n  ggtitle(\"Number of Newly Established Enterprises (2016-2023)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  xlab(\"Year\") +\n  ylab(\"Number of Enterprises\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nPositioning this enterprise boxplot alongside the farm boxplot in the Shiny app allows users to explore shifts in growth focus, comparing farm versus enterprise development over time. By including enterprise as a selectable option in the Shiny UI, users can toggle between the two datasets to observe and analyze trends, discovering insights into how regional development may be evolving from agriculture to business establishment in recent years.\n\n![](images/clipboard-390042237.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplots_list <- list()\n\nfor (year in 2012:2023) {\n  p <- ggplot(farms, aes_string(x = paste0(\"`\", year, \" Cultivation PR`\"))) +\n    geom_histogram(fill = \"skyblue\", color = \"black\") +\n    ggtitle(paste(year)) +\n    theme_minimal()\n  \n  plots_list[[as.character(year)]] <- p\n}\n\narranged_plot <- ggarrange(\n  plots_list[[\"2012\"]], plots_list[[\"2013\"]], plots_list[[\"2014\"]],\n  plots_list[[\"2015\"]], plots_list[[\"2016\"]], plots_list[[\"2017\"]],\n  plots_list[[\"2018\"]], plots_list[[\"2019\"]], plots_list[[\"2020\"]],\n  plots_list[[\"2021\"]], plots_list[[\"2022\"]], plots_list[[\"2023\"]],\n  ncol = 4, nrow = 3\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(arranged_plot)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\nIn Shiny, I’ll present these histograms of \"Cultivation PR\" (proportion per 1,000 farms) for each year from 2012 to 2023, enabling users to explore the cultivation farm proportion. By examining these histograms, users can see how the cultivation intensity varied year by year, which can highlight shifts in focus or growth in farming activity.\n\n![](images/clipboard-926565402.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(farms %>% select(contains(\"Cultivation PR\")), function(x) sum(is.na(x)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2012 Cultivation PR 2013 Cultivation PR 2014 Cultivation PR 2015 Cultivation PR \n                  2                   2                   0                   0 \n2016 Cultivation PR 2017 Cultivation PR 2018 Cultivation PR 2019 Cultivation PR \n                  0                   0                   0                   0 \n2020 Cultivation PR 2021 Cultivation PR 2022 Cultivation PR 2023 Cultivation PR \n                  2                   2                   2                   2 \n```\n\n\n:::\n:::\n\n\n\nThis command checks for missing values in the \"Cultivation PR\" columns, ensuring data quality before display in Shiny.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms <- farms %>%\n  mutate(across(where(is.numeric), ~replace_na(., 0)))\n```\n:::\n\n\n\nHere, I replace any remaining missing values with `0` to ensure complete and consistent data visualization within Shiny, preventing display issues with NA values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfarms %>%\n  select(`2012 Cultivation PR`, `2013 Cultivation PR`, `2014 Cultivation PR`, \n         `2015 Cultivation PR`, `2016 Cultivation PR`, `2017 Cultivation PR`, \n         `2018 Cultivation PR`, `2019 Cultivation PR`, `2020 Cultivation PR`, \n         `2021 Cultivation PR`, `2022 Cultivation PR`, `2023 Cultivation PR`) %>%\n  pivot_longer(cols = everything(), names_to = \"Year\", values_to = \"Cultivation_PR\") %>%\n  mutate(Year = gsub(\" Cultivation PR\", \"\", Year)) %>%\n  ggplot(aes(x = Year, y = Cultivation_PR)) +\n  geom_boxplot(fill = \"orange\") +\n  ggtitle(\"Boxplot of Cultivation PR (2012-2023)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + \n  xlab(\"Year\") +  \n  ylab(\"Cultivation PR (per 1000)\") %>% \n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$y\n[1] \"Cultivation PR (per 1000)\"\n\nattr(,\"class\")\n[1] \"labels\"\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\nThis boxplot for \"Cultivation PR\" will also be displayed in the Shiny app, allowing users to explore how the proportion of cultivation farms has changed over the years. With variables \"Year\" and \"Cultivation PR,\" users can observe fluctuations in farming intensity, identifying years with high or low cultivation proportions.\n\n![](images/clipboard-926565402.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm <- farms %>%\n  left_join(vietnam_geo %>% select(-Code), by = c(\"Cities, provincies\" = \"Name\"))\n\nprint(vietnam_farm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 63 × 110\n   `Cities, provincies` `2012 Total` `2012 Cultivation farm`\n   <chr>                       <dbl>                   <dbl>\n 1 Ha Noi                       1233                      11\n 2 Vinh Phuc                     508                       0\n 3 Bac Ninh                       74                       0\n 4 Quang Ninh                    141                       4\n 5 Hai Duong                     506                       3\n 6 Hai Phong                     421                       1\n 7 Hung Yen                      353                       4\n 8 Thai Binh                     600                       4\n 9 Ha Nam                        240                       6\n10 Nam Dinh                      366                       2\n# ℹ 53 more rows\n# ℹ 107 more variables: `2012 Livestock farm` <dbl>, `2012 Fishing farm` <dbl>,\n#   `2012 Others(*)` <dbl>, `2013 Total` <dbl>, `2013 Cultivation farm` <dbl>,\n#   `2013 Livestock farm` <dbl>, `2013 Fishing farm` <dbl>,\n#   `2013 Others(*)` <dbl>, `2014 Total` <dbl>, `2014 Cultivation farm` <dbl>,\n#   `2014 Livestock farm` <dbl>, `2014 Fishing farm` <dbl>,\n#   `2014 Others(*)` <dbl>, `2015 Total` <dbl>, …\n```\n\n\n:::\n:::\n\n\n\nBy joining `farms` with `vietnam_geo` on matching province names, I create `vietnam_farm`, a comprehensive dataset combining both geographic and farm data. This joined dataset will be essential for displaying farm data across provinces on the Shiny map.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(vietnam_farm, \"data/rds/vietnam_farm.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_enterprise <- enterprise %>%\n  left_join(vietnam_geo %>% select(-Code), by = c(\"Cities, provincies\" = \"Name\"))\n\nprint(vietnam_enterprise)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 63 × 10\n   `Cities, provincies` `2016` `2017` `2018` `2019` `2020` `2021` `2022` `2023`\n   <chr>                 <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n 1 Ha Noi                22663  24545  25231  27711  26135  24026  29720  31512\n 2 Vinh Phuc               857   1250   1145   1194   1249   1214   1377   1523\n 3 Bac Ninh               1660   2046   2041   2405   2390   2368   2700   3473\n 4 Quang Ninh             1254   1593   1654   1605   1456   1455   1643   1689\n 5 Hai Duong              1213   1509   1549   1695   1600   1425   1579   1884\n 6 Hai Phong              2568   2979   3145   2943   2867   3034   3294   3523\n 7 Hung Yen                903   1311   1185   1194   1153   1331   1364   1594\n 8 Thai Binh               631    776    825    890    714    847   1130   1245\n 9 Ha Nam                  481    628    596    684    682    666    796    771\n10 Nam Dinh                675    799    818    796    794    906   1088   1283\n# ℹ 53 more rows\n# ℹ 1 more variable: geometry <MULTIPOLYGON [°]>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm <- st_as_sf(vietnam_farm)\n\nqtm(vietnam_farm, \"2012 Cultivation PR\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\nThis code converts `vietnam_farm` into an `sf` spatial data frame and plots \"2012 Cultivation PR\" using `qtm`. In Shiny, this map will allow users to visually explore the cultivation farm proportion across different provinces, giving a clear geographic representation of farming intensity.\n\n![](images/clipboard-111619408.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(vietnam_farm) +\n  tm_polygons(c(\"2012 Total\", \"2012 Cultivation farm\"),\n              style = \"jenks\", \n              title = c(\"Total Farms in 2012\", \"Cultivation Farms in 2012\")) +\n  tm_facets(sync = TRUE, ncol = 2) +  \n  tm_legend(legend.position = c(\"right\", \"bottom\")) + \n  tm_layout(outer.margins = 0, asp = 0) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\nThis faceted map displays both \"Total Farms\" and \"Cultivation Farms\" for 2012, using `tm_facets` to create a synchronized side-by-side view. I’ll present these maps in Shiny to allow users to visually compare the distribution of total versus cultivation farms across provinces. This visualization, along with the option to explore variables by year, will provide a comprehensive geographic overview in the Shiny app.\n\n![](images/clipboard-1034109930.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_enterprise <- st_as_sf(vietnam_enterprise)\n\ntm_shape(vietnam_enterprise) +\n  tm_polygons(c(\"2016\", \"2017\"),\n              style = \"jenks\", \n              title = c(\"New Enterprises (2016)\", \"New Enterprises (2017)\")) +\n  tm_facets(sync = TRUE, ncol = 2) +  \n  tm_legend(legend.position = c(\"right\", \"bottom\")) + \n  tm_layout(outer.margins = 0, asp = 0)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\nIn Shiny, I’ll allow users to select different years to compare dynamically on a geographic map. Placed alongside farm distribution maps, these enterprise maps offer insights into potential regional shifts from agriculture to business growth. This setup lets users explore spatial differences year-to-year, revealing trends in economic development and regional focus over time.\n\n![](images/clipboard-2649044800.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenterprise_long <- enterprise %>%\n  pivot_longer(cols = `2016`:`2023`, names_to = \"Year\", values_to = \"Enterprise_Count\")\n\nenterprise_long <- enterprise_long %>%\n  mutate(Year = as.numeric(Year))\n\nggplot(data = enterprise_long, aes(x = Year, y = Enterprise_Count, color = `Cities, provincies`, group = `Cities, provincies`)) +\n  geom_line() +\n  geom_point() +\n  ggtitle(\"Trend of Enterprises Over the Years (2016-2023)\") +\n  xlab(\"Year\") +\n  ylab(\"Enterprise Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\nIn the Shiny app, users will be able to select specific provinces to view enterprise trends over time, allowing them to focus on a particular province's growth trajectory. By enabling this selection, users can explore how enterprise development has varied among provinces, revealing insights into regional economic changes. This interactive feature will enhance user engagement and allow for targeted analysis of provincial trends.\n\n![](images/clipboard-2568801538.png)\n\n## **Correlation Analysis**\n\nWhen I design the Shiny UI, I will include the variable \"year\" to allow users to analyze and interact with correlation patterns over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfarm_2012_pr_data <- vietnam_farm %>%\n  st_drop_geometry() %>%  \n  select(`2012 Cultivation PR`, `2012 Livestock PR`, `2012 Fishing PR`, `2012 Others PR`) %>%\n  mutate(across(everything(), as.numeric))  \n\ncolnames(farm_2012_pr_data) <- gsub(\"2012 \", \"\", colnames(farm_2012_pr_data))  \n\ncluster_vars_cor_pr <- cor(farm_2012_pr_data, use = \"complete.obs\")\n\ncorrplot.mixed(cluster_vars_cor_pr,\n               lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\nThis code calculates the correlation matrix for various farm types' proportions (Cultivation, Livestock, Fishing, Others) in 2012, removing geometry to focus on numeric data. Column names are cleaned to simplify variable names, and the `corrplot.mixed` function displays both numeric correlation values and ellipses, helping users easily interpret relationships between farm types. In Shiny, I’ll present this correlation plot to allow users to explore how different farming types relate to one another within a selected year.\n\n![](images/clipboard-810687904.png)\n\n### **Data Standardisation**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_ict <- vietnam_farm %>%\n  st_drop_geometry() %>%  \n  select_if(is.numeric)  \n```\n:::\n\n\n\nTo prepare for standardization, this code removes geometry and retains only numeric data from `vietnam_farm`, creating `vietnam_farm_ict`. This selection forms the base data for applying both Min-Max and Z-score standardizations, which helps in visualizing different scaling methods and their impact on distribution.\n\n### **Min-Max standardisation**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm.std <- normalize(vietnam_farm_ict)\n\nsummary(vietnam_farm.std)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   2012 Total       2012 Cultivation farm 2012 Livestock farm\n Min.   :0.000000   Min.   :0.0000000     Min.   :0.000000   \n 1st Qu.:0.009195   1st Qu.:0.0007813     1st Qu.:0.007679   \n Median :0.039287   Median :0.0046875     Median :0.032423   \n Mean   :0.100196   Mean   :0.1098834     Mean   :0.110149   \n 3rd Qu.:0.141265   3rd Qu.:0.0910156     3rd Qu.:0.143771   \n Max.   :1.000000   Max.   :1.0000000     Max.   :1.000000   \n 2012 Fishing farm  2012 Others(*)      2013 Total      2013 Cultivation farm\n Min.   :0.000000   Min.   :0.00000   Min.   :0.00000   Min.   :0.0000000    \n 1st Qu.:0.000000   1st Qu.:0.00000   1st Qu.:0.01075   1st Qu.:0.0004177    \n Median :0.003717   Median :0.01005   Median :0.05995   Median :0.0041771    \n Mean   :0.025320   Mean   :0.07506   Mean   :0.10672   Mean   :0.1159645    \n 3rd Qu.:0.010646   3rd Qu.:0.04020   3rd Qu.:0.15441   3rd Qu.:0.0948204    \n Max.   :1.000000   Max.   :1.00000   Max.   :1.00000   Max.   :1.0000000    \n 2013 Livestock farm 2013 Fishing farm  2013 Others(*)      2014 Total     \n Min.   :0.00000     Min.   :0.000000   Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.01053     1st Qu.:0.000000   1st Qu.:0.00000   1st Qu.:0.01567  \n Median :0.03386     Median :0.003085   Median :0.01538   Median :0.08194  \n Mean   :0.10995     Mean   :0.025521   Mean   :0.09223   Mean   :0.12346  \n 3rd Qu.:0.14597     3rd Qu.:0.011313   3rd Qu.:0.07692   3rd Qu.:0.17424  \n Max.   :1.00000     Max.   :1.000000   Max.   :1.00000   Max.   :1.00000  \n 2014 Cultivation farm 2014 Livestock farm 2014 Fishing farm \n Min.   :0.0000000     Min.   :0.000000    Min.   :0.000000  \n 1st Qu.:0.0005181     1st Qu.:0.008575    1st Qu.:0.000000  \n Median :0.0082902     Median :0.034302    Median :0.002391  \n Mean   :0.1469693     Mean   :0.095601    Mean   :0.025184  \n 3rd Qu.:0.1487047     3rd Qu.:0.128633    3rd Qu.:0.012470  \n Max.   :1.0000000     Max.   :1.000000    Max.   :1.000000  \n 2014 Others(*)       2015 Total      2015 Cultivation farm 2015 Livestock farm\n Min.   :0.000000   Min.   :0.00000   Min.   :0.0000000     Min.   :0.000000   \n 1st Qu.:0.005181   1st Qu.:0.02145   1st Qu.:0.0005051     1st Qu.:0.009313   \n Median :0.015544   Median :0.09725   Median :0.0090909     Median :0.030656   \n Mean   :0.073443   Mean   :0.15242   Mean   :0.1471541     Mean   :0.092423   \n 3rd Qu.:0.075130   3rd Qu.:0.21775   3rd Qu.:0.1383838     3rd Qu.:0.126892   \n Max.   :1.000000   Max.   :1.00000   Max.   :1.0000000     Max.   :1.000000   \n 2015 Fishing farm 2015 Others(*)       2016 Total      2016 Cultivation farm\n Min.   :0.00000   Min.   :0.000000   Min.   :0.00000   Min.   :0.0000000    \n 1st Qu.:0.00000   1st Qu.:0.004878   1st Qu.:0.02598   1st Qu.:0.0008772    \n Median :0.00290   Median :0.014634   Median :0.08346   Median :0.0114035    \n Mean   :0.02745   Mean   :0.074952   Mean   :0.13925   Mean   :0.1283208    \n 3rd Qu.:0.01222   3rd Qu.:0.068293   3rd Qu.:0.22717   3rd Qu.:0.1087719    \n Max.   :1.00000   Max.   :1.000000   Max.   :1.00000   Max.   :1.0000000    \n 2016 Livestock farm 2016 Fishing farm  2016 Others(*)       2017 Total     \n Min.   :0.00000     Min.   :0.000000   Min.   :0.000000   Min.   :0.00000  \n 1st Qu.:0.01183     1st Qu.:0.002976   1st Qu.:0.002336   1st Qu.:0.02794  \n Median :0.03371     Median :0.026786   Median :0.009346   Median :0.08880  \n Mean   :0.09765     Mean   :0.111017   Mean   :0.039052   Mean   :0.14088  \n 3rd Qu.:0.11872     3rd Qu.:0.095238   3rd Qu.:0.024533   3rd Qu.:0.22330  \n Max.   :1.00000     Max.   :1.000000   Max.   :1.000000   Max.   :1.00000  \n 2017 Cultivation farm 2017 Livestock farm 2017 Fishing farm \n Min.   :0.000000      Min.   :0.00000     Min.   :0.000000  \n 1st Qu.:0.000885      1st Qu.:0.01290     1st Qu.:0.002976  \n Median :0.009735      Median :0.03351     Median :0.032738  \n Mean   :0.127813      Mean   :0.09930     Mean   :0.124102  \n 3rd Qu.:0.112832      3rd Qu.:0.13523     3rd Qu.:0.095238  \n Max.   :1.000000      Max.   :1.00000     Max.   :1.000000  \n 2017 Others(*)       2018 Total      2018 Cultivation farm 2018 Livestock farm\n Min.   :0.000000   Min.   :0.00000   Min.   :0.0000000     Min.   :0.00000    \n 1st Qu.:0.000000   1st Qu.:0.03129   1st Qu.:0.0009141     1st Qu.:0.01451    \n Median :0.006637   Median :0.10828   Median :0.0091408     Median :0.04389    \n Mean   :0.040877   Mean   :0.15389   Mean   :0.1233133     Mean   :0.10999    \n 3rd Qu.:0.028761   3rd Qu.:0.23267   3rd Qu.:0.1151737     3rd Qu.:0.15062    \n Max.   :1.000000   Max.   :1.00000   Max.   :1.0000000     Max.   :1.00000    \n 2018 Fishing farm  2018 Others(*)       2019 Total      2019 Cultivation farm\n Min.   :0.000000   Min.   :0.000000   Min.   :0.00000   Min.   :0.0000000    \n 1st Qu.:0.002882   1st Qu.:0.000000   1st Qu.:0.02834   1st Qu.:0.0009107    \n Median :0.023055   Median :0.009217   Median :0.11659   Median :0.0100182    \n Mean   :0.106674   Mean   :0.043815   Mean   :0.15080   Mean   :0.1217220    \n 3rd Qu.:0.093660   3rd Qu.:0.024193   3rd Qu.:0.22403   3rd Qu.:0.1165756    \n Max.   :1.000000   Max.   :1.000000   Max.   :1.00000   Max.   :1.0000000    \n 2019 Livestock farm 2019 Fishing farm  2019 Others(*)       2020 Total     \n Min.   :0.00000     Min.   :0.000000   Min.   :0.000000   Min.   :0.00000  \n 1st Qu.:0.01439     1st Qu.:0.002882   1st Qu.:0.000000   1st Qu.:0.03639  \n Median :0.04604     Median :0.023055   Median :0.009217   Median :0.10980  \n Mean   :0.10880     Mean   :0.106491   Mean   :0.045900   Mean   :0.15801  \n 3rd Qu.:0.14878     3rd Qu.:0.096542   3rd Qu.:0.023041   3rd Qu.:0.22549  \n Max.   :1.00000     Max.   :1.000000   Max.   :1.000000   Max.   :1.00000  \n 2020 Cultivation farm 2020 Livestock farm 2020 Fishing farm 2020 Others(*)   \n Min.   :0.000000      Min.   :0.00000     Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.003322      1st Qu.:0.01350     1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.021041      Median :0.05227     Median :0.01679   Median :0.02247  \n Mean   :0.116103      Mean   :0.12538     Mean   :0.08025   Mean   :0.10612  \n 3rd Qu.:0.124585      3rd Qu.:0.13125     3rd Qu.:0.06996   3rd Qu.:0.11236  \n Max.   :1.000000      Max.   :1.00000     Max.   :1.00000   Max.   :1.00000  \n   2021 Total      2021 Cultivation farm 2021 Livestock farm\n Min.   :0.00000   Min.   :0.000000      Min.   :0.00000    \n 1st Qu.:0.04167   1st Qu.:0.003344      1st Qu.:0.01782    \n Median :0.11759   Median :0.022297      Median :0.05805    \n Mean   :0.17468   Mean   :0.115270      Mean   :0.12542    \n 3rd Qu.:0.24769   3rd Qu.:0.128205      3rd Qu.:0.13621    \n Max.   :1.00000   Max.   :1.000000      Max.   :1.00000    \n 2021 Fishing farm   2021 Others(*)      2022 Total      2022 Cultivation farm\n Min.   :0.0000000   Min.   :0.00000   Min.   :0.00000   Min.   :0.000000     \n 1st Qu.:0.0008224   1st Qu.:0.00000   1st Qu.:0.04577   1st Qu.:0.003363     \n Median :0.0164474   Median :0.01942   Median :0.13484   Median :0.024664     \n Mean   :0.0734388   Mean   :0.10726   Mean   :0.18806   Mean   :0.112232     \n 3rd Qu.:0.0649671   3rd Qu.:0.08738   3rd Qu.:0.26698   3rd Qu.:0.128924     \n Max.   :1.0000000   Max.   :1.00000   Max.   :1.00000   Max.   :1.000000     \n 2022 Livestock farm 2022 Fishing farm   2022 Others(*)      2023 Total     \n Min.   :0.00000     Min.   :0.0000000   Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.01655     1st Qu.:0.0008013   1st Qu.:0.00000   1st Qu.:0.04781  \n Median :0.05936     Median :0.0144231   Median :0.01923   Median :0.14446  \n Mean   :0.12760     Mean   :0.0747863   Mean   :0.11355   Mean   :0.20134  \n 3rd Qu.:0.13955     3rd Qu.:0.0817308   3rd Qu.:0.10096   3rd Qu.:0.31027  \n Max.   :1.00000     Max.   :1.0000000   Max.   :1.00000   Max.   :1.00000  \n 2023 Cultivation farm 2023 Livestock farm 2023 Fishing farm 2023 Others(*)   \n Min.   :0.000000      Min.   :0.00000     Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.002711      1st Qu.:0.01599     1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.021692      Median :0.05540     Median :0.01329   Median :0.03509  \n Mean   :0.122646      Mean   :0.12727     Mean   :0.06952   Mean   :0.11278  \n 3rd Qu.:0.119306      3rd Qu.:0.14991     3rd Qu.:0.08272   3rd Qu.:0.09211  \n Max.   :1.000000      Max.   :1.00000     Max.   :1.00000   Max.   :1.00000  \n 2012 Cultivation PR 2012 Livestock PR 2012 Fishing PR   2012 Others PR   \n Min.   :0.000000    Min.   :0.0000    Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.003592    1st Qu.:0.1262    1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.058139    Median :0.4783    Median :0.04912   Median :0.03667  \n Mean   :0.276857    Mean   :0.4694    Mean   :0.15451   Mean   :0.16009  \n 3rd Qu.:0.539111    3rd Qu.:0.7819    3rd Qu.:0.16923   3rd Qu.:0.16954  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.00000   Max.   :1.00000  \n 2013 Cultivation PR 2013 Livestock PR 2013 Fishing PR   2013 Others PR   \n Min.   :0.0000000   Min.   :0.0000    Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.0007692   1st Qu.:0.1637    1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.0437956   Median :0.4576    Median :0.05271   Median :0.02632  \n Mean   :0.2720218   Mean   :0.4843    Mean   :0.13529   Mean   :0.15630  \n 3rd Qu.:0.5211864   3rd Qu.:0.8117    3rd Qu.:0.14261   3rd Qu.:0.22118  \n Max.   :1.0000000   Max.   :1.0000    Max.   :1.00000   Max.   :1.00000  \n 2014 Cultivation PR 2014 Livestock PR 2014 Fishing PR   2014 Others PR    \n Min.   :0.000000    Min.   :0.0000    Min.   :0.00000   Min.   :0.000000  \n 1st Qu.:0.001281    1st Qu.:0.2084    1st Qu.:0.00000   1st Qu.:0.003282  \n Median :0.063622    Median :0.5771    Median :0.04351   Median :0.038228  \n Mean   :0.282096    Mean   :0.5405    Mean   :0.13291   Mean   :0.144265  \n 3rd Qu.:0.547042    3rd Qu.:0.8709    3rd Qu.:0.11597   3rd Qu.:0.187017  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.00000   Max.   :1.000000  \n 2015 Cultivation PR 2015 Livestock PR 2015 Fishing PR   2015 Others PR    \n Min.   :0.000000    Min.   :0.0000    Min.   :0.00000   Min.   :0.000000  \n 1st Qu.:0.001255    1st Qu.:0.2749    1st Qu.:0.00000   1st Qu.:0.005116  \n Median :0.065970    Median :0.6338    Median :0.03843   Median :0.055556  \n Mean   :0.272500    Mean   :0.5600    Mean   :0.12213   Mean   :0.187827  \n 3rd Qu.:0.481251    3rd Qu.:0.8722    3rd Qu.:0.09858   3rd Qu.:0.261364  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.00000   Max.   :1.000000  \n 2016 Cultivation PR 2016 Livestock PR 2016 Fishing PR    2016 Others PR    \n Min.   :0.000000    Min.   :0.0000    Min.   :0.000000   Min.   :0.000000  \n 1st Qu.:0.005843    1st Qu.:0.2901    1st Qu.:0.004281   1st Qu.:0.002937  \n Median :0.068469    Median :0.7162    Median :0.032834   Median :0.021423  \n Mean   :0.249853    Mean   :0.6012    Mean   :0.110272   Mean   :0.071175  \n 3rd Qu.:0.463326    3rd Qu.:0.8927    3rd Qu.:0.110687   3rd Qu.:0.074641  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.000000   Max.   :1.000000  \n 2017 Cultivation PR 2017 Livestock PR 2017 Fishing PR    2017 Others PR   \n Min.   :0.00000     Min.   :0.0000    Min.   :0.000000   Min.   :0.00000  \n 1st Qu.:0.00378     1st Qu.:0.2829    1st Qu.:0.004268   1st Qu.:0.00000  \n Median :0.06756     Median :0.7049    Median :0.031480   Median :0.01382  \n Mean   :0.25321     Mean   :0.5882    Mean   :0.116152   Mean   :0.08881  \n 3rd Qu.:0.48539     3rd Qu.:0.8948    3rd Qu.:0.091937   3rd Qu.:0.06693  \n Max.   :1.00000     Max.   :1.0000    Max.   :1.000000   Max.   :1.00000  \n 2018 Cultivation PR 2018 Livestock PR 2018 Fishing PR    2018 Others PR   \n Min.   :0.000000    Min.   :0.0000    Min.   :0.000000   Min.   :0.00000  \n 1st Qu.:0.004927    1st Qu.:0.3234    1st Qu.:0.005248   1st Qu.:0.00000  \n Median :0.072482    Median :0.6965    Median :0.030015   Median :0.01476  \n Mean   :0.241739    Mean   :0.5927    Mean   :0.107518   Mean   :0.10894  \n 3rd Qu.:0.441395    3rd Qu.:0.8863    3rd Qu.:0.097035   3rd Qu.:0.08908  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.000000   Max.   :1.00000  \n 2019 Cultivation PR 2019 Livestock PR 2019 Fishing PR    2019 Others PR   \n Min.   :0.000000    Min.   :0.0000    Min.   :0.000000   Min.   :0.00000  \n 1st Qu.:0.003145    1st Qu.:0.3374    1st Qu.:0.003824   1st Qu.:0.00000  \n Median :0.063750    Median :0.6910    Median :0.028498   Median :0.01432  \n Mean   :0.238869    Mean   :0.5989    Mean   :0.105171   Mean   :0.11263  \n 3rd Qu.:0.438990    3rd Qu.:0.8786    3rd Qu.:0.092836   3rd Qu.:0.08735  \n Max.   :1.000000    Max.   :1.0000    Max.   :1.000000   Max.   :1.00000  \n 2020 Cultivation PR 2020 Livestock PR 2020 Fishing PR   2020 Others PR   \n Min.   :0.00000     Min.   :0.0000    Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.01447     1st Qu.:0.2644    1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.08328     Median :0.6348    Median :0.04222   Median :0.05104  \n Mean   :0.25842     Mean   :0.5523    Mean   :0.13689   Mean   :0.17761  \n 3rd Qu.:0.50470     3rd Qu.:0.8064    3rd Qu.:0.11884   3rd Qu.:0.25183  \n Max.   :1.00000     Max.   :1.0000    Max.   :1.00000   Max.   :1.00000  \n 2021 Cultivation PR 2021 Livestock PR 2021 Fishing PR     2021 Others PR   \n Min.   :0.00000     Min.   :0.0000    Min.   :0.0000000   Min.   :0.00000  \n 1st Qu.:0.01811     1st Qu.:0.3058    1st Qu.:0.0006245   1st Qu.:0.00000  \n Median :0.08292     Median :0.6286    Median :0.0407631   Median :0.03155  \n Mean   :0.25446     Mean   :0.5479    Mean   :0.1353759   Mean   :0.16091  \n 3rd Qu.:0.47135     3rd Qu.:0.7966    3rd Qu.:0.1324030   3rd Qu.:0.19928  \n Max.   :1.00000     Max.   :1.0000    Max.   :1.0000000   Max.   :1.00000  \n 2022 Cultivation PR 2022 Livestock PR 2022 Fishing PR     2022 Others PR   \n Min.   :0.00000     Min.   :0.0000    Min.   :0.0000000   Min.   :0.00000  \n 1st Qu.:0.02144     1st Qu.:0.3252    1st Qu.:0.0006252   1st Qu.:0.00000  \n Median :0.08465     Median :0.6341    Median :0.0414502   Median :0.01538  \n Mean   :0.24510     Mean   :0.5506    Mean   :0.1352420   Mean   :0.11489  \n 3rd Qu.:0.42178     3rd Qu.:0.8138    3rd Qu.:0.1155287   3rd Qu.:0.13504  \n Max.   :1.00000     Max.   :1.0000    Max.   :1.0000000   Max.   :1.00000  \n 2023 Cultivation PR 2023 Livestock PR 2023 Fishing PR   2023 Others PR   \n Min.   :0.00000     Min.   :0.0000    Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.01848     1st Qu.:0.3333    1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.08225     Median :0.5835    Median :0.04273   Median :0.02492  \n Mean   :0.25285     Mean   :0.5407    Mean   :0.13393   Mean   :0.12645  \n 3rd Qu.:0.50624     3rd Qu.:0.8336    3rd Qu.:0.12952   3rd Qu.:0.13201  \n Max.   :1.00000     Max.   :1.0000    Max.   :1.00000   Max.   :1.00000  \n```\n\n\n:::\n:::\n\n\n\nApplying Min-Max standardization scales the data to a range of 0 to 1, making it easier to compare variables with different units or ranges. The summary provides insights into how variables are rescaled. In Shiny, this standardization option will allow users to toggle between raw and normalized data views to understand how scaling affects the data distribution.\n\n### **Z-score standardisation**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm.z <- scale(vietnam_farm_ict)\ndescribe(vietnam_farm.z)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                      vars  n mean sd median trimmed  mad   min  max range\n2012 Total               1 63    0  1  -0.39   -0.20 0.36 -0.65 5.83  6.47\n2012 Cultivation farm    2 63    0  1  -0.49   -0.24 0.03 -0.51 4.17  4.68\n2012 Livestock farm      3 63    0  1  -0.43   -0.20 0.25 -0.61 4.92  5.53\n2012 Fishing farm        4 63    0  1  -0.17   -0.16 0.04 -0.20 7.72  7.92\n2012 Others(*)           5 63    0  1  -0.34   -0.26 0.08 -0.40 4.90  5.29\n2013 Total               6 63    0  1  -0.30   -0.19 0.54 -0.68 5.71  6.39\n2013 Cultivation farm    7 63    0  1  -0.50   -0.24 0.03 -0.52 3.99  4.51\n2013 Livestock farm      8 63    0  1  -0.43   -0.20 0.27 -0.63 5.07  5.69\n2013 Fishing farm        9 63    0  1  -0.18   -0.16 0.04 -0.20 7.72  7.92\n2013 Others(*)          10 63    0  1  -0.39   -0.25 0.12 -0.47 4.58  5.05\n2014 Total              11 63    0  1  -0.24   -0.19 0.65 -0.72 5.14  5.86\n2014 Cultivation farm   12 63    0  1  -0.54   -0.22 0.05 -0.57 3.31  3.88\n2014 Livestock farm     13 63    0  1  -0.38   -0.19 0.28 -0.59 5.61  6.20\n2014 Fishing farm       14 63    0  1  -0.18   -0.15 0.03 -0.20 7.74  7.94\n2014 Others(*)          15 63    0  1  -0.35   -0.23 0.14 -0.44 5.57  6.01\n2015 Total              16 63    0  1  -0.28   -0.19 0.64 -0.76 4.24  5.00\n2015 Cultivation farm   17 63    0  1  -0.53   -0.22 0.05 -0.57 3.28  3.84\n2015 Livestock farm     18 63    0  1  -0.38   -0.19 0.25 -0.57 5.55  6.12\n2015 Fishing farm       19 63    0  1  -0.19   -0.16 0.03 -0.22 7.70  7.91\n2015 Others(*)          20 63    0  1  -0.37   -0.23 0.13 -0.46 5.73  6.20\n2016 Total              21 63    0  1  -0.32   -0.16 0.63 -0.80 4.94  5.73\n2016 Cultivation farm   22 63    0  1  -0.48   -0.25 0.07 -0.53 3.59  4.12\n2016 Livestock farm     23 63    0  1  -0.37   -0.21 0.26 -0.56 5.18  5.74\n2016 Fishing farm       24 63    0  1  -0.41   -0.25 0.19 -0.54 4.34  4.88\n2016 Others(*)          25 63    0  1  -0.23   -0.18 0.11 -0.30 7.46  7.77\n2017 Total              26 63    0  1  -0.30   -0.15 0.68 -0.81 4.96  5.77\n2017 Cultivation farm   27 63    0  1  -0.50   -0.25 0.06 -0.54 3.66  4.20\n2017 Livestock farm     28 63    0  1  -0.38   -0.21 0.26 -0.57 5.17  5.74\n2017 Fishing farm       29 63    0  1  -0.39   -0.25 0.21 -0.53 3.77  4.31\n2017 Others(*)          30 63    0  1  -0.26   -0.20 0.07 -0.31 7.30  7.62\n2018 Total              31 63    0  1  -0.25   -0.15 0.74 -0.84 4.61  5.45\n2018 Cultivation farm   32 63    0  1  -0.50   -0.24 0.06 -0.54 3.84  4.39\n2018 Livestock farm     33 63    0  1  -0.36   -0.19 0.32 -0.60 4.85  5.45\n2018 Fishing farm       34 63    0  1  -0.42   -0.25 0.17 -0.53 4.47  5.00\n2018 Others(*)          35 63    0  1  -0.26   -0.22 0.10 -0.32 7.05  7.37\n2019 Total              36 63    0  1  -0.19   -0.16 0.76 -0.82 4.64  5.46\n2019 Cultivation farm   37 63    0  1  -0.50   -0.24 0.07 -0.55 3.94  4.49\n2019 Livestock farm     38 63    0  1  -0.35   -0.20 0.34 -0.60 4.91  5.51\n2019 Fishing farm       39 63    0  1  -0.42   -0.25 0.17 -0.54 4.49  5.02\n2019 Others(*)          40 63    0  1  -0.27   -0.22 0.10 -0.33 6.90  7.23\n2020 Total              41 63    0  1  -0.27   -0.16 0.71 -0.89 4.75  5.64\n2020 Cultivation farm   42 63    0  1  -0.44   -0.24 0.14 -0.54 4.09  4.63\n2020 Livestock farm     43 63    0  1  -0.39   -0.21 0.37 -0.66 4.61  5.27\n2020 Fishing farm       44 63    0  1  -0.39   -0.23 0.15 -0.50 5.69  6.19\n2020 Others(*)          45 63    0  1  -0.43   -0.26 0.17 -0.55 4.61  5.16\n2021 Total              46 63    0  1  -0.30   -0.16 0.70 -0.92 4.34  5.26\n2021 Cultivation farm   47 63    0  1  -0.45   -0.24 0.16 -0.56 4.29  4.85\n2021 Livestock farm     48 63    0  1  -0.36   -0.21 0.37 -0.66 4.63  5.29\n2021 Fishing farm       49 63    0  1  -0.37   -0.23 0.16 -0.47 5.97  6.44\n2021 Others(*)          50 63    0  1  -0.42   -0.26 0.14 -0.52 4.30  4.81\n2022 Total              51 63    0  1  -0.27   -0.15 0.75 -0.94 4.07  5.01\n2022 Cultivation farm   52 63    0  1  -0.44   -0.24 0.17 -0.56 4.41  4.97\n2022 Livestock farm     53 63    0  1  -0.37   -0.20 0.41 -0.69 4.69  5.38\n2022 Fishing farm       54 63    0  1  -0.39   -0.23 0.14 -0.49 6.01  6.50\n2022 Others(*)          55 63    0  1  -0.44   -0.25 0.13 -0.53 4.17  4.70\n2023 Total              56 63    0  1  -0.27   -0.15 0.76 -0.97 3.84  4.81\n2023 Cultivation farm   57 63    0  1  -0.45   -0.24 0.14 -0.55 3.93  4.48\n2023 Livestock farm     58 63    0  1  -0.40   -0.20 0.39 -0.70 4.81  5.51\n2023 Fishing farm       59 63    0  1  -0.38   -0.22 0.13 -0.47 6.30  6.77\n2023 Others(*)          60 63    0  1  -0.40   -0.24 0.26 -0.57 4.52  5.09\n2012 Cultivation PR     61 63    0  1  -0.62   -0.14 0.25 -0.79 2.06  2.85\n2012 Livestock PR       62 63    0  1   0.03   -0.01 1.40 -1.38 1.57  2.95\n2012 Fishing PR         63 63    0  1  -0.42   -0.25 0.29 -0.62 3.39  4.01\n2012 Others PR          64 63    0  1  -0.46   -0.23 0.20 -0.59 3.12  3.71\n2013 Cultivation PR     65 63    0  1  -0.65   -0.14 0.19 -0.78 2.09  2.87\n2013 Livestock PR       66 63    0  1  -0.08   -0.01 1.50 -1.42 1.51  2.93\n2013 Fishing PR         67 63    0  1  -0.36   -0.25 0.34 -0.59 3.80  4.39\n2013 Others PR          68 63    0  1  -0.54   -0.21 0.16 -0.64 3.48  4.13\n2014 Cultivation PR     69 63    0  1  -0.61   -0.13 0.26 -0.79 2.02  2.81\n2014 Livestock PR       70 63    0  1   0.11    0.03 1.39 -1.60 1.36  2.96\n2014 Fishing PR         71 63    0  1  -0.39   -0.26 0.28 -0.59 3.82  4.41\n2014 Others PR          72 63    0  1  -0.48   -0.23 0.26 -0.65 3.86  4.51\n2015 Cultivation PR     73 63    0  1  -0.59   -0.15 0.28 -0.78 2.07  2.84\n2015 Livestock PR       74 63    0  1   0.22    0.04 1.17 -1.67 1.32  2.99\n2015 Fishing PR         75 63    0  1  -0.39   -0.25 0.27 -0.57 4.09  4.66\n2015 Others PR          76 63    0  1  -0.50   -0.20 0.31 -0.71 3.05  3.76\n2016 Cultivation PR     77 63    0  1  -0.55   -0.16 0.31 -0.75 2.26  3.01\n2016 Livestock PR       78 63    0  1   0.34    0.06 1.08 -1.79 1.18  2.97\n2016 Fishing PR         79 63    0  1  -0.41   -0.24 0.26 -0.58 4.70  5.29\n2016 Others PR          80 63    0  1  -0.33   -0.23 0.21 -0.47 6.11  6.58\n2017 Cultivation PR     81 63    0  1  -0.54   -0.16 0.29 -0.74 2.19  2.93\n2017 Livestock PR       82 63    0  1   0.35    0.06 1.08 -1.76 1.23  2.99\n2017 Fishing PR         83 63    0  1  -0.41   -0.25 0.23 -0.57 4.31  4.88\n2017 Others PR          84 63    0  1  -0.40   -0.24 0.11 -0.48 4.92  5.40\n2018 Cultivation PR     85 63    0  1  -0.51   -0.16 0.33 -0.73 2.30  3.04\n2018 Livestock PR       86 63    0  1   0.32    0.06 1.14 -1.84 1.26  3.10\n2018 Fishing PR         87 63    0  1  -0.40   -0.26 0.23 -0.55 4.56  5.10\n2018 Others PR          88 63    0  1  -0.44   -0.25 0.10 -0.51 4.19  4.70\n2019 Cultivation PR     89 63    0  1  -0.52   -0.17 0.28 -0.71 2.27  2.99\n2019 Livestock PR       90 63    0  1   0.29    0.06 1.09 -1.86 1.25  3.11\n2019 Fishing PR         91 63    0  1  -0.40   -0.26 0.22 -0.55 4.66  5.20\n2019 Others PR          92 63    0  1  -0.45   -0.26 0.10 -0.51 4.05  4.57\n2020 Cultivation PR     93 63    0  1  -0.55   -0.15 0.39 -0.81 2.33  3.14\n2020 Livestock PR       94 63    0  1   0.26    0.05 1.16 -1.72 1.39  3.11\n2020 Fishing PR         95 63    0  1  -0.39   -0.25 0.26 -0.57 3.59  4.15\n2020 Others PR          96 63    0  1  -0.47   -0.21 0.28 -0.66 3.04  3.70\n2021 Cultivation PR     97 63    0  1  -0.57   -0.14 0.41 -0.84 2.47  3.32\n2021 Livestock PR       98 63    0  1   0.26    0.05 1.10 -1.77 1.46  3.24\n2021 Fishing PR         99 63    0  1  -0.40   -0.25 0.26 -0.57 3.65  4.22\n2021 Others PR         100 63    0  1  -0.51   -0.22 0.18 -0.63 3.30  3.93\n2022 Cultivation PR    101 63    0  1  -0.54   -0.16 0.42 -0.82 2.53  3.35\n2022 Livestock PR      102 63    0  1   0.27    0.05 1.06 -1.75 1.43  3.19\n2022 Fishing PR        103 63    0  1  -0.40   -0.25 0.26 -0.57 3.67  4.24\n2022 Others PR         104 63    0  1  -0.49   -0.23 0.11 -0.56 4.34  4.91\n2023 Cultivation PR    105 63    0  1  -0.55   -0.15 0.39 -0.82 2.41  3.23\n2023 Livestock PR      106 63    0  1   0.14    0.04 1.18 -1.72 1.46  3.18\n2023 Fishing PR        107 63    0  1  -0.39   -0.25 0.27 -0.57 3.71  4.28\n2023 Others PR         108 63    0  1  -0.45   -0.25 0.16 -0.56 3.88  4.44\n                       skew kurtosis   se\n2012 Total             3.48    16.15 0.13\n2012 Cultivation farm  2.24     4.73 0.13\n2012 Livestock farm    2.85     9.72 0.13\n2012 Fishing farm      7.31    53.39 0.13\n2012 Others(*)         3.61    13.14 0.13\n2013 Total             3.33    14.90 0.13\n2013 Cultivation farm  2.14     4.07 0.13\n2013 Livestock farm    2.85    10.01 0.13\n2013 Fishing farm      7.30    53.31 0.13\n2013 Others(*)         3.18    10.06 0.13\n2014 Total             2.95    11.00 0.13\n2014 Cultivation farm  1.71     1.74 0.13\n2014 Livestock farm    3.46    14.92 0.13\n2014 Fishing farm      7.36    54.01 0.13\n2014 Others(*)         3.99    17.28 0.13\n2015 Total             2.55     7.57 0.13\n2015 Cultivation farm  1.77     2.07 0.13\n2015 Livestock farm    3.63    15.57 0.13\n2015 Fishing farm      7.24    52.70 0.13\n2015 Others(*)         3.97    17.71 0.13\n2016 Total             2.88    10.67 0.13\n2016 Cultivation farm  2.17     3.98 0.13\n2016 Livestock farm    3.57    14.32 0.13\n2016 Fishing farm      2.57     6.34 0.13\n2016 Others(*)         6.63    46.30 0.13\n2017 Total             2.86    10.67 0.13\n2017 Cultivation farm  2.09     3.54 0.13\n2017 Livestock farm    3.48    13.76 0.13\n2017 Fishing farm      2.45     5.36 0.13\n2017 Others(*)         6.26    42.30 0.13\n2018 Total             2.77     9.81 0.13\n2018 Cultivation farm  2.18     4.17 0.13\n2018 Livestock farm    3.46    13.50 0.13\n2018 Fishing farm      2.62     6.77 0.13\n2018 Others(*)         5.75    36.55 0.13\n2019 Total             2.87    10.38 0.13\n2019 Cultivation farm  2.26     4.74 0.13\n2019 Livestock farm    3.45    13.46 0.13\n2019 Fishing farm      2.62     6.77 0.13\n2019 Others(*)         5.47    33.47 0.13\n2020 Total             2.52     8.44 0.13\n2020 Cultivation farm  2.57     6.39 0.13\n2020 Livestock farm    2.79     8.88 0.13\n2020 Fishing farm      3.56    15.29 0.13\n2020 Others(*)         2.63     7.11 0.13\n2021 Total             2.20     6.29 0.13\n2021 Cultivation farm  2.52     6.54 0.13\n2021 Livestock farm    2.77     8.75 0.13\n2021 Fishing farm      3.89    18.35 0.13\n2021 Others(*)         2.72     7.39 0.13\n2022 Total             2.07     5.58 0.13\n2022 Cultivation farm  2.57     6.87 0.13\n2022 Livestock farm    2.58     7.78 0.13\n2022 Fishing farm      3.92    18.85 0.13\n2022 Others(*)         2.67     7.12 0.13\n2023 Total             1.68     3.26 0.13\n2023 Cultivation farm  2.30     4.72 0.13\n2023 Livestock farm    2.47     7.40 0.13\n2023 Fishing farm      4.32    22.77 0.13\n2023 Others(*)         2.53     6.69 0.13\n2012 Cultivation PR    0.93    -0.73 0.13\n2012 Livestock PR      0.03    -1.47 0.13\n2012 Fishing PR        2.03     3.14 0.13\n2012 Others PR         1.90     2.43 0.13\n2013 Cultivation PR    0.92    -0.73 0.13\n2013 Livestock PR      0.01    -1.47 0.13\n2013 Fishing PR        2.21     4.18 0.13\n2013 Others PR         1.69     1.99 0.13\n2014 Cultivation PR    0.89    -0.81 0.13\n2014 Livestock PR     -0.21    -1.47 0.13\n2014 Fishing PR        2.27     4.36 0.13\n2014 Others PR         2.00     3.49 0.13\n2015 Cultivation PR    1.00    -0.52 0.13\n2015 Livestock PR     -0.30    -1.38 0.13\n2015 Fishing PR        2.34     5.04 0.13\n2015 Others PR         1.59     1.61 0.13\n2016 Cultivation PR    1.09    -0.37 0.13\n2016 Livestock PR     -0.47    -1.31 0.13\n2016 Fishing PR        2.61     7.29 0.13\n2016 Others PR         4.15    20.58 0.13\n2017 Cultivation PR    1.10    -0.38 0.13\n2017 Livestock PR     -0.41    -1.36 0.13\n2017 Fishing PR        2.39     5.45 0.13\n2017 Others PR         3.12    10.55 0.13\n2018 Cultivation PR    1.16    -0.24 0.13\n2018 Livestock PR     -0.40    -1.28 0.13\n2018 Fishing PR        2.65     6.94 0.13\n2018 Others PR         2.52     6.05 0.13\n2019 Cultivation PR    1.18    -0.22 0.13\n2019 Livestock PR     -0.44    -1.25 0.13\n2019 Fishing PR        2.69     7.41 0.13\n2019 Others PR         2.43     5.37 0.13\n2020 Cultivation PR    1.01    -0.47 0.13\n2020 Livestock PR     -0.44    -1.22 0.13\n2020 Fishing PR        2.32     4.62 0.13\n2020 Others PR         1.64     1.58 0.13\n2021 Cultivation PR    1.00    -0.44 0.13\n2021 Livestock PR     -0.41    -1.14 0.13\n2021 Fishing PR        2.40     5.03 0.13\n2021 Others PR         1.86     2.61 0.13\n2022 Cultivation PR    1.11    -0.12 0.13\n2022 Livestock PR     -0.41    -1.15 0.13\n2022 Fishing PR        2.39     5.02 0.13\n2022 Others PR         2.38     5.85 0.13\n2023 Cultivation PR    1.04    -0.38 0.13\n2023 Livestock PR     -0.29    -1.21 0.13\n2023 Fishing PR        2.34     4.82 0.13\n2023 Others PR         2.26     4.50 0.13\n```\n\n\n:::\n:::\n\n\n\nZ-score standardization adjusts each variable to have a mean of 0 and a standard deviation of 1. This method is useful for comparing variables on a common scale without the influence of original units. In Shiny, users will be able to view data using this standardization method, making it easier to detect outliers or extreme values across farm types.\n\n### **Visualising the standardised clustering variables**\n\nTo provide users with a complete understanding of the raw and standardized values, I plan to incorporate the options \"type of farm,\" \"year,\" and \"selection\" (histogram or density) into the Shiny UI.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr <- ggplot(data = vietnam_farm_ict, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_histogram(bins = 20, \n                 color = \"black\", \n                 fill = \"light blue\") +\n  ggtitle(\"Raw Values (without Standardization)\")\n\nvietnam_farm_std_df <- as.data.frame(vietnam_farm.std)\n\ns <- ggplot(data = vietnam_farm_std_df, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_histogram(bins = 20, \n                 color = \"black\", \n                 fill = \"light blue\") +\n  ggtitle(\"Min-Max Standardization\")\n\nvietnam_farm_z_df <- as.data.frame(vietnam_farm.z)\n\nz <- ggplot(data = vietnam_farm_z_df, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_histogram(bins = 20, \n                 color = \"black\", \n                 fill = \"light blue\") +\n  ggtitle(\"Z-score Standardization\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\nHere, histograms compare the distribution of \"Cultivation PR\" for 2012 under three conditions: raw values, Min-Max standardized, and Z-score standardized. In the Shiny UI, I’ll present these options to allow users to view the impact of different standardization methods on the data. This visualization will help users understand how scaling changes the data’s spread and enables them to select the most informative view for their analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr <- ggplot(data = vietnam_farm_ict, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_density(color = \"black\", \n               fill = \"light blue\") +\n  ggtitle(\"Raw Values (without Standardization)\")\n\nvietnam_farm_std_df <- as.data.frame(vietnam_farm.std)\n\ns <- ggplot(data = vietnam_farm_std_df, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_density(color = \"black\", \n               fill = \"light blue\") +\n  ggtitle(\"Min-Max Standardization\")\n\nvietnam_farm_z_df <- as.data.frame(vietnam_farm.z)\n\nz <- ggplot(data = vietnam_farm_z_df, \n            aes(x = `2012 Cultivation PR`)) +\n  geom_density(color = \"black\", \n               fill = \"light blue\") +\n  ggtitle(\"Z-score Standardization\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\nSimilar to the histograms, these density plots display the distribution of \"Cultivation PR\" for 2012 under raw, Min-Max, and Z-score standardizations. In Shiny, I’ll offer a choice between histogram and density plot types so users can explore the data distribution in the format that best suits their analysis. These density plots provide a smoother view of data spread, aiding users in understanding variability and data concentration more intuitively.\n\n![](images/clipboard-810687904.png)\n\n### **Computing proximity matrix**\n\nWhen designing the Shiny UI, I’ll include the variable \"year,\" allowing users to explore data clustering for different years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_ict_2012 <- vietnam_farm %>%\n  st_drop_geometry() %>%\n  select(matches(\"^2012.*(PR|farm|Others\\\\(\\\\*\\\\))\"))\n```\n:::\n\n\n\nThis code creates a subset of `vietnam_farm` containing only 2012 data for variables related to farm counts and proportions. Removing geometry with `st_drop_geometry()` makes it easier to compute distances for numeric data only.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproxmat <- dist(vietnam_farm_ict_2012, method = 'euclidean')\n```\n:::\n\n\n\nHere, I calculate a proximity matrix using Euclidean distance, which measures similarity across provinces based on their farm metrics. This proximity matrix is foundational for clustering analysis in Shiny, helping users see how similar or different provinces are from each other based on the chosen year.\n\n### **Computing hierarchical clustering**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhclust_ward <- hclust(proxmat, method = 'ward.D')\n```\n:::\n\n\n\nUsing the `ward.D` method, this line creates a hierarchical clustering model based on the computed proximity matrix. The Ward method minimizes variance within clusters, making it ideal for grouping provinces with similar farm characteristics.\n\n### **Selecting the optimal clustering algorithm**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- c(\"average\", \"single\", \"complete\", \"ward\")\nnames(m) <- c(\"average\", \"single\", \"complete\", \"ward\")\n\nac <- function(x) {\n  agnes(vietnam_farm_ict_2012, method = x)$ac \n}\n\nac_values <- map_dbl(m, ac)\n\nprint(ac_values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  average    single  complete      ward \n0.9311650 0.9302807 0.9326505 0.9507638 \n```\n\n\n:::\n:::\n\n\n\nTo identify the best clustering method, I calculate the agglomerative coefficient (`ac`) for multiple algorithms (average, single, complete, and ward). Higher `ac` values indicate more compact clusters. In Shiny, users will be able to choose their preferred clustering method based on these coefficients, helping them explore the segmentation of provinces under different methods.\n\n### **Determining Optimal Clusters**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(12345)\n\ngap_stat <- clusGap(vietnam_farm_ict_2012, \n                    FUN = hcut,      \n                    nstart = 25,     \n                    K.max = 10, \n                    B = 50)          \n\nprint(gap_stat, method = \"firstmax\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = vietnam_farm_ict_2012, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)\nB=50 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --> Number of clusters (method 'firstmax'): 10\n          logW    E.logW       gap     SE.sim\n [1,] 9.550950 10.120713 0.5697632 0.03462151\n [2,] 9.273024  9.865547 0.5925228 0.03516704\n [3,] 9.136299  9.754807 0.6185080 0.02895591\n [4,] 8.955791  9.669456 0.7136646 0.02807787\n [5,] 8.823899  9.597481 0.7735820 0.02647654\n [6,] 8.717810  9.535364 0.8175540 0.02630438\n [7,] 8.610772  9.478403 0.8676310 0.02645239\n [8,] 8.520614  9.426002 0.9053875 0.02772165\n [9,] 8.443205  9.376155 0.9329498 0.02824257\n[10,] 8.349777  9.329776 0.9799991 0.02918417\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_gap_stat(gap_stat)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n\nThe `clusGap` function uses gap statistics to determine the optimal number of clusters (K) by comparing clustering quality across different K values. In Shiny, I’ll include the option to adjust K values, allowing users to view how segmentation quality changes and helping them select an ideal number of clusters based on the gap statistic plot.\n\n![](images/clipboard-42895384.png)\n\n### **Interpreting the dendrograms**\n\nWhen designing the Shiny UI, I will include the variable: k value and variable: year to enable users to explore clustering results in detail.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(hclust_ward, labels = vietnam_farm$`Cities, provincies`, cex = 0.7)\nrect.hclust(hclust_ward, \n            k = 6, \n            border = 2:5)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\nThe dendrogram plot visualizes hierarchical clustering, with rectangles drawn around six clusters to show grouping. In Shiny, I’ll include adjustable K values, allowing users to choose the number of clusters (K) interactively and visualize how provinces group under different K values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_ict_mat <- data.matrix(vietnam_farm_ict_2012)\n```\n:::\n\n\n\nThis line converts the `vietnam_farm_ict_2012` data frame into a matrix format for use in clustering and heatmap visualization.\n\n#### Plotting interactive cluster heatmap using *heatmaply()*\n\nWhen designing the Shiny UI, I will include variable: k value and variable: year to allow users to customize the heatmap view.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_ict_pr_2012 <- vietnam_farm %>%\n  st_drop_geometry() %>%\n  select(matches(\"^2012.*PR$\")) %>%\n  mutate(across(everything(), ~replace_na(as.numeric(.), 0)))\n\nrownames(vietnam_farm_ict_pr_2012) <- vietnam_farm$`Cities, provincies`\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Setting row names on a tibble is deprecated.\n```\n\n\n:::\n\n```{.r .cell-code}\nvietnam_farm_ict_pr_2012_std <- normalize(vietnam_farm_ict_pr_2012)\n\nheatmaply(\n  vietnam_farm_ict_pr_2012_std,\n  Colv = NA,\n  dist_method = \"euclidean\",\n  hclust_method = \"ward.D\",\n  seriate = \"OLO\",\n  colors = Blues,\n  k_row = 6,\n  margins = c(NA, 200, 60, NA),\n  fontsize_row = 4,\n  fontsize_col = 5,\n  main = \"Geographic Segmentation of Vietnam Farms by ICT Indicators (2012)\",\n  xlab = \"ICT Indicators\",\n  ylab = \"Provinces of Vietnam\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-9323d18cd3186c2931c2\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9323d18cd3186c2931c2\">{\"x\":{\"data\":[{\"x\":[1,2,3,4],\"y\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"z\":[[0.50604490500863553,0.089810017271157172,0.099613938839784616,0.62521588946459417],[0.2608695652173913,0.39130434782608697,0,0.69565217391304346],[0.20000000000000001,0.40000000000000002,0,0.80000000000000004],[0.25,0.25,0,1],[0,0.5,0,1],[0,0.54545454545454541,0,0.90909090909090906],[0,0.59999999999999998,0.036274509803921572,0.73333333333333328],[0.069565217391304349,0.47826086956521741,0.15613810741687978,0.61739130434782608],[0.058139534883720929,0.5,0.1771545827633379,0.55813953488372092],[0.025000000000000001,0.73333333333333328,0.11789215686274511,0.26666666666666666],[0.0089213300892133016,0.74533657745336579,0.1659271981298602,0.18653690186536903],[0.035714285714285712,0.7678571428571429,0.13602941176470587,0.14285714285714285],[0,0.79591836734693877,0.13325330132052821,0.16326530612244897],[0.050000000000000003,0.80000000000000004,0,0.29999999999999999],[0.0059288537549407111,0.82806324110671936,0.034410602185538243,0.26877470355731226],[0,0.8783783783783784,0.029411764705882353,0.1891891891891892],[0.033333333333333333,0.90000000000000002,0,0.13333333333333333],[0,1,0,0],[0,1,0,0],[0.004807692307692308,0.98798076923076927,0.0078478506787330315,0],[0.011331444759206799,0.97733711048158645,0.0092484585902349627,0.0056657223796033997],[0.034482758620689655,0.96551724137931039,0,0],[0.0234375,0.90234375,0.055261948529411763,0.046875],[0,0.90551181102362199,0.07711903659101435,0.047244094488188976],[0,0.91666666666666663,0.090686274509803919,0],[0,0.87857142857142856,0.13214285714285715,0],[0.009433962264150943,0.84591194968553463,0.15741768405475398,0],[0.0023752969121140144,0.82422802850356292,0.16284756182758139,0.047505938242280284],[0.043771043771043773,0.7407407407407407,0.23450188156070506,0],[0.094339622641509441,0.61132075471698111,0.2669256381798002,0.098113207547169817],[0,0.52500000000000002,0.38088235294117645,0.25],[0.0066666666666666671,0.44166666666666665,0.58039215686274515,0.036666666666666667],[0.0054644808743169399,0.31693989071038253,0.72251687560270006,0.027322404371584699],[0.028368794326241134,0.31205673758865249,0.67918231122236128,0.070921985815602842],[0.36538461538461536,0.26923076923076922,0.37669683257918546,0.038461538461538464],[0,0,0,0],[0,0,0,0],[0.25862068965517243,0.65517241379310343,0,0.17241379310344829],[0.23997532387415177,0.7230104873534855,0.0087273650977972919,0.057988895743368289],[0.21621621621621623,0.70270270270270274,0.088235294117647051,0],[0.29464285714285715,0.6339285714285714,0.068014705882352935,0.017857142857142856],[0.45295404814004375,0.54704595185995619,0,0],[0.53655514250309788,0.4510532837670384,0.013484947882498726,0],[0.56451612903225812,0.40322580645161288,0.017552182163187855,0.032258064516129031],[0.93345008756567427,0.014010507880910683,0.057175234366951683,0],[0.93362509117432535,0.064916119620714807,0,0.0029175784099197666],[0.94934143870314081,0.042553191489361701,0.0066154121222957267,0.0040526849037487338],[0.96059113300492616,0.039408866995073892,0,0],[0.96721311475409832,0.032786885245901641,0,0],[0.98247535596933189,0.017524644030668127,0,0],[1,0,0,0],[0.89583333333333337,0.013888888888888888,0.049121732026143783,0.090277777777777776],[0.87727272727272732,0.093181818181818185,0.032152406417112298,0],[0.70114942528735635,0.29619805481874445,0.0019243771779268734,0.0017683465959328027],[0.68900343642611683,0.2766323024054983,0.0074792803719425909,0.054982817869415807],[0.65548780487804881,0.18597560975609756,0.17252510760401721,0],[0.71875,0.09375,0.18704044117647059,0.03125],[0.72925764192139741,0.052401746724890827,0.2090932442846134,0.052401746724890827],[0.54166666666666663,0.16666666666666666,0.2267156862745098,0.16666666666666666],[0.095238095238095233,0.15873015873015872,0.79458450046685336,0.031746031746031744],[0,0.19444444444444445,0.87663398692810457,0],[0,0.081081081081081086,1,0],[0.11479520757871273,0.0052939537475619946,0.89721043056397809,0.11089439955419336]],\"text\":[[\"row: 29<br>column: 2012 Cultivation PR<br>value: 0.506045\",\"row: 29<br>column: 2012 Livestock PR<br>value: 0.089810\",\"row: 29<br>column: 2012 Fishing PR<br>value: 0.099614\",\"row: 29<br>column: 2012 Others PR<br>value: 0.625216\"],[\"row: 15<br>column: 2012 Cultivation PR<br>value: 0.260870\",\"row: 15<br>column: 2012 Livestock PR<br>value: 0.391304\",\"row: 15<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 15<br>column: 2012 Others PR<br>value: 0.695652\"],[\"row: 22<br>column: 2012 Cultivation PR<br>value: 0.200000\",\"row: 22<br>column: 2012 Livestock PR<br>value: 0.400000\",\"row: 22<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 22<br>column: 2012 Others PR<br>value: 0.800000\"],[\"row: 60<br>column: 2012 Cultivation PR<br>value: 0.250000\",\"row: 60<br>column: 2012 Livestock PR<br>value: 0.250000\",\"row: 60<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 60<br>column: 2012 Others PR<br>value: 1.000000\"],[\"row: 13<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 13<br>column: 2012 Livestock PR<br>value: 0.500000\",\"row: 13<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 13<br>column: 2012 Others PR<br>value: 1.000000\"],[\"row: 32<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 32<br>column: 2012 Livestock PR<br>value: 0.545455\",\"row: 32<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 32<br>column: 2012 Others PR<br>value: 0.909091\"],[\"row: 11<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 11<br>column: 2012 Livestock PR<br>value: 0.600000\",\"row: 11<br>column: 2012 Fishing PR<br>value: 0.036275\",\"row: 11<br>column: 2012 Others PR<br>value: 0.733333\"],[\"row: 27<br>column: 2012 Cultivation PR<br>value: 0.069565\",\"row: 27<br>column: 2012 Livestock PR<br>value: 0.478261\",\"row: 27<br>column: 2012 Fishing PR<br>value: 0.156138\",\"row: 27<br>column: 2012 Others PR<br>value: 0.617391\"],[\"row: 28<br>column: 2012 Cultivation PR<br>value: 0.058140\",\"row: 28<br>column: 2012 Livestock PR<br>value: 0.500000\",\"row: 28<br>column: 2012 Fishing PR<br>value: 0.177155\",\"row: 28<br>column: 2012 Others PR<br>value: 0.558140\"],[\"row: 9<br>column: 2012 Cultivation PR<br>value: 0.025000\",\"row: 9<br>column: 2012 Livestock PR<br>value: 0.733333\",\"row: 9<br>column: 2012 Fishing PR<br>value: 0.117892\",\"row: 9<br>column: 2012 Others PR<br>value: 0.266667\"],[\"row: 1<br>column: 2012 Cultivation PR<br>value: 0.008921\",\"row: 1<br>column: 2012 Livestock PR<br>value: 0.745337\",\"row: 1<br>column: 2012 Fishing PR<br>value: 0.165927\",\"row: 1<br>column: 2012 Others PR<br>value: 0.186537\"],[\"row: 21<br>column: 2012 Cultivation PR<br>value: 0.035714\",\"row: 21<br>column: 2012 Livestock PR<br>value: 0.767857\",\"row: 21<br>column: 2012 Fishing PR<br>value: 0.136029\",\"row: 21<br>column: 2012 Others PR<br>value: 0.142857\"],[\"row: 33<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 33<br>column: 2012 Livestock PR<br>value: 0.795918\",\"row: 33<br>column: 2012 Fishing PR<br>value: 0.133253\",\"row: 33<br>column: 2012 Others PR<br>value: 0.163265\"],[\"row: 34<br>column: 2012 Cultivation PR<br>value: 0.050000\",\"row: 34<br>column: 2012 Livestock PR<br>value: 0.800000\",\"row: 34<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 34<br>column: 2012 Others PR<br>value: 0.300000\"],[\"row: 5<br>column: 2012 Cultivation PR<br>value: 0.005929\",\"row: 5<br>column: 2012 Livestock PR<br>value: 0.828063\",\"row: 5<br>column: 2012 Fishing PR<br>value: 0.034411\",\"row: 5<br>column: 2012 Others PR<br>value: 0.268775\"],[\"row: 3<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 3<br>column: 2012 Livestock PR<br>value: 0.878378\",\"row: 3<br>column: 2012 Fishing PR<br>value: 0.029412\",\"row: 3<br>column: 2012 Others PR<br>value: 0.189189\"],[\"row: 35<br>column: 2012 Cultivation PR<br>value: 0.033333\",\"row: 35<br>column: 2012 Livestock PR<br>value: 0.900000\",\"row: 35<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 35<br>column: 2012 Others PR<br>value: 0.133333\"],[\"row: 19<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 19<br>column: 2012 Livestock PR<br>value: 1.000000\",\"row: 19<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 19<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 17<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 17<br>column: 2012 Livestock PR<br>value: 1.000000\",\"row: 17<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 17<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 18<br>column: 2012 Cultivation PR<br>value: 0.004808\",\"row: 18<br>column: 2012 Livestock PR<br>value: 0.987981\",\"row: 18<br>column: 2012 Fishing PR<br>value: 0.007848\",\"row: 18<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 7<br>column: 2012 Cultivation PR<br>value: 0.011331\",\"row: 7<br>column: 2012 Livestock PR<br>value: 0.977337\",\"row: 7<br>column: 2012 Fishing PR<br>value: 0.009248\",\"row: 7<br>column: 2012 Others PR<br>value: 0.005666\"],[\"row: 24<br>column: 2012 Cultivation PR<br>value: 0.034483\",\"row: 24<br>column: 2012 Livestock PR<br>value: 0.965517\",\"row: 24<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 24<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 20<br>column: 2012 Cultivation PR<br>value: 0.023438\",\"row: 20<br>column: 2012 Livestock PR<br>value: 0.902344\",\"row: 20<br>column: 2012 Fishing PR<br>value: 0.055262\",\"row: 20<br>column: 2012 Others PR<br>value: 0.046875\"],[\"row: 2<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 2<br>column: 2012 Livestock PR<br>value: 0.905512\",\"row: 2<br>column: 2012 Fishing PR<br>value: 0.077119\",\"row: 2<br>column: 2012 Others PR<br>value: 0.047244\"],[\"row: 16<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 16<br>column: 2012 Livestock PR<br>value: 0.916667\",\"row: 16<br>column: 2012 Fishing PR<br>value: 0.090686\",\"row: 16<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 50<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 50<br>column: 2012 Livestock PR<br>value: 0.878571\",\"row: 50<br>column: 2012 Fishing PR<br>value: 0.132143\",\"row: 50<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 53<br>column: 2012 Cultivation PR<br>value: 0.009434\",\"row: 53<br>column: 2012 Livestock PR<br>value: 0.845912\",\"row: 53<br>column: 2012 Fishing PR<br>value: 0.157418\",\"row: 53<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 6<br>column: 2012 Cultivation PR<br>value: 0.002375\",\"row: 6<br>column: 2012 Livestock PR<br>value: 0.824228\",\"row: 6<br>column: 2012 Fishing PR<br>value: 0.162848\",\"row: 6<br>column: 2012 Others PR<br>value: 0.047506\"],[\"row: 52<br>column: 2012 Cultivation PR<br>value: 0.043771\",\"row: 52<br>column: 2012 Livestock PR<br>value: 0.740741\",\"row: 52<br>column: 2012 Fishing PR<br>value: 0.234502\",\"row: 52<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 26<br>column: 2012 Cultivation PR<br>value: 0.094340\",\"row: 26<br>column: 2012 Livestock PR<br>value: 0.611321\",\"row: 26<br>column: 2012 Fishing PR<br>value: 0.266926\",\"row: 26<br>column: 2012 Others PR<br>value: 0.098113\"],[\"row: 31<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 31<br>column: 2012 Livestock PR<br>value: 0.525000\",\"row: 31<br>column: 2012 Fishing PR<br>value: 0.380882\",\"row: 31<br>column: 2012 Others PR<br>value: 0.250000\"],[\"row: 8<br>column: 2012 Cultivation PR<br>value: 0.006667\",\"row: 8<br>column: 2012 Livestock PR<br>value: 0.441667\",\"row: 8<br>column: 2012 Fishing PR<br>value: 0.580392\",\"row: 8<br>column: 2012 Others PR<br>value: 0.036667\"],[\"row: 10<br>column: 2012 Cultivation PR<br>value: 0.005464\",\"row: 10<br>column: 2012 Livestock PR<br>value: 0.316940\",\"row: 10<br>column: 2012 Fishing PR<br>value: 0.722517\",\"row: 10<br>column: 2012 Others PR<br>value: 0.027322\"],[\"row: 4<br>column: 2012 Cultivation PR<br>value: 0.028369\",\"row: 4<br>column: 2012 Livestock PR<br>value: 0.312057\",\"row: 4<br>column: 2012 Fishing PR<br>value: 0.679182\",\"row: 4<br>column: 2012 Others PR<br>value: 0.070922\"],[\"row: 38<br>column: 2012 Cultivation PR<br>value: 0.365385\",\"row: 38<br>column: 2012 Livestock PR<br>value: 0.269231\",\"row: 38<br>column: 2012 Fishing PR<br>value: 0.376697\",\"row: 38<br>column: 2012 Others PR<br>value: 0.038462\"],[\"row: 23<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 23<br>column: 2012 Livestock PR<br>value: 0.000000\",\"row: 23<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 23<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 14<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 14<br>column: 2012 Livestock PR<br>value: 0.000000\",\"row: 14<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 14<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 25<br>column: 2012 Cultivation PR<br>value: 0.258621\",\"row: 25<br>column: 2012 Livestock PR<br>value: 0.655172\",\"row: 25<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 25<br>column: 2012 Others PR<br>value: 0.172414\"],[\"row: 48<br>column: 2012 Cultivation PR<br>value: 0.239975\",\"row: 48<br>column: 2012 Livestock PR<br>value: 0.723010\",\"row: 48<br>column: 2012 Fishing PR<br>value: 0.008727\",\"row: 48<br>column: 2012 Others PR<br>value: 0.057989\"],[\"row: 55<br>column: 2012 Cultivation PR<br>value: 0.216216\",\"row: 55<br>column: 2012 Livestock PR<br>value: 0.702703\",\"row: 55<br>column: 2012 Fishing PR<br>value: 0.088235\",\"row: 55<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 49<br>column: 2012 Cultivation PR<br>value: 0.294643\",\"row: 49<br>column: 2012 Livestock PR<br>value: 0.633929\",\"row: 49<br>column: 2012 Fishing PR<br>value: 0.068015\",\"row: 49<br>column: 2012 Others PR<br>value: 0.017857\"],[\"row: 44<br>column: 2012 Cultivation PR<br>value: 0.452954\",\"row: 44<br>column: 2012 Livestock PR<br>value: 0.547046\",\"row: 44<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 44<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 51<br>column: 2012 Cultivation PR<br>value: 0.536555\",\"row: 51<br>column: 2012 Livestock PR<br>value: 0.451053\",\"row: 51<br>column: 2012 Fishing PR<br>value: 0.013485\",\"row: 51<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 37<br>column: 2012 Cultivation PR<br>value: 0.564516\",\"row: 37<br>column: 2012 Livestock PR<br>value: 0.403226\",\"row: 37<br>column: 2012 Fishing PR<br>value: 0.017552\",\"row: 37<br>column: 2012 Others PR<br>value: 0.032258\"],[\"row: 57<br>column: 2012 Cultivation PR<br>value: 0.933450\",\"row: 57<br>column: 2012 Livestock PR<br>value: 0.014011\",\"row: 57<br>column: 2012 Fishing PR<br>value: 0.057175\",\"row: 57<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 45<br>column: 2012 Cultivation PR<br>value: 0.933625\",\"row: 45<br>column: 2012 Livestock PR<br>value: 0.064916\",\"row: 45<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 45<br>column: 2012 Others PR<br>value: 0.002918\"],[\"row: 46<br>column: 2012 Cultivation PR<br>value: 0.949341\",\"row: 46<br>column: 2012 Livestock PR<br>value: 0.042553\",\"row: 46<br>column: 2012 Fishing PR<br>value: 0.006615\",\"row: 46<br>column: 2012 Others PR<br>value: 0.004053\"],[\"row: 41<br>column: 2012 Cultivation PR<br>value: 0.960591\",\"row: 41<br>column: 2012 Livestock PR<br>value: 0.039409\",\"row: 41<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 41<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 40<br>column: 2012 Cultivation PR<br>value: 0.967213\",\"row: 40<br>column: 2012 Livestock PR<br>value: 0.032787\",\"row: 40<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 40<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 43<br>column: 2012 Cultivation PR<br>value: 0.982475\",\"row: 43<br>column: 2012 Livestock PR<br>value: 0.017525\",\"row: 43<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 43<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 12<br>column: 2012 Cultivation PR<br>value: 1.000000\",\"row: 12<br>column: 2012 Livestock PR<br>value: 0.000000\",\"row: 12<br>column: 2012 Fishing PR<br>value: 0.000000\",\"row: 12<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 58<br>column: 2012 Cultivation PR<br>value: 0.895833\",\"row: 58<br>column: 2012 Livestock PR<br>value: 0.013889\",\"row: 58<br>column: 2012 Fishing PR<br>value: 0.049122\",\"row: 58<br>column: 2012 Others PR<br>value: 0.090278\"],[\"row: 39<br>column: 2012 Cultivation PR<br>value: 0.877273\",\"row: 39<br>column: 2012 Livestock PR<br>value: 0.093182\",\"row: 39<br>column: 2012 Fishing PR<br>value: 0.032152\",\"row: 39<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 47<br>column: 2012 Cultivation PR<br>value: 0.701149\",\"row: 47<br>column: 2012 Livestock PR<br>value: 0.296198\",\"row: 47<br>column: 2012 Fishing PR<br>value: 0.001924\",\"row: 47<br>column: 2012 Others PR<br>value: 0.001768\"],[\"row: 42<br>column: 2012 Cultivation PR<br>value: 0.689003\",\"row: 42<br>column: 2012 Livestock PR<br>value: 0.276632\",\"row: 42<br>column: 2012 Fishing PR<br>value: 0.007479\",\"row: 42<br>column: 2012 Others PR<br>value: 0.054983\"],[\"row: 61<br>column: 2012 Cultivation PR<br>value: 0.655488\",\"row: 61<br>column: 2012 Livestock PR<br>value: 0.185976\",\"row: 61<br>column: 2012 Fishing PR<br>value: 0.172525\",\"row: 61<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 36<br>column: 2012 Cultivation PR<br>value: 0.718750\",\"row: 36<br>column: 2012 Livestock PR<br>value: 0.093750\",\"row: 36<br>column: 2012 Fishing PR<br>value: 0.187040\",\"row: 36<br>column: 2012 Others PR<br>value: 0.031250\"],[\"row: 56<br>column: 2012 Cultivation PR<br>value: 0.729258\",\"row: 56<br>column: 2012 Livestock PR<br>value: 0.052402\",\"row: 56<br>column: 2012 Fishing PR<br>value: 0.209093\",\"row: 56<br>column: 2012 Others PR<br>value: 0.052402\"],[\"row: 30<br>column: 2012 Cultivation PR<br>value: 0.541667\",\"row: 30<br>column: 2012 Livestock PR<br>value: 0.166667\",\"row: 30<br>column: 2012 Fishing PR<br>value: 0.226716\",\"row: 30<br>column: 2012 Others PR<br>value: 0.166667\"],[\"row: 54<br>column: 2012 Cultivation PR<br>value: 0.095238\",\"row: 54<br>column: 2012 Livestock PR<br>value: 0.158730\",\"row: 54<br>column: 2012 Fishing PR<br>value: 0.794585\",\"row: 54<br>column: 2012 Others PR<br>value: 0.031746\"],[\"row: 59<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 59<br>column: 2012 Livestock PR<br>value: 0.194444\",\"row: 59<br>column: 2012 Fishing PR<br>value: 0.876634\",\"row: 59<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 63<br>column: 2012 Cultivation PR<br>value: 0.000000\",\"row: 63<br>column: 2012 Livestock PR<br>value: 0.081081\",\"row: 63<br>column: 2012 Fishing PR<br>value: 1.000000\",\"row: 63<br>column: 2012 Others PR<br>value: 0.000000\"],[\"row: 62<br>column: 2012 Cultivation PR<br>value: 0.114795\",\"row: 62<br>column: 2012 Livestock PR<br>value: 0.005294\",\"row: 62<br>column: 2012 Fishing PR<br>value: 0.897210\",\"row: 62<br>column: 2012 Others PR<br>value: 0.110894\"]],\"colorscale\":[[0,\"#F7FBFF\"],[0.0017683465959328027,\"#F7FBFF\"],[0.0019243771779268734,\"#F7FBFF\"],[0.0023752969121140144,\"#F6FAFE\"],[0.0029175784099197666,\"#F6FAFE\"],[0.0040526849037487338,\"#F6FAFE\"],[0.004807692307692308,\"#F6FAFE\"],[0.0052939537475619946,\"#F6FAFE\"],[0.0054644808743169399,\"#F6FAFE\"],[0.0056657223796033997,\"#F6FAFE\"],[0.0059288537549407111,\"#F5F9FE\"],[0.0066154121222957267,\"#F5F9FE\"],[0.0066666666666666671,\"#F5F9FE\"],[0.0074792803719425909,\"#F5F9FE\"],[0.0078478506787330315,\"#F5F9FE\"],[0.0087273650977972919,\"#F5F9FE\"],[0.0089213300892133016,\"#F5F9FE\"],[0.0092484585902349627,\"#F5F9FE\"],[0.009433962264150943,\"#F5F9FE\"],[0.011331444759206799,\"#F4F9FE\"],[0.013484947882498726,\"#F4F9FE\"],[0.013888888888888888,\"#F3F8FD\"],[0.014010507880910683,\"#F3F8FD\"],[0.017524644030668127,\"#F3F8FD\"],[0.017552182163187855,\"#F3F8FD\"],[0.017857142857142856,\"#F3F8FD\"],[0.0234375,\"#F2F7FD\"],[0.025000000000000001,\"#F2F7FD\"],[0.027322404371584699,\"#F1F7FD\"],[0.028368794326241134,\"#F1F7FD\"],[0.029411764705882353,\"#F0F6FC\"],[0.03125,\"#F0F6FC\"],[0.031746031746031744,\"#F0F6FC\"],[0.032152406417112298,\"#F0F6FC\"],[0.032258064516129031,\"#F0F6FC\"],[0.032786885245901641,\"#F0F6FC\"],[0.033333333333333333,\"#F0F6FC\"],[0.034410602185538243,\"#EFF6FC\"],[0.034482758620689655,\"#EFF6FC\"],[0.035714285714285712,\"#EFF6FC\"],[0.036274509803921572,\"#EFF6FC\"],[0.036666666666666667,\"#EFF6FC\"],[0.038461538461538464,\"#EFF5FC\"],[0.039408866995073892,\"#EFF5FC\"],[0.042553191489361701,\"#EEF5FC\"],[0.043771043771043773,\"#EEF5FC\"],[0.046875,\"#EDF4FB\"],[0.047244094488188976,\"#EDF4FB\"],[0.047505938242280284,\"#EDF4FB\"],[0.049121732026143783,\"#ECF4FB\"],[0.050000000000000003,\"#ECF4FB\"],[0.052401746724890827,\"#ECF4FB\"],[0.054982817869415807,\"#ECF3FB\"],[0.055261948529411763,\"#ECF3FB\"],[0.057175234366951683,\"#EBF3FB\"],[0.057988895743368289,\"#EBF3FB\"],[0.058139534883720929,\"#EBF3FB\"],[0.064916119620714807,\"#E9F2FA\"],[0.068014705882352935,\"#E9F2FA\"],[0.069565217391304349,\"#E8F1FA\"],[0.070921985815602842,\"#E8F1FA\"],[0.07711903659101435,\"#E7F0F9\"],[0.081081081081081086,\"#E6F0F9\"],[0.088235294117647051,\"#E5EFF9\"],[0.089810017271157172,\"#E4EFF9\"],[0.090277777777777776,\"#E4EFF9\"],[0.090686274509803919,\"#E4EFF9\"],[0.093181818181818185,\"#E4EEF8\"],[0.09375,\"#E4EEF8\"],[0.094339622641509441,\"#E4EEF8\"],[0.095238095238095233,\"#E4EEF8\"],[0.098113207547169817,\"#E3EEF8\"],[0.099613938839784616,\"#E3EEF8\"],[0.11089439955419336,\"#E1ECF7\"],[0.11479520757871273,\"#E0ECF7\"],[0.11789215686274511,\"#DFEBF7\"],[0.13214285714285715,\"#DCE9F6\"],[0.13325330132052821,\"#DCE9F6\"],[0.13333333333333333,\"#DCE9F6\"],[0.13602941176470587,\"#DBE9F6\"],[0.14285714285714285,\"#DAE8F5\"],[0.15613810741687978,\"#D7E6F4\"],[0.15741768405475398,\"#D7E6F4\"],[0.15873015873015872,\"#D7E6F4\"],[0.16284756182758139,\"#D6E5F4\"],[0.16326530612244897,\"#D6E5F4\"],[0.1659271981298602,\"#D6E5F4\"],[0.16666666666666666,\"#D6E5F4\"],[0.17241379310344829,\"#D4E4F3\"],[0.17252510760401721,\"#D4E4F3\"],[0.1771545827633379,\"#D4E4F3\"],[0.18597560975609756,\"#D2E3F3\"],[0.18653690186536903,\"#D1E2F2\"],[0.18704044117647059,\"#D1E2F2\"],[0.1891891891891892,\"#D1E2F2\"],[0.19444444444444445,\"#D0E1F2\"],[0.20000000000000001,\"#CFE1F2\"],[0.2090932442846134,\"#CEE0F1\"],[0.21621621621621623,\"#CCDFF1\"],[0.2267156862745098,\"#CADDF0\"],[0.23450188156070506,\"#C8DCEF\"],[0.23997532387415177,\"#C8DCEF\"],[0.25,\"#C5DAEE\"],[0.25862068965517243,\"#C3D9EE\"],[0.2608695652173913,\"#C2D9ED\"],[0.26666666666666666,\"#C0D8ED\"],[0.2669256381798002,\"#C0D8ED\"],[0.26877470355731226,\"#BFD8EC\"],[0.26923076923076922,\"#BFD8EC\"],[0.2766323024054983,\"#BDD7EB\"],[0.29464285714285715,\"#B7D4EA\"],[0.29619805481874445,\"#B6D4E9\"],[0.29999999999999999,\"#B6D3E9\"],[0.31205673758865249,\"#B1D2E7\"],[0.31693989071038253,\"#B0D1E7\"],[0.36538461538461536,\"#A1CBE2\"],[0.37669683257918546,\"#9DC9E0\"],[0.38088235294117645,\"#9BC8E0\"],[0.39130434782608697,\"#97C6DF\"],[0.40000000000000002,\"#93C4DE\"],[0.40322580645161288,\"#92C3DE\"],[0.44166666666666665,\"#82BADB\"],[0.4510532837670384,\"#7FB8DA\"],[0.45295404814004375,\"#7EB8D9\"],[0.47826086956521741,\"#73B2D7\"],[0.5,\"#6BADD5\"],[0.50604490500863553,\"#69ACD5\"],[0.52500000000000002,\"#62A8D2\"],[0.53655514250309788,\"#5EA5D1\"],[0.54166666666666663,\"#5DA4D0\"],[0.54545454545454541,\"#5CA3D0\"],[0.54704595185995619,\"#5BA3D0\"],[0.55813953488372092,\"#58A1CE\"],[0.56451612903225812,\"#559FCD\"],[0.58039215686274515,\"#509BCB\"],[0.59999999999999998,\"#4A97C9\"],[0.61132075471698111,\"#4694C7\"],[0.61739130434782608,\"#4494C7\"],[0.62521588946459417,\"#4292C6\"],[0.6339285714285714,\"#3F8FC4\"],[0.65517241379310343,\"#3A8AC1\"],[0.65548780487804881,\"#3A8AC1\"],[0.67918231122236128,\"#3383BE\"],[0.68900343642611683,\"#3080BD\"],[0.69565217391304346,\"#2F7FBC\"],[0.70114942528735635,\"#2D7DBB\"],[0.70270270270270274,\"#2D7DBB\"],[0.71875,\"#2979B9\"],[0.72251687560270006,\"#2878B8\"],[0.7230104873534855,\"#2878B8\"],[0.72925764192139741,\"#2676B7\"],[0.73333333333333328,\"#2575B7\"],[0.7407407407407407,\"#2373B6\"],[0.74533657745336579,\"#2272B5\"],[0.7678571428571429,\"#1D6CB1\"],[0.79458450046685336,\"#1765AB\"],[0.79591836734693877,\"#1765AB\"],[0.80000000000000004,\"#1664AB\"],[0.82422802850356292,\"#125EA6\"],[0.82806324110671936,\"#115DA5\"],[0.84591194968553463,\"#0D58A1\"],[0.87663398692810457,\"#08509B\"],[0.87727272727272732,\"#08509B\"],[0.8783783783783784,\"#08509A\"],[0.87857142857142856,\"#08509A\"],[0.89583333333333337,\"#084B93\"],[0.89721043056397809,\"#084A92\"],[0.90000000000000002,\"#084991\"],[0.90234375,\"#084991\"],[0.90551181102362199,\"#08488F\"],[0.90909090909090906,\"#08478E\"],[0.91666666666666663,\"#08458B\"],[0.93345008756567427,\"#084185\"],[0.93362509117432535,\"#084185\"],[0.94934143870314081,\"#083D7E\"],[0.96059113300492616,\"#083A7A\"],[0.96551724137931039,\"#083978\"],[0.96721311475409832,\"#083877\"],[0.97733711048158645,\"#083674\"],[0.98247535596933189,\"#083471\"],[0.98798076923076927,\"#08336F\"],[1,\"#08306B\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[1],\"name\":\"f6800aefb6971c64525ddbccc2f60b48\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#F7FBFF\"],[0.0033444816053511705,\"#F6FAFE\"],[0.006688963210702341,\"#F5F9FE\"],[0.010033444816053512,\"#F4F9FE\"],[0.013377926421404682,\"#F4F9FE\"],[0.016722408026755852,\"#F3F8FD\"],[0.020066889632107024,\"#F3F8FD\"],[0.023411371237458192,\"#F2F7FD\"],[0.026755852842809364,\"#F1F7FD\"],[0.030100334448160536,\"#F0F6FC\"],[0.033444816053511704,\"#EFF6FC\"],[0.036789297658862873,\"#EFF6FC\"],[0.040133779264214048,\"#EFF5FC\"],[0.043478260869565216,\"#EEF5FC\"],[0.046822742474916385,\"#EDF4FB\"],[0.05016722408026756,\"#ECF4FB\"],[0.053511705685618728,\"#ECF3FB\"],[0.056856187290969896,\"#ECF3FB\"],[0.060200668896321072,\"#EBF3FB\"],[0.06354515050167224,\"#EAF2FA\"],[0.066889632107023408,\"#E9F2FA\"],[0.070234113712374577,\"#E8F1FA\"],[0.073578595317725745,\"#E8F1FA\"],[0.076923076923076927,\"#E7F0F9\"],[0.080267558528428096,\"#E7F0F9\"],[0.083612040133779264,\"#E6F0F9\"],[0.086956521739130432,\"#E5EFF9\"],[0.090301003344481601,\"#E4EFF9\"],[0.093645484949832769,\"#E4EEF8\"],[0.096989966555183951,\"#E3EEF8\"],[0.10033444816053512,\"#E2EDF8\"],[0.10367892976588629,\"#E2EDF8\"],[0.10702341137123746,\"#E1EDF8\"],[0.11036789297658862,\"#E1ECF7\"],[0.11371237458193979,\"#E0ECF7\"],[0.11705685618729096,\"#DFEBF7\"],[0.12040133779264214,\"#DEEBF7\"],[0.12374581939799331,\"#DDEAF6\"],[0.12709030100334448,\"#DDEAF6\"],[0.13043478260869565,\"#DDEAF6\"],[0.13377926421404682,\"#DCE9F6\"],[0.13712374581939799,\"#DBE9F6\"],[0.14046822742474915,\"#DAE8F5\"],[0.14381270903010032,\"#DAE8F5\"],[0.14715719063545149,\"#D9E7F5\"],[0.15050167224080269,\"#D9E7F5\"],[0.15384615384615385,\"#D8E7F5\"],[0.15719063545150502,\"#D7E6F4\"],[0.16053511705685619,\"#D7E6F4\"],[0.16387959866220736,\"#D6E5F4\"],[0.16722408026755853,\"#D5E5F4\"],[0.1705685618729097,\"#D5E5F4\"],[0.17391304347826086,\"#D4E4F3\"],[0.17725752508361203,\"#D4E4F3\"],[0.1806020066889632,\"#D3E3F3\"],[0.18394648829431437,\"#D2E3F3\"],[0.18729096989966554,\"#D1E2F2\"],[0.19063545150501671,\"#D1E2F2\"],[0.1939799331103679,\"#D1E2F2\"],[0.19732441471571907,\"#D0E1F2\"],[0.20066889632107024,\"#CFE1F2\"],[0.20401337792642141,\"#CEE0F1\"],[0.20735785953177258,\"#CEE0F1\"],[0.21070234113712374,\"#CDDFF1\"],[0.21404682274247491,\"#CCDFF1\"],[0.21739130434782608,\"#CCDFF1\"],[0.22073578595317725,\"#CBDEF0\"],[0.22408026755852842,\"#CBDEF0\"],[0.22742474916387959,\"#CADDF0\"],[0.23076923076923075,\"#C9DDF0\"],[0.23411371237458192,\"#C8DCEF\"],[0.23745819397993312,\"#C8DCEF\"],[0.24080267558528429,\"#C8DCEF\"],[0.24414715719063546,\"#C7DBEF\"],[0.24749163879598662,\"#C6DBEF\"],[0.25083612040133779,\"#C5DAEE\"],[0.25418060200668896,\"#C4DAEE\"],[0.25752508361204013,\"#C3D9EE\"],[0.2608695652173913,\"#C2D9ED\"],[0.26421404682274247,\"#C1D9ED\"],[0.26755852842809363,\"#C0D8ED\"],[0.2709030100334448,\"#BFD8EC\"],[0.27424749163879597,\"#BED7EC\"],[0.27759197324414714,\"#BCD7EB\"],[0.28093645484949831,\"#BBD6EB\"],[0.28428093645484948,\"#BBD6EB\"],[0.28762541806020064,\"#BAD6EA\"],[0.29096989966555181,\"#B9D5EA\"],[0.29431438127090298,\"#B7D4EA\"],[0.29765886287625415,\"#B6D4E9\"],[0.30100334448160537,\"#B5D3E9\"],[0.30434782608695654,\"#B4D3E8\"],[0.30769230769230771,\"#B3D3E8\"],[0.31103678929765888,\"#B2D2E8\"],[0.31438127090301005,\"#B1D2E7\"],[0.31772575250836121,\"#B0D1E7\"],[0.32107023411371238,\"#AFD1E6\"],[0.32441471571906355,\"#AED0E6\"],[0.32775919732441472,\"#ACD0E6\"],[0.33110367892976589,\"#ACD0E6\"],[0.33444816053511706,\"#ABCFE5\"],[0.33779264214046822,\"#AACFE5\"],[0.34113712374581939,\"#A8CEE4\"],[0.34448160535117056,\"#A7CEE4\"],[0.34782608695652173,\"#A6CDE3\"],[0.3511705685618729,\"#A5CDE3\"],[0.35451505016722407,\"#A4CDE3\"],[0.35785953177257523,\"#A3CCE3\"],[0.3612040133779264,\"#A2CBE2\"],[0.36454849498327757,\"#A1CBE2\"],[0.36789297658862874,\"#A0CAE1\"],[0.37123745819397991,\"#9FCAE1\"],[0.37458193979933108,\"#9DC9E0\"],[0.37792642140468224,\"#9CC9E0\"],[0.38127090301003341,\"#9BC8E0\"],[0.38461538461538458,\"#9AC7E0\"],[0.38795986622073581,\"#98C7DF\"],[0.39130434782608697,\"#97C6DF\"],[0.39464882943143814,\"#96C5DF\"],[0.39799331103678931,\"#94C5DF\"],[0.40133779264214048,\"#93C4DE\"],[0.40468227424749165,\"#92C3DE\"],[0.40802675585284282,\"#90C2DE\"],[0.41137123745819398,\"#8FC1DD\"],[0.41471571906354515,\"#8DC0DD\"],[0.41806020066889632,\"#8CC0DD\"],[0.42140468227424749,\"#8BC0DD\"],[0.42474916387959866,\"#89BFDC\"],[0.42809364548494983,\"#88BEDC\"],[0.43143812709030099,\"#87BDDC\"],[0.43478260869565216,\"#85BCDB\"],[0.43812709030100333,\"#84BBDB\"],[0.4414715719063545,\"#82BADB\"],[0.44481605351170567,\"#81BADB\"],[0.44816053511705684,\"#80B9DA\"],[0.451505016722408,\"#7FB8DA\"],[0.45484949832775917,\"#7DB8D9\"],[0.45819397993311034,\"#7BB7D9\"],[0.46153846153846151,\"#7AB6D9\"],[0.46488294314381268,\"#79B5D8\"],[0.46822742474916385,\"#78B5D8\"],[0.47157190635451507,\"#77B4D8\"],[0.47491638795986624,\"#75B3D8\"],[0.47826086956521741,\"#73B2D7\"],[0.48160535117056857,\"#72B1D7\"],[0.48494983277591974,\"#71B1D7\"],[0.48829431438127091,\"#6FB0D6\"],[0.49163879598662208,\"#6EB0D6\"],[0.49498327759197325,\"#6DAFD6\"],[0.49832775919732442,\"#6BAED6\"],[0.50167224080267558,\"#6AADD5\"],[0.50501672240802675,\"#69ACD5\"],[0.50836120401337792,\"#68ABD4\"],[0.51170568561872909,\"#67ABD4\"],[0.51505016722408026,\"#66AAD4\"],[0.51839464882943143,\"#65AAD3\"],[0.52173913043478259,\"#63A9D3\"],[0.52508361204013376,\"#62A8D2\"],[0.52842809364548493,\"#61A7D2\"],[0.5317725752508361,\"#60A6D1\"],[0.53511705685618727,\"#5FA6D1\"],[0.53846153846153844,\"#5EA5D1\"],[0.5418060200668896,\"#5DA4D0\"],[0.54515050167224077,\"#5CA3D0\"],[0.54849498327759194,\"#5AA3CF\"],[0.55183946488294311,\"#59A2CF\"],[0.55518394648829428,\"#58A1CE\"],[0.55852842809364545,\"#58A1CE\"],[0.56187290969899661,\"#56A0CE\"],[0.56521739130434778,\"#559FCD\"],[0.56856187290969895,\"#549ECD\"],[0.57190635451505012,\"#539DCC\"],[0.57525083612040129,\"#529CCC\"],[0.57859531772575246,\"#509BCB\"],[0.58193979933110362,\"#509BCB\"],[0.58528428093645479,\"#4F9BCB\"],[0.58862876254180596,\"#4E9ACA\"],[0.59197324414715713,\"#4C99CA\"],[0.5953177257525083,\"#4B98C9\"],[0.59866220735785947,\"#4A97C9\"],[0.60200668896321075,\"#4996C8\"],[0.60535117056856191,\"#4896C8\"],[0.60869565217391308,\"#4795C8\"],[0.61204013377926425,\"#4694C7\"],[0.61538461538461542,\"#4594C7\"],[0.61872909698996659,\"#4393C6\"],[0.62207357859531776,\"#4292C6\"],[0.62541806020066892,\"#4292C6\"],[0.62876254180602009,\"#4191C5\"],[0.63210702341137126,\"#4090C5\"],[0.63545150501672243,\"#3F8FC4\"],[0.6387959866220736,\"#3E8EC4\"],[0.64214046822742477,\"#3D8DC3\"],[0.64548494983277593,\"#3C8CC3\"],[0.6488294314381271,\"#3C8CC3\"],[0.65217391304347827,\"#3B8BC2\"],[0.65551839464882944,\"#3A8AC1\"],[0.65886287625418061,\"#3989C1\"],[0.66220735785953178,\"#3888C0\"],[0.66555183946488294,\"#3787C0\"],[0.66889632107023411,\"#3686BF\"],[0.67224080267558528,\"#3585BF\"],[0.67558528428093645,\"#3484BF\"],[0.67892976588628762,\"#3383BE\"],[0.68227424749163879,\"#3282BE\"],[0.68561872909698995,\"#3181BD\"],[0.68896321070234112,\"#3080BD\"],[0.69230769230769229,\"#2F7FBC\"],[0.69565217391304346,\"#2F7FBC\"],[0.69899665551839463,\"#2E7EBC\"],[0.7023411371237458,\"#2D7DBB\"],[0.70568561872909696,\"#2C7CBB\"],[0.70903010033444813,\"#2B7BBA\"],[0.7123745819397993,\"#2A7AB9\"],[0.71571906354515047,\"#2979B9\"],[0.71906354515050164,\"#2979B9\"],[0.72240802675585281,\"#2878B8\"],[0.72575250836120397,\"#2777B8\"],[0.72909698996655514,\"#2676B7\"],[0.73244147157190631,\"#2575B7\"],[0.73578595317725748,\"#2474B6\"],[0.73913043478260865,\"#2474B6\"],[0.74247491638795982,\"#2373B6\"],[0.74581939799331098,\"#2272B5\"],[0.74916387959866215,\"#2171B5\"],[0.75250836120401332,\"#2070B4\"],[0.75585284280936449,\"#1F6FB3\"],[0.75919732441471566,\"#1E6EB2\"],[0.76254180602006683,\"#1E6EB2\"],[0.76588628762541799,\"#1E6DB2\"],[0.76923076923076916,\"#1D6CB1\"],[0.77257525083612044,\"#1C6BB0\"],[0.77591973244147161,\"#1B6AAF\"],[0.77926421404682278,\"#1A69AE\"],[0.78260869565217395,\"#1A68AE\"],[0.78595317725752512,\"#1A68AE\"],[0.78929765886287628,\"#1967AD\"],[0.79264214046822745,\"#1866AC\"],[0.79598662207357862,\"#1765AB\"],[0.79933110367892979,\"#1664AB\"],[0.80267558528428096,\"#1663AA\"],[0.80602006688963213,\"#1562A9\"],[0.80936454849498329,\"#1562A9\"],[0.81270903010033446,\"#1461A8\"],[0.81605351170568563,\"#1360A7\"],[0.8193979933110368,\"#135FA7\"],[0.82274247491638797,\"#125EA6\"],[0.82608695652173914,\"#115DA5\"],[0.8294314381270903,\"#105CA4\"],[0.83277591973244147,\"#105CA4\"],[0.83612040133779264,\"#0F5BA3\"],[0.83946488294314381,\"#0F5AA3\"],[0.84280936454849498,\"#0E59A2\"],[0.84615384615384615,\"#0D58A1\"],[0.84949832775919731,\"#0C57A0\"],[0.85284280936454848,\"#0C57A0\"],[0.85618729096989965,\"#0C56A0\"],[0.85953177257525082,\"#0B559F\"],[0.86287625418060199,\"#0A549E\"],[0.86622073578595316,\"#09539D\"],[0.86956521739130432,\"#08529C\"],[0.87290969899665549,\"#08519C\"],[0.87625418060200666,\"#08519B\"],[0.87959866220735783,\"#08509A\"],[0.882943143812709,\"#084F99\"],[0.88628762541806017,\"#084E97\"],[0.88963210702341133,\"#084C96\"],[0.8929765886287625,\"#084B95\"],[0.89632107023411367,\"#084A93\"],[0.89966555183946484,\"#084A92\"],[0.90301003344481601,\"#084990\"],[0.90635451505016718,\"#08488F\"],[0.90969899665551834,\"#08478E\"],[0.91304347826086951,\"#08468C\"],[0.91638795986622068,\"#08458B\"],[0.91973244147157185,\"#08448A\"],[0.92307692307692302,\"#084489\"],[0.92642140468227419,\"#084388\"],[0.92976588628762535,\"#084286\"],[0.93311036789297652,\"#084185\"],[0.93645484949832769,\"#084083\"],[0.93979933110367886,\"#083F82\"],[0.94314381270903014,\"#083E81\"],[0.94648829431438131,\"#083E7F\"],[0.94983277591973247,\"#083D7E\"],[0.95317725752508364,\"#083C7D\"],[0.95652173913043481,\"#083B7B\"],[0.95986622073578598,\"#083A7A\"],[0.96321070234113715,\"#083979\"],[0.96655518394648832,\"#083978\"],[0.96989966555183948,\"#083876\"],[0.97324414715719065,\"#083775\"],[0.97658862876254182,\"#083674\"],[0.97993311036789299,\"#083572\"],[0.98327759197324416,\"#083471\"],[0.98662207357859533,\"#083370\"],[0.98996655518394649,\"#08336F\"],[0.99331103678929766,\"#08326D\"],[0.99665551839464883,\"#08316C\"],[1,\"#08306B\"]],\"colorbar\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"thickness\":23.039999999999996,\"title\":null,\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"ticklen\":2,\"len\":0.5}},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[0.9038714423526949,0.9038714423526949,null,0.9038714423526949,0.76404921295863792,null,0.76404921295863792,0.76404921295863792,null,0.76404921295863792,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0.76404921295863792,0.76404921295863792,null,0.76404921295863792,0.46587114709728672,null,0.46587114709728672,0.46587114709728672,null,0.46587114709728672,0.20388538670491194,null,0.20388538670491194,0.20388538670491194,null,0.20388538670491194,0,null,0.20388538670491194,0.20388538670491194,null,0.20388538670491194,0.1266873052265442,null,0.1266873052265442,0.1266873052265442,null,0.1266873052265442,0.10325271967693948,null,0.10325271967693948,0.10325271967693948,null,0.10325271967693948,0,null,0.10325271967693948,0.10325271967693948,null,0.10325271967693948,0,null,0.1266873052265442,0.1266873052265442,null,0.1266873052265442,0,null,0.46587114709728672,0.46587114709728672,null,0.46587114709728672,0.18568520119625709,null,0.18568520119625709,0.18568520119625709,null,0.18568520119625709,0,null,0.18568520119625709,0.18568520119625709,null,0.18568520119625709,0.064237134704640889,null,0.064237134704640889,0.064237134704640889,null,0.064237134704640889,0,null,0.064237134704640889,0.064237134704640889,null,0.064237134704640889,0],\"y\":[35.390625,38.71875,null,38.71875,38.71875,null,38.71875,36.5,null,36.5,36.5,null,36.5,36,null,36,36,null,36.5,37,null,37,37,null,38.71875,40.9375,null,40.9375,40.9375,null,40.9375,39.125,null,39.125,39.125,null,39.125,38,null,38,38,null,39.125,40.25,null,40.25,40.25,null,40.25,39.5,null,39.5,39.5,null,39.5,39,null,39,39,null,39.5,40,null,40,40,null,40.25,41,null,41,41,null,40.9375,42.75,null,42.75,42.75,null,42.75,42,null,42,42,null,42.75,43.5,null,43.5,43.5,null,43.5,43,null,43,43,null,43.5,44,null,44,44],\"text\":[\"y: 0.903871442\",\"y: 0.903871442\",null,\"y: 0.903871442\",\"y: 0.903871442\",null,\"y: 0.764049213\",\"y: 0.764049213\",null,\"y: 0.764049213\",\"y: 0.764049213\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.764049213\",\"y: 0.764049213\",null,\"y: 0.764049213\",\"y: 0.764049213\",null,\"y: 0.465871147\",\"y: 0.465871147\",null,\"y: 0.465871147\",\"y: 0.465871147\",null,\"y: 0.203885387\",\"y: 0.203885387\",null,\"y: 0.203885387\",\"y: 0.203885387\",null,\"y: 0.203885387\",\"y: 0.203885387\",null,\"y: 0.203885387\",\"y: 0.203885387\",null,\"y: 0.126687305\",\"y: 0.126687305\",null,\"y: 0.126687305\",\"y: 0.126687305\",null,\"y: 0.103252720\",\"y: 0.103252720\",null,\"y: 0.103252720\",\"y: 0.103252720\",null,\"y: 0.103252720\",\"y: 0.103252720\",null,\"y: 0.103252720\",\"y: 0.103252720\",null,\"y: 0.126687305\",\"y: 0.126687305\",null,\"y: 0.126687305\",\"y: 0.126687305\",null,\"y: 0.465871147\",\"y: 0.465871147\",null,\"y: 0.465871147\",\"y: 0.465871147\",null,\"y: 0.185685201\",\"y: 0.185685201\",null,\"y: 0.185685201\",\"y: 0.185685201\",null,\"y: 0.185685201\",\"y: 0.185685201\",null,\"y: 0.185685201\",\"y: 0.185685201\",null,\"y: 0.064237135\",\"y: 0.064237135\",null,\"y: 0.064237135\",\"y: 0.064237135\",null,\"y: 0.064237135\",\"y: 0.064237135\",null,\"y: 0.064237135\",\"y: 0.064237135\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(57,190,177,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.4165359655544496,1.4165359655544496,null,1.4165359655544496,0.56304973350754906,null,0.56304973350754906,0.56304973350754906,null,0.56304973350754906,0.15741223570343874,null,0.15741223570343874,0.15741223570343874,null,0.15741223570343874,0.092888338191646033,null,0.092888338191646033,0.092888338191646033,null,0.092888338191646033,0.076608952620177542,null,0.076608952620177542,0.076608952620177542,null,0.076608952620177542,0,null,0.076608952620177542,0.076608952620177542,null,0.076608952620177542,0.046572044117529257,null,0.046572044117529257,0.046572044117529257,null,0.046572044117529257,0,null,0.046572044117529257,0.046572044117529257,null,0.046572044117529257,0.021793702645220837,null,0.021793702645220837,0.021793702645220837,null,0.021793702645220837,0,null,0.021793702645220837,0.021793702645220837,null,0.021793702645220837,0.0093648963994664505,null,0.0093648963994664505,0.0093648963994664505,null,0.0093648963994664505,0,null,0.0093648963994664505,0.0093648963994664505,null,0.0093648963994664505,0,null,0.092888338191646033,0.092888338191646033,null,0.092888338191646033,0.024783589263931555,null,0.024783589263931555,0.024783589263931555,null,0.024783589263931555,0,null,0.024783589263931555,0.024783589263931555,null,0.024783589263931555,0,null,0.15741223570343874,0.15741223570343874,null,0.15741223570343874,0.12275952063000919,null,0.12275952063000919,0.12275952063000919,null,0.12275952063000919,0,null,0.12275952063000919,0.12275952063000919,null,0.12275952063000919,0,null,0.56304973350754906,0.56304973350754906,null,0.56304973350754906,0.34631736806197733,null,0.34631736806197733,0.34631736806197733,null,0.34631736806197733,0.058249297123012876,null,0.058249297123012876,0.058249297123012876,null,0.058249297123012876,0,null,0.058249297123012876,0.058249297123012876,null,0.058249297123012876,0,null,0.34631736806197733,0.34631736806197733,null,0.34631736806197733,0.2482214098689095,null,0.2482214098689095,0.2482214098689095,null,0.2482214098689095,0.16543015874559316,null,0.16543015874559316,0.16543015874559316,null,0.16543015874559316,0,null,0.16543015874559316,0.16543015874559316,null,0.16543015874559316,0.052476767260296507,null,0.052476767260296507,0.052476767260296507,null,0.052476767260296507,0,null,0.052476767260296507,0.052476767260296507,null,0.052476767260296507,0,null,0.2482214098689095,0.2482214098689095,null,0.2482214098689095,0],\"y\":[57.38671875,53.2734375,null,53.2734375,53.2734375,null,53.2734375,50.359375,null,50.359375,50.359375,null,50.359375,48.21875,null,48.21875,48.21875,null,48.21875,45.9375,null,45.9375,45.9375,null,45.9375,45,null,45,45,null,45.9375,46.875,null,46.875,46.875,null,46.875,46,null,46,46,null,46.875,47.75,null,47.75,47.75,null,47.75,47,null,47,47,null,47.75,48.5,null,48.5,48.5,null,48.5,48,null,48,48,null,48.5,49,null,49,49,null,48.21875,50.5,null,50.5,50.5,null,50.5,50,null,50,50,null,50.5,51,null,51,51,null,50.359375,52.5,null,52.5,52.5,null,52.5,52,null,52,52,null,52.5,53,null,53,53,null,53.2734375,56.1875,null,56.1875,56.1875,null,56.1875,54.5,null,54.5,54.5,null,54.5,54,null,54,54,null,54.5,55,null,55,55,null,56.1875,57.875,null,57.875,57.875,null,57.875,56.75,null,56.75,56.75,null,56.75,56,null,56,56,null,56.75,57.5,null,57.5,57.5,null,57.5,57,null,57,57,null,57.5,58,null,58,58,null,57.875,59,null,59,59],\"text\":[\"y: 1.416535966\",\"y: 1.416535966\",null,\"y: 1.416535966\",\"y: 1.416535966\",null,\"y: 0.563049734\",\"y: 0.563049734\",null,\"y: 0.563049734\",\"y: 0.563049734\",null,\"y: 0.157412236\",\"y: 0.157412236\",null,\"y: 0.157412236\",\"y: 0.157412236\",null,\"y: 0.092888338\",\"y: 0.092888338\",null,\"y: 0.092888338\",\"y: 0.092888338\",null,\"y: 0.076608953\",\"y: 0.076608953\",null,\"y: 0.076608953\",\"y: 0.076608953\",null,\"y: 0.076608953\",\"y: 0.076608953\",null,\"y: 0.076608953\",\"y: 0.076608953\",null,\"y: 0.046572044\",\"y: 0.046572044\",null,\"y: 0.046572044\",\"y: 0.046572044\",null,\"y: 0.046572044\",\"y: 0.046572044\",null,\"y: 0.046572044\",\"y: 0.046572044\",null,\"y: 0.021793703\",\"y: 0.021793703\",null,\"y: 0.021793703\",\"y: 0.021793703\",null,\"y: 0.021793703\",\"y: 0.021793703\",null,\"y: 0.021793703\",\"y: 0.021793703\",null,\"y: 0.009364896\",\"y: 0.009364896\",null,\"y: 0.009364896\",\"y: 0.009364896\",null,\"y: 0.009364896\",\"y: 0.009364896\",null,\"y: 0.009364896\",\"y: 0.009364896\",null,\"y: 0.092888338\",\"y: 0.092888338\",null,\"y: 0.092888338\",\"y: 0.092888338\",null,\"y: 0.024783589\",\"y: 0.024783589\",null,\"y: 0.024783589\",\"y: 0.024783589\",null,\"y: 0.024783589\",\"y: 0.024783589\",null,\"y: 0.024783589\",\"y: 0.024783589\",null,\"y: 0.157412236\",\"y: 0.157412236\",null,\"y: 0.157412236\",\"y: 0.157412236\",null,\"y: 0.122759521\",\"y: 0.122759521\",null,\"y: 0.122759521\",\"y: 0.122759521\",null,\"y: 0.122759521\",\"y: 0.122759521\",null,\"y: 0.122759521\",\"y: 0.122759521\",null,\"y: 0.563049734\",\"y: 0.563049734\",null,\"y: 0.563049734\",\"y: 0.563049734\",null,\"y: 0.346317368\",\"y: 0.346317368\",null,\"y: 0.346317368\",\"y: 0.346317368\",null,\"y: 0.058249297\",\"y: 0.058249297\",null,\"y: 0.058249297\",\"y: 0.058249297\",null,\"y: 0.058249297\",\"y: 0.058249297\",null,\"y: 0.058249297\",\"y: 0.058249297\",null,\"y: 0.346317368\",\"y: 0.346317368\",null,\"y: 0.346317368\",\"y: 0.346317368\",null,\"y: 0.248221410\",\"y: 0.248221410\",null,\"y: 0.248221410\",\"y: 0.248221410\",null,\"y: 0.165430159\",\"y: 0.165430159\",null,\"y: 0.165430159\",\"y: 0.165430159\",null,\"y: 0.165430159\",\"y: 0.165430159\",null,\"y: 0.165430159\",\"y: 0.165430159\",null,\"y: 0.052476767\",\"y: 0.052476767\",null,\"y: 0.052476767\",\"y: 0.052476767\",null,\"y: 0.052476767\",\"y: 0.052476767\",null,\"y: 0.052476767\",\"y: 0.052476767\",null,\"y: 0.248221410\",\"y: 0.248221410\",null,\"y: 0.248221410\",\"y: 0.248221410\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(125,176,221,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[0.9038714423526949,0.9038714423526949,null,0.9038714423526949,0.64805840897087963,null,0.64805840897087963,0.64805840897087963,null,0.64805840897087963,0.36385053784450988,null,0.36385053784450988,0.36385053784450988,null,0.36385053784450988,0.17315950866139859,null,0.17315950866139859,0.17315950866139859,null,0.17315950866139859,0,null,0.17315950866139859,0.17315950866139859,null,0.17315950866139859,0,null,0.36385053784450988,0.36385053784450988,null,0.36385053784450988,0,null,0.64805840897087963,0.64805840897087963,null,0.64805840897087963,0.50153189924802111,null,0.50153189924802111,0.50153189924802111,null,0.50153189924802111,0.18932766518889679,null,0.18932766518889679,0.18932766518889679,null,0.18932766518889679,0,null,0.18932766518889679,0.18932766518889679,null,0.18932766518889679,0.065781917965665571,null,0.065781917965665571,0.065781917965665571,null,0.065781917965665571,0,null,0.065781917965665571,0.065781917965665571,null,0.065781917965665571,0,null,0.50153189924802111,0.50153189924802111,null,0.50153189924802111,0],\"y\":[35.390625,32.0625,null,32.0625,32.0625,null,32.0625,30.25,null,30.25,30.25,null,30.25,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.25,31,null,31,31,null,32.0625,33.875,null,33.875,33.875,null,33.875,32.75,null,32.75,32.75,null,32.75,32,null,32,32,null,32.75,33.5,null,33.5,33.5,null,33.5,33,null,33,33,null,33.5,34,null,34,34,null,33.875,35,null,35,35],\"text\":[\"y: 0.903871442\",\"y: 0.903871442\",null,\"y: 0.903871442\",\"y: 0.903871442\",null,\"y: 0.648058409\",\"y: 0.648058409\",null,\"y: 0.648058409\",\"y: 0.648058409\",null,\"y: 0.363850538\",\"y: 0.363850538\",null,\"y: 0.363850538\",\"y: 0.363850538\",null,\"y: 0.173159509\",\"y: 0.173159509\",null,\"y: 0.173159509\",\"y: 0.173159509\",null,\"y: 0.173159509\",\"y: 0.173159509\",null,\"y: 0.173159509\",\"y: 0.173159509\",null,\"y: 0.363850538\",\"y: 0.363850538\",null,\"y: 0.363850538\",\"y: 0.363850538\",null,\"y: 0.648058409\",\"y: 0.648058409\",null,\"y: 0.648058409\",\"y: 0.648058409\",null,\"y: 0.501531899\",\"y: 0.501531899\",null,\"y: 0.501531899\",\"y: 0.501531899\",null,\"y: 0.189327665\",\"y: 0.189327665\",null,\"y: 0.189327665\",\"y: 0.189327665\",null,\"y: 0.189327665\",\"y: 0.189327665\",null,\"y: 0.189327665\",\"y: 0.189327665\",null,\"y: 0.065781918\",\"y: 0.065781918\",null,\"y: 0.065781918\",\"y: 0.065781918\",null,\"y: 0.065781918\",\"y: 0.065781918\",null,\"y: 0.065781918\",\"y: 0.065781918\",null,\"y: 0.501531899\",\"y: 0.501531899\",null,\"y: 0.501531899\",\"y: 0.501531899\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(134,184,117,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,1,null,1,0.39591133208329909,null,0.39591133208329909,0.39591133208329909,null,0.39591133208329909,0.24397450819655347,null,0.24397450819655347,0.24397450819655347,null,0.24397450819655347,0.13024763930192124,null,0.13024763930192124,0.13024763930192124,null,0.13024763930192124,0,null,0.13024763930192124,0.13024763930192124,null,0.13024763930192124,0.065170992784574291,null,0.065170992784574291,0.065170992784574291,null,0.065170992784574291,0,null,0.065170992784574291,0.065170992784574291,null,0.065170992784574291,0.049871258666791374,null,0.049871258666791374,0.049871258666791374,null,0.049871258666791374,0,null,0.049871258666791374,0.049871258666791374,null,0.049871258666791374,0,null,0.24397450819655347,0.24397450819655347,null,0.24397450819655347,0.19507833184532708,null,0.19507833184532708,0.19507833184532708,null,0.19507833184532708,0.069920813163695125,null,0.069920813163695125,0.069920813163695125,null,0.069920813163695125,0,null,0.069920813163695125,0.069920813163695125,null,0.069920813163695125,0,null,0.19507833184532708,0.19507833184532708,null,0.19507833184532708,0.074589102214492581,null,0.074589102214492581,0.074589102214492581,null,0.074589102214492581,0,null,0.074589102214492581,0.074589102214492581,null,0.074589102214492581,0,null,0.39591133208329909,0.39591133208329909,null,0.39591133208329909,0.24428993135336602,null,0.24428993135336602,0.24428993135336602,null,0.24428993135336602,0.13079513800126846,null,0.13079513800126846,0.13079513800126846,null,0.13079513800126846,0.04876598490941704,null,0.04876598490941704,0.04876598490941704,null,0.04876598490941704,0.027561614575942459,null,0.027561614575942459,0.027561614575942459,null,0.027561614575942459,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0.027561614575942459,0.027561614575942459,null,0.027561614575942459,0.013780744908102686,null,0.013780744908102686,0.013780744908102686,null,0.013780744908102686,0,null,0.013780744908102686,0.013780744908102686,null,0.013780744908102686,0,null,0.04876598490941704,0.04876598490941704,null,0.04876598490941704,0,null,0.13079513800126846,0.13079513800126846,null,0.13079513800126846,0.064858390700474236,null,0.064858390700474236,0.064858390700474236,null,0.064858390700474236,0.032205924085069421,null,0.032205924085069421,0.032205924085069421,null,0.032205924085069421,0,null,0.032205924085069421,0.032205924085069421,null,0.032205924085069421,0,null,0.064858390700474236,0.064858390700474236,null,0.064858390700474236,0,null,0.24428993135336602,0.24428993135336602,null,0.24428993135336602,0.078475730161702048,null,0.078475730161702048,0.078475730161702048,null,0.078475730161702048,0.042361044374825324,null,0.042361044374825324,0.042361044374825324,null,0.042361044374825324,0,null,0.042361044374825324,0.042361044374825324,null,0.042361044374825324,0,null,0.078475730161702048,0.078475730161702048,null,0.078475730161702048,0],\"y\":[27.2109375,19.03125,null,19.03125,19.03125,null,19.03125,13.1875,null,13.1875,13.1875,null,13.1875,10.875,null,10.875,10.875,null,10.875,10,null,10,10,null,10.875,11.75,null,11.75,11.75,null,11.75,11,null,11,11,null,11.75,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13,null,13.1875,15.5,null,15.5,15.5,null,15.5,14.5,null,14.5,14.5,null,14.5,14,null,14,14,null,14.5,15,null,15,15,null,15.5,16.5,null,16.5,16.5,null,16.5,16,null,16,16,null,16.5,17,null,17,17,null,19.03125,24.875,null,24.875,24.875,null,24.875,22.5,null,22.5,22.5,null,22.5,20.75,null,20.75,20.75,null,20.75,19.5,null,19.5,19.5,null,19.5,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.5,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,20.75,22,null,22,22,null,22.5,24.25,null,24.25,24.25,null,24.25,23.5,null,23.5,23.5,null,23.5,23,null,23,23,null,23.5,24,null,24,24,null,24.25,25,null,25,25,null,24.875,27.25,null,27.25,27.25,null,27.25,26.5,null,26.5,26.5,null,26.5,26,null,26,26,null,26.5,27,null,27,27,null,27.25,28,null,28,28],\"text\":[\"y: 1.000000000\",\"y: 1.000000000\",null,\"y: 1.000000000\",\"y: 1.000000000\",null,\"y: 0.395911332\",\"y: 0.395911332\",null,\"y: 0.395911332\",\"y: 0.395911332\",null,\"y: 0.243974508\",\"y: 0.243974508\",null,\"y: 0.243974508\",\"y: 0.243974508\",null,\"y: 0.130247639\",\"y: 0.130247639\",null,\"y: 0.130247639\",\"y: 0.130247639\",null,\"y: 0.130247639\",\"y: 0.130247639\",null,\"y: 0.130247639\",\"y: 0.130247639\",null,\"y: 0.065170993\",\"y: 0.065170993\",null,\"y: 0.065170993\",\"y: 0.065170993\",null,\"y: 0.065170993\",\"y: 0.065170993\",null,\"y: 0.065170993\",\"y: 0.065170993\",null,\"y: 0.049871259\",\"y: 0.049871259\",null,\"y: 0.049871259\",\"y: 0.049871259\",null,\"y: 0.049871259\",\"y: 0.049871259\",null,\"y: 0.049871259\",\"y: 0.049871259\",null,\"y: 0.243974508\",\"y: 0.243974508\",null,\"y: 0.243974508\",\"y: 0.243974508\",null,\"y: 0.195078332\",\"y: 0.195078332\",null,\"y: 0.195078332\",\"y: 0.195078332\",null,\"y: 0.069920813\",\"y: 0.069920813\",null,\"y: 0.069920813\",\"y: 0.069920813\",null,\"y: 0.069920813\",\"y: 0.069920813\",null,\"y: 0.069920813\",\"y: 0.069920813\",null,\"y: 0.195078332\",\"y: 0.195078332\",null,\"y: 0.195078332\",\"y: 0.195078332\",null,\"y: 0.074589102\",\"y: 0.074589102\",null,\"y: 0.074589102\",\"y: 0.074589102\",null,\"y: 0.074589102\",\"y: 0.074589102\",null,\"y: 0.074589102\",\"y: 0.074589102\",null,\"y: 0.395911332\",\"y: 0.395911332\",null,\"y: 0.395911332\",\"y: 0.395911332\",null,\"y: 0.244289931\",\"y: 0.244289931\",null,\"y: 0.244289931\",\"y: 0.244289931\",null,\"y: 0.130795138\",\"y: 0.130795138\",null,\"y: 0.130795138\",\"y: 0.130795138\",null,\"y: 0.048765985\",\"y: 0.048765985\",null,\"y: 0.048765985\",\"y: 0.048765985\",null,\"y: 0.027561615\",\"y: 0.027561615\",null,\"y: 0.027561615\",\"y: 0.027561615\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.000000000\",\"y: 0.000000000\",null,\"y: 0.027561615\",\"y: 0.027561615\",null,\"y: 0.027561615\",\"y: 0.027561615\",null,\"y: 0.013780745\",\"y: 0.013780745\",null,\"y: 0.013780745\",\"y: 0.013780745\",null,\"y: 0.013780745\",\"y: 0.013780745\",null,\"y: 0.013780745\",\"y: 0.013780745\",null,\"y: 0.048765985\",\"y: 0.048765985\",null,\"y: 0.048765985\",\"y: 0.048765985\",null,\"y: 0.130795138\",\"y: 0.130795138\",null,\"y: 0.130795138\",\"y: 0.130795138\",null,\"y: 0.064858391\",\"y: 0.064858391\",null,\"y: 0.064858391\",\"y: 0.064858391\",null,\"y: 0.032205924\",\"y: 0.032205924\",null,\"y: 0.032205924\",\"y: 0.032205924\",null,\"y: 0.032205924\",\"y: 0.032205924\",null,\"y: 0.032205924\",\"y: 0.032205924\",null,\"y: 0.064858391\",\"y: 0.064858391\",null,\"y: 0.064858391\",\"y: 0.064858391\",null,\"y: 0.244289931\",\"y: 0.244289931\",null,\"y: 0.244289931\",\"y: 0.244289931\",null,\"y: 0.078475730\",\"y: 0.078475730\",null,\"y: 0.078475730\",\"y: 0.078475730\",null,\"y: 0.042361044\",\"y: 0.042361044\",null,\"y: 0.042361044\",\"y: 0.042361044\",null,\"y: 0.042361044\",\"y: 0.042361044\",null,\"y: 0.042361044\",\"y: 0.042361044\",null,\"y: 0.078475730\",\"y: 0.078475730\",null,\"y: 0.078475730\",\"y: 0.078475730\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(199,167,108,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.4165359655544496,1.4165359655544496,null,1.4165359655544496,0.24834815420915959,null,0.24834815420915959,0.24834815420915959,null,0.24834815420915959,0.13448320991423884,null,0.13448320991423884,0.13448320991423884,null,0.13448320991423884,0,null,0.13448320991423884,0.13448320991423884,null,0.13448320991423884,0,null,0.24834815420915959,0.24834815420915959,null,0.24834815420915959,0.20441353132763651,null,0.20441353132763651,0.20441353132763651,null,0.20441353132763651,0,null,0.20441353132763651,0.20441353132763651,null,0.20441353132763651,0],\"y\":[57.38671875,61.5,null,61.5,61.5,null,61.5,60.5,null,60.5,60.5,null,60.5,60,null,60,60,null,60.5,61,null,61,61,null,61.5,62.5,null,62.5,62.5,null,62.5,62,null,62,62,null,62.5,63,null,63,63],\"text\":[\"y: 1.416535966\",\"y: 1.416535966\",null,\"y: 1.416535966\",\"y: 1.416535966\",null,\"y: 0.248348154\",\"y: 0.248348154\",null,\"y: 0.248348154\",\"y: 0.248348154\",null,\"y: 0.134483210\",\"y: 0.134483210\",null,\"y: 0.134483210\",\"y: 0.134483210\",null,\"y: 0.134483210\",\"y: 0.134483210\",null,\"y: 0.134483210\",\"y: 0.134483210\",null,\"y: 0.248348154\",\"y: 0.248348154\",null,\"y: 0.248348154\",\"y: 0.248348154\",null,\"y: 0.204413531\",\"y: 0.204413531\",null,\"y: 0.204413531\",\"y: 0.204413531\",null,\"y: 0.204413531\",\"y: 0.204413531\",null,\"y: 0.204413531\",\"y: 0.204413531\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(205,153,216,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.2747548783981961,1.2747548783981961,null,1.2747548783981961,0.75810509438815865,null,0.75810509438815865,0.75810509438815865,null,0.75810509438815865,0,null,0.75810509438815865,0.75810509438815865,null,0.75810509438815865,0.57090704576267215,null,0.57090704576267215,0.57090704576267215,null,0.57090704576267215,0.41532550379440869,null,0.41532550379440869,0.41532550379440869,null,0.41532550379440869,0.3357270698147935,null,0.3357270698147935,0.3357270698147935,null,0.3357270698147935,0.12111641980160108,null,0.12111641980160108,0.12111641980160108,null,0.12111641980160108,0,null,0.12111641980160108,0.12111641980160108,null,0.12111641980160108,0,null,0.3357270698147935,0.3357270698147935,null,0.3357270698147935,0,null,0.41532550379440869,0.41532550379440869,null,0.41532550379440869,0.10163945352271772,null,0.10163945352271772,0.10163945352271772,null,0.10163945352271772,0,null,0.10163945352271772,0.10163945352271772,null,0.10163945352271772,0,null,0.57090704576267215,0.57090704576267215,null,0.57090704576267215,0.25282457849020384,null,0.25282457849020384,0.25282457849020384,null,0.25282457849020384,0,null,0.25282457849020384,0.25282457849020384,null,0.25282457849020384,0.067495188224349259,null,0.067495188224349259,0.067495188224349259,null,0.067495188224349259,0,null,0.067495188224349259,0.067495188224349259,null,0.067495188224349259,0],\"y\":[15.37109375,3.53125,null,3.53125,3.53125,null,3.53125,1,null,1,1,null,3.53125,6.0625,null,6.0625,6.0625,null,6.0625,4.375,null,4.375,4.375,null,4.375,3.25,null,3.25,3.25,null,3.25,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.25,4,null,4,4,null,4.375,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.0625,7.75,null,7.75,7.75,null,7.75,7,null,7,7,null,7.75,8.5,null,8.5,8.5,null,8.5,8,null,8,8,null,8.5,9,null,9,9],\"text\":[\"y: 1.274754878\",\"y: 1.274754878\",null,\"y: 1.274754878\",\"y: 1.274754878\",null,\"y: 0.758105094\",\"y: 0.758105094\",null,\"y: 0.758105094\",\"y: 0.758105094\",null,\"y: 0.758105094\",\"y: 0.758105094\",null,\"y: 0.758105094\",\"y: 0.758105094\",null,\"y: 0.570907046\",\"y: 0.570907046\",null,\"y: 0.570907046\",\"y: 0.570907046\",null,\"y: 0.415325504\",\"y: 0.415325504\",null,\"y: 0.415325504\",\"y: 0.415325504\",null,\"y: 0.335727070\",\"y: 0.335727070\",null,\"y: 0.335727070\",\"y: 0.335727070\",null,\"y: 0.121116420\",\"y: 0.121116420\",null,\"y: 0.121116420\",\"y: 0.121116420\",null,\"y: 0.121116420\",\"y: 0.121116420\",null,\"y: 0.121116420\",\"y: 0.121116420\",null,\"y: 0.335727070\",\"y: 0.335727070\",null,\"y: 0.335727070\",\"y: 0.335727070\",null,\"y: 0.415325504\",\"y: 0.415325504\",null,\"y: 0.415325504\",\"y: 0.415325504\",null,\"y: 0.101639454\",\"y: 0.101639454\",null,\"y: 0.101639454\",\"y: 0.101639454\",null,\"y: 0.101639454\",\"y: 0.101639454\",null,\"y: 0.101639454\",\"y: 0.101639454\",null,\"y: 0.570907046\",\"y: 0.570907046\",null,\"y: 0.570907046\",\"y: 0.570907046\",null,\"y: 0.252824578\",\"y: 0.252824578\",null,\"y: 0.252824578\",\"y: 0.252824578\",null,\"y: 0.252824578\",\"y: 0.252824578\",null,\"y: 0.252824578\",\"y: 0.252824578\",null,\"y: 0.067495188\",\"y: 0.067495188\",null,\"y: 0.067495188\",\"y: 0.067495188\",null,\"y: 0.067495188\",\"y: 0.067495188\",null,\"y: 0.067495188\",\"y: 0.067495188\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(228,149,165,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.5,1.5,null,1.5,1.2747548783981961,null,1.2747548783981961,1.2747548783981961,null,1.2747548783981961,1,null,1,1,null,1,0.9038714423526949,null,1.5,1.5,null,1.5,1.4165359655544496],\"y\":[36.37890625,15.37109375,null,15.37109375,15.37109375,null,15.37109375,27.2109375,null,27.2109375,27.2109375,null,27.2109375,35.390625,null,35.390625,35.390625,null,36.37890625,57.38671875,null,57.38671875,57.38671875],\"text\":[\"y: 1.500000000\",\"y: 1.500000000\",null,\"y: 1.500000000\",\"y: 1.500000000\",null,\"y: 1.274754878\",\"y: 1.274754878\",null,\"y: 1.274754878\",\"y: 1.274754878\",null,\"y: 1.000000000\",\"y: 1.000000000\",null,\"y: 1.000000000\",\"y: 1.000000000\",null,\"y: 1.500000000\",\"y: 1.500000000\",null,\"y: 1.500000000\",\"y: 1.500000000\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.2677165354330708,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.5,1.2747548783981961,0.75810509438815865,0,0.57090704576267215,0.41532550379440869,0.3357270698147935,0.12111641980160108,0,0,0,0.10163945352271772,0,0,0.25282457849020384,0,0.067495188224349259,0,0,1,0.39591133208329909,0.24397450819655347,0.13024763930192124,0,0.065170992784574291,0,0.049871258666791374,0,0,0.19507833184532708,0.069920813163695125,0,0,0.074589102214492581,0,0,0.24428993135336602,0.13079513800126846,0.04876598490941704,0.027561614575942459,0,0,0,0.013780744908102686,0,0,0,0.064858390700474236,0.032205924085069421,0,0,0,0.078475730161702048,0.042361044374825324,0,0,0,0.9038714423526949,0.64805840897087963,0.36385053784450988,0.17315950866139859,0,0,0,0.50153189924802111,0.18932766518889679,0,0.065781917965665571,0,0,0,0.76404921295863792,0,0,0,0.46587114709728672,0.20388538670491194,0,0.1266873052265442,0.10325271967693948,0,0,0,0.18568520119625709,0,0.064237134704640889,0,0,1.4165359655544496,0.56304973350754906,0.15741223570343874,0.092888338191646033,0.076608952620177542,0,0.046572044117529257,0,0.021793702645220837,0,0.0093648963994664505,0,0,0.024783589263931555,0,0,0.12275952063000919,0,0,0.34631736806197733,0.058249297123012876,0,0,0.2482214098689095,0.16543015874559316,0,0.052476767260296507,0,0,0,0.24834815420915959,0.13448320991423884,0,0,0.20441353132763651,0,0],\"y\":[36.37890625,15.37109375,3.53125,1,6.0625,4.375,3.25,2.5,2,3,4,5.5,5,6,7.75,7,8.5,8,9,27.2109375,19.03125,13.1875,10.875,10,11.75,11,12.5,12,13,15.5,14.5,14,15,16.5,16,17,24.875,22.5,20.75,19.5,18.5,18,19,20.5,20,21,22,24.25,23.5,23,24,25,27.25,26.5,26,27,28,35.390625,32.0625,30.25,29.5,29,30,31,33.875,32.75,32,33.5,33,34,35,38.71875,36.5,36,37,40.9375,39.125,38,40.25,39.5,39,40,41,42.75,42,43.5,43,44,57.38671875,53.2734375,50.359375,48.21875,45.9375,45,46.875,46,47.75,47,48.5,48,49,50.5,50,51,52.5,52,53,56.1875,54.5,54,55,57.875,56.75,56,57.5,57,58,59,61.5,60.5,60,61,62.5,62,63],\"text\":[\"y: 1.500000000\",\"y: 1.274754878\",\"y: 0.758105094\",\"y: 0.000000000\",\"y: 0.570907046\",\"y: 0.415325504\",\"y: 0.335727070\",\"y: 0.121116420\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.101639454\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.252824578\",\"y: 0.000000000\",\"y: 0.067495188\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 1.000000000\",\"y: 0.395911332\",\"y: 0.243974508\",\"y: 0.130247639\",\"y: 0.000000000\",\"y: 0.065170993\",\"y: 0.000000000\",\"y: 0.049871259\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.195078332\",\"y: 0.069920813\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.074589102\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.244289931\",\"y: 0.130795138\",\"y: 0.048765985\",\"y: 0.027561615\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.013780745\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.064858391\",\"y: 0.032205924\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.078475730\",\"y: 0.042361044\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.903871442\",\"y: 0.648058409\",\"y: 0.363850538\",\"y: 0.173159509\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.501531899\",\"y: 0.189327665\",\"y: 0.000000000\",\"y: 0.065781918\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.764049213\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.465871147\",\"y: 0.203885387\",\"y: 0.000000000\",\"y: 0.126687305\",\"y: 0.103252720\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.185685201\",\"y: 0.000000000\",\"y: 0.064237135\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 1.416535966\",\"y: 0.563049734\",\"y: 0.157412236\",\"y: 0.092888338\",\"y: 0.076608953\",\"y: 0.000000000\",\"y: 0.046572044\",\"y: 0.000000000\",\"y: 0.021793703\",\"y: 0.000000000\",\"y: 0.009364896\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.024783589\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.122759521\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.346317368\",\"y: 0.058249297\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.248221410\",\"y: 0.165430159\",\"y: 0.000000000\",\"y: 0.052476767\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.248348154\",\"y: 0.134483210\",\"y: 0.000000000\",\"y: 0.000000000\",\"y: 0.204413531\",\"y: 0.000000000\",\"y: 0.000000000\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"transparent\",\"opacity\":1,\"size\":null,\"symbol\":null,\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"xaxis\":{\"domain\":[0,0.80000000000000004],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,4.5],\"tickmode\":\"array\",\"ticktext\":[\"2012 Cultivation PR\",\"2012 Livestock PR\",\"2012 Fishing PR\",\"2012 Others PR\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"2012 Cultivation PR\",\"2012 Livestock PR\",\"2012 Fishing PR\",\"2012 Others PR\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":6.6417600664175991},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"ICT Indicators\",\"hoverformat\":\".2f\"},\"xaxis2\":{\"domain\":[0.80000000000000004,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1.5],\"tickmode\":\"array\",\"ticktext\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"tickvals\":[0,0.5,1,1.5],\"categoryorder\":\"array\",\"categoryarray\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":false,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,63.5],\"tickmode\":\"array\",\"ticktext\":[\"29\",\"15\",\"22\",\"60\",\"13\",\"32\",\"11\",\"27\",\"28\",\"9\",\"1\",\"21\",\"33\",\"34\",\"5\",\"3\",\"35\",\"19\",\"17\",\"18\",\"7\",\"24\",\"20\",\"2\",\"16\",\"50\",\"53\",\"6\",\"52\",\"26\",\"31\",\"8\",\"10\",\"4\",\"38\",\"23\",\"14\",\"25\",\"48\",\"55\",\"49\",\"44\",\"51\",\"37\",\"57\",\"45\",\"46\",\"41\",\"40\",\"43\",\"12\",\"58\",\"39\",\"47\",\"42\",\"61\",\"36\",\"56\",\"30\",\"54\",\"59\",\"63\",\"62\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],\"categoryorder\":\"array\",\"categoryarray\":[\"29\",\"15\",\"22\",\"60\",\"13\",\"32\",\"11\",\"27\",\"28\",\"9\",\"1\",\"21\",\"33\",\"34\",\"5\",\"3\",\"35\",\"19\",\"17\",\"18\",\"7\",\"24\",\"20\",\"2\",\"16\",\"50\",\"53\",\"6\",\"52\",\"26\",\"31\",\"8\",\"10\",\"4\",\"38\",\"23\",\"14\",\"25\",\"48\",\"55\",\"49\",\"44\",\"51\",\"37\",\"57\",\"45\",\"46\",\"41\",\"40\",\"43\",\"12\",\"58\",\"39\",\"47\",\"42\",\"61\",\"36\",\"56\",\"30\",\"54\",\"59\",\"63\",\"62\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":5.3134080531340802},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"Provinces of Vietnam\",\"hoverformat\":\".2f\"},\"annotations\":[],\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.80000000000000004,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.80000000000000004,\"x1\":1,\"y0\":0,\"y1\":1}],\"images\":[],\"margin\":{\"t\":60,\"r\":null,\"b\":60.572851805728504,\"l\":200},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"y\":1,\"yanchor\":\"top\"},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"title\":\"Geographic Segmentation of Vietnam Farms by ICT Indicators (2012)\"},\"attrs\":{\"684051ae2df0\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"heatmap\"},\"68403bf47de4\":{\"x\":{},\"y\":{},\"xend\":{},\"yend\":{},\"colour\":{},\"linetype\":{},\"size\":{},\"type\":\"scatter\"},\"6840249c30b\":{\"x\":{},\"y\":{},\"colour\":{},\"shape\":{},\"size\":{}}},\"source\":\"A\",\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"displaylogo\":false,\"modeBarButtonsToRemove\":[\"sendDataToCloud\",\"select2d\",\"lasso2d\",\"autoScale2d\",\"hoverClosestCartesian\",\"hoverCompareCartesian\",\"sendDataToCloud\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"subplot\":true,\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nIn this heatmap, the selected farm proportions are normalized for 2012, and a Ward hierarchical clustering model is applied. The heatmap groups similar provinces based on ICT indicators and displays the intensity of each metric by color. Within the Shiny UI, I’ll allow users to adjust K values and explore clustering structures interactively, making it easy to identify similar clusters among provinces visually.\n\n![](images/clipboard-2260834031.png)\n\n### **Mapping the clusters formed**\n\nWhen designing the Shiny UI, I will include options for variable: k value and variable: year, allowing users to dynamically adjust the number of clusters and explore clusters across different years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroups <- as.factor(cutree(hclust_ward, k=6))\n```\n:::\n\n\n\nThis line creates a grouping variable (`groups`) by cutting the hierarchical clustering dendrogram at K=6 clusters, assigning each province to one of the clusters.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_cluster <- cbind(vietnam_farm, as.matrix(groups)) %>%\n  rename(`CLUSTER`=`as.matrix.groups.`)\n```\n:::\n\n\n\nNext, I add the `groups` variable to `vietnam_farm`, renaming it as `CLUSTER`. This combined data frame (`vietnam_farm_cluster`) now includes cluster assignments, making it ready for spatial visualization.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(vietnam_farm_cluster, \"CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n\nUsing `qtm`, I map the clusters for visualization. In Shiny, this map will allow users to view how provinces are grouped based on farm characteristics for a selected year, with an adjustable K value so users can see how different cluster numbers impact segmentation.\n\n## **Spatially Constrained Clustering: SKATER approach**\n\nThe SKATER approach adds spatial constraints to clustering, ensuring clusters are contiguous geographically, which is useful in spatial analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_sp <- as_Spatial(vietnam_farm)\n```\n:::\n\n\n\nTo work with SKATER, the `vietnam_farm` dataset is converted into a spatial format (`vietnam_farm_sp`), making it compatible with functions that require spatial data structure.\n\n### **Computing Neighbour List**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm.nb <- poly2nb(vietnam_farm_sp)\nsummary(vietnam_farm.nb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 63 \nNumber of nonzero links: 270 \nPercentage nonzero weights: 6.802721 \nAverage number of links: 4.285714 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 7 12 19 11 10  3  1 \n7 least connected regions:\n22 27 28 29 30 32 63 with 2 links\n1 most connected region:\n1 with 8 links\n```\n\n\n:::\n:::\n\n\n\nThis computes the neighborhood list for each province using adjacency, helping to establish spatial relationships necessary for the SKATER algorithm. In Shiny, this process allows for geographically informed clustering based on the provinces’ proximity to each other.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoords <- st_coordinates(\n  st_centroid(st_geometry(vietnam_farm)))\n```\n:::\n\n\n\nThis code calculates the centroid coordinates of each province, used to assess spatial relationships and visualize each cluster’s spatial configuration accurately.\n\n### **Computing minimum spanning tree**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlcosts <- nbcosts(vietnam_farm.nb, vietnam_farm_ict_2012)\n```\n:::\n\n\n\nThe `nbcosts` function calculates edge costs based on Euclidean distances, indicating the cost of connecting each province to its neighbors. This will help in creating a minimum spanning tree for clustering.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm.w <- nb2listw(vietnam_farm.nb, \n                   lcosts, \n                   style=\"B\")\nsummary(vietnam_farm.w)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 63 \nNumber of nonzero links: 270 \nPercentage nonzero weights: 6.802721 \nAverage number of links: 4.285714 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 7 12 19 11 10  3  1 \n7 least connected regions:\n22 27 28 29 30 32 63 with 2 links\n1 most connected region:\n1 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn     S0        S1         S2\nB 63 3969 202988 463689991 3529071846\n```\n\n\n:::\n:::\n\n\n\nUsing the neighborhood list and calculated costs, I create a spatial weights list (`vietnam_farm.w`). The weights define connectivity and are crucial for forming the minimum spanning tree in the SKATER method.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm.mst <- mstree(vietnam_farm.w)\n```\n:::\n\n\n\nThe minimum spanning tree (`vietnam_farm.mst`) is created, providing the basis for spatially constrained clusters by ensuring that clusters are spatially connected.\n\n### **Computing spatially constrained clusters using SKATER method**\n\nWhen designing the Shiny UI, I will include variable: year and selection of `ncuts` to allow users to interactively select both the year and the number of clusters they wish to analyze.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclust <- spdep::skater(edges = vietnam_farm.mst[,1:2], \n                 data = vietnam_farm_ict_2012, \n                 method = \"euclidean\", \n                 ncuts = 5)\n```\n:::\n\n\n\nUsing the SKATER method, spatially constrained clusters are created based on the minimum spanning tree, using Euclidean distance to determine the cost of connecting provinces. By including `ncuts` as a selectable parameter in Shiny, users can explore how changing the number of clusters impacts spatial segmentation. This flexibility allows them to see various cluster configurations and observe how spatial constraints shape cluster formation across different parameter choices.\n\n### **Visualising the clusters in choropleth map**\n\nWhen designing the Shiny UI, I will include variable: year so users can interactively select the year for analysis and variable: K value to adjust the number of clusters.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroups_mat <- as.matrix(clust$groups)\nvietnam_farm_spatialcluster <- cbind(vietnam_farm_cluster, as.factor(groups_mat)) %>%\n  rename(`SP_CLUSTER`=`as.factor.groups_mat.`)\nqtm(vietnam_farm_spatialcluster, \"SP_CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-54-1.png){width=672}\n:::\n:::\n\n\n\nThis code binds the spatially constrained cluster groups to the data and renames the cluster column as `SP_CLUSTER`. The `qtm` function then visualizes these clusters, allowing users to see spatial cluster distributions directly on the map.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhclust.map <- qtm(vietnam_farm_cluster,\n                  \"CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\nshclust.map <- qtm(vietnam_farm_spatialcluster,\n                   \"SP_CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(hclust.map, shclust.map,\n             asp=NA, ncol=2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n\n\nUsing `tmap_arrange`, I display both the regular and spatially constrained clusters side-by-side, providing users with a comparative view of the cluster types for a given year. The Shiny app will feature year and K value selectors to let users see how clusters vary by different configurations.\n\n![](images/clipboard-907982601.png)\n\n## **Spatially Constrained Clustering: ClustGeo Method**\n\n### **Ward-like hierarchical clustering: ClustGeo**\n\nIn the Shiny UI, I will include **variable: year** and **variable: K value** so users can explore different years and adjust the number of clusters.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnongeo_cluster <- hclustgeo(proxmat)\nplot(nongeo_cluster, cex = 0.5)\nrect.hclust(nongeo_cluster, \n            k = 6, \n            border = 2:5)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-56-1.png){width=672}\n:::\n:::\n\n\n\nThe `hclustgeo` function performs hierarchical clustering based on the proximity matrix, producing a dendrogram. Users can select **K values** in Shiny to visualize different clustering arrangements on the dendrogram, adjusting to see various levels of grouping across the chosen year.\n\n![](images/clipboard-1682337348.png)\n\n#### Mapping the clusters formed\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroups <- as.factor(cutree(nongeo_cluster, k=6))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_ngeo_cluster <- cbind(vietnam_farm, as.matrix(groups)) %>%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n```\n:::\n\n\n\nThis code assigns each province to a cluster (based on `K=6`) and renames the column `CLUSTER`, allowing us to map and display the clusters in Shiny with an adjustable **K value** and **year** for user-driven exploration.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(vietnam_farm_ngeo_cluster, \"CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n\n\nThe `qtm` function visualizes these ClustGeo-based clusters, showing spatially relevant groupings across provinces.\n\n### **Spatially Constrained Hierarchical Clustering**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist <- st_distance(vietnam_farm, vietnam_farm)\ndistmat <- as.dist(dist)\n```\n:::\n\n\n\nThis line calculates spatial distances between provinces, forming a distance matrix essential for combining spatial constraints with ClustGeo clustering.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr <- choicealpha(proxmat, distmat, range.alpha = seq(0, 1, 0.1), K=6, graph = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-61-2.png){width=672}\n:::\n:::\n\n\n\nUsing `choicealpha`, I generate a plot that helps select the optimal balance (`alpha`) between geographic distance and attribute-based clustering, aiding in refining clusters by integrating spatial proximity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclustG <- hclustgeo(proxmat, distmat, alpha = 0.2)\n```\n:::\n\n\n\nThis command performs spatially constrained clustering with a specific `alpha` value (0.2), balancing geographic and attribute-based clustering. In Shiny, users will select **K value** and **year** for visualizing clusters under different constraints.\n\n![](images/clipboard-3960457669.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroups <- as.factor(cutree(clustG, k=6))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_farm_Gcluster <- cbind(vietnam_farm, as.matrix(groups)) %>%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n```\n:::\n\n\n\nAfter assigning clusters based on `K=6`, this code binds cluster groupings to the data, allowing each province to be categorized by its cluster number.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(vietnam_farm_Gcluster, \"CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-65-1.png){width=672}\n:::\n:::\n\n\n\nThe `qtm` map of `CLUSTER` displays the spatially constrained hierarchical clustering for each province, allowing users to examine cluster distributions in Shiny with selectable year and cluster parameters.\n\n## **Visual Interpretation of Clusters**\n\nWhen designing the Shiny UI, I will include **variable: year** and **variable: K value** to give users flexibility in examining clustering results across years and different cluster groupings.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = vietnam_farm_ngeo_cluster, aes(x = CLUSTER, y = `X2012.Cultivation.PR`)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-66-1.png){width=672}\n:::\n:::\n\n\n\nThis boxplot shows the distribution of `Cultivation PR` within each cluster for the year 2012, providing insights into how similar or varied the clusters are in terms of cultivation proportions. In Shiny, users can adjust **K values** and **years** to explore how clusters relate to different farm indicators.\n\n![](images/clipboard-1921262520.png)\n\n### **Multivariate Visualisation**\n\nIn the Shiny UI, I will include **variable: year**, **K value**, and the option to explore farm indicators across clusters for multivariate analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggparcoord(data = vietnam_farm_ngeo_cluster, \n           columns = c(62:65), \n           scale = \"globalminmax\",\n           alphaLines = 0.2,\n           boxplot = TRUE, \n           title = \"Multiple Parallel Coordinates Plots of ICT Variables by Cluster (2012)\") +\n  facet_grid(~ CLUSTER) + \n  theme(axis.text.x = element_text(angle = 30)) +\n  scale_x_discrete(labels = c(\n    \"X2012.Cultivation.PR\" = \"Cultivation PR\",\n    \"X2012.Livestock.PR\" = \"Livestock PR\",\n    \"X2012.Fishing.PR\" = \"Fishing PR\",\n    \"X2012.Others.PR\" = \"Others PR\"\n  ))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-67-1.png){width=672}\n:::\n:::\n\n\n\nUsing parallel coordinate plots, this visualization allows users to view multiple farm indicators across clusters, with variables standardized on a global min-max scale. In Shiny, users can interactively explore these multivariate relationships by adjusting **year** and **K values**, gaining insights into how different farm types are distributed across clusters.\n",
    "supporting": [
      "Take-Home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}